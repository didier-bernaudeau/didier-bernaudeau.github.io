<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>HowTo configure the Linux kernel for Lenovo ThinkPad X240 - My personal blog note</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



<link rel="canonical" href="http://didier.bernaudeau.net/HowTo-configure-the-Linux-kernel-for-Lenovo-ThinkPad-X240.html">

        <meta name="author" content="Didier Bernaudeau" />
        <meta name="keywords" content="Gentoo" />
        <meta name="description" content="This article describes step by step how to configure the Linux Kernel for my Lenovo ThinkPad X240. This kernel must support Intel Haswell processor, all devices and UEFI bootloader without Grub. To get more information about the configuration of my laptop, you can read this article : Lenovo ThinkPad X240" />

        <meta property="og:site_name" content="My personal blog note" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="HowTo configure the Linux kernel for Lenovo ThinkPad X240"/>
        <meta property="og:url" content="http://didier.bernaudeau.net/HowTo-configure-the-Linux-kernel-for-Lenovo-ThinkPad-X240.html"/>
        <meta property="og:description" content="This article describes step by step how to configure the Linux Kernel for my Lenovo ThinkPad X240. This kernel must support Intel Haswell processor, all devices and UEFI bootloader without Grub. To get more information about the configuration of my laptop, you can read this article : Lenovo ThinkPad X240"/>
        <meta property="article:published_time" content="2015-06-16" />
            <meta property="article:section" content="Tutorials" />
            <meta property="article:tag" content="Gentoo" />
            <meta property="article:author" content="Didier Bernaudeau" />


    <!-- Bootstrap -->
        <link rel="stylesheet" href="http://didier.bernaudeau.net/theme/css/bootstrap.flatly.min.css" type="text/css"/>
    <link href="http://didier.bernaudeau.net/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="http://didier.bernaudeau.net/theme/css/pygments/native.css" rel="stylesheet">
    <link rel="stylesheet" href="http://didier.bernaudeau.net/theme/css/style.css" type="text/css"/>

        <link href="http://didier.bernaudeau.net/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="My personal blog note ATOM Feed"/>



        <link href="http://didier.bernaudeau.net/feeds/tutorials.atom.xml" type="application/atom+xml" rel="alternate"
              title="My personal blog note Tutorials ATOM Feed"/>

</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
	<div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="http://didier.bernaudeau.net/" class="navbar-brand">
My personal blog note            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                    <li><a href="/category/articles.html">Articles</a></li>
                    <li><a href="/category/tutorials.html">Tutorials</a></li>
                    <li><a href="/category/press-review.html">Press Review</a></li>
                    <li><a href="/pages/presentation.html">Presentation</a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li><a href="http://didier.bernaudeau.net/archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->
<!-- Banner -->
<!-- End Banner -->
<div class="container">
    <div class="row">
        <div class="col-sm-9">
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="http://didier.bernaudeau.net/HowTo-configure-the-Linux-kernel-for-Lenovo-ThinkPad-X240.html"
                       rel="bookmark"
                       title="Permalink to HowTo configure the Linux kernel for Lenovo ThinkPad X240">
                        HowTo configure the Linux kernel for Lenovo ThinkPad X240
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2015-06-16T22:10:00+02:00"> mar. 16 juin 2015</time>
    </span>
            <span class="label label-default">Modified</span>
            <span class="modified">
                <i class="fa fa-calendar"></i><time datetime="2016-05-05T13:23:00+02:00"> jeu. 05 mai 2016</time>
            </span>





<span class="label label-default">Tags</span>
	<a href="http://didier.bernaudeau.net/tag/gentoo.html">Gentoo</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <p>This article describes step by step how to configure the Linux Kernel for my Lenovo ThinkPad X240. This kernel must support Intel Haswell processor, all devices and UEFI bootloader without Grub.</p>
<p>To get more information about the configuration of my laptop, you can read this article : <a class="reference external" href="http://didier.bernaudeau.net/Laptop_Lenovo_ThinkPad_X240.html">Lenovo ThinkPad X240</a></p>

<div class="section" id="kernel-installation">
<h2>Kernel installation</h2>
<p>Download kernel Gentoo sources (4.4.6) :</p>
<pre class="code console literal-block">
<span class="gp">#</span> emerge sys-kernel/gentoo-sources
</pre>
<p>Download firmware for Intel WiFi 7260 (version 16) :</p>
<pre class="code console literal-block">
<span class="gp">#</span> emerge sys-firmware/iwl7260-ucode
</pre>
<p>Select kernel sources</p>
<pre class="code console literal-block">
<span class="gp">#</span> eselect kernel list
<span class="gp">#</span> eselect kernel <span class="nb">set</span> X
<span class="gp">#</span> <span class="nb">cd</span> /usr/src/linux
</pre>
<p>Print configuration menu</p>
<pre class="code console literal-block">
<span class="gp">#</span> make menuconfig
</pre>
</div>
<div class="section" id="kernel-minimal-configuration">
<h2>Kernel minimal configuration</h2>
<pre class="code ini literal-block">
<span class="err">|</span> <span class="err">Gentoo</span> <span class="err">Linux</span> <span class="err">---&gt;</span>
<span class="err">|</span>      <span class="err">|</span>     <span class="err">Support</span> <span class="err">for</span> <span class="err">init</span> <span class="err">systems,</span> <span class="err">system</span> <span class="err">and</span> <span class="err">service</span> <span class="err">managers</span> <span class="err">---&gt;</span>
<span class="err">|</span>      <span class="err">|</span>      <span class="err">|</span> <span class="err">[</span> <span class="err">]</span> <span class="err">OpenRC,</span> <span class="err">runit</span> <span class="err">and</span> <span class="err">other</span> <span class="err">script</span> <span class="err">based</span> <span class="err">systems</span> <span class="err">and</span> <span class="err">managers</span>
<span class="err">|</span>      <span class="err">|</span>      <span class="err">|</span> <span class="err">[*]</span> <span class="err">systemd</span>
<span class="err">|</span>
<span class="err">|</span> <span class="err">General</span> <span class="err">setup</span>  <span class="err">---&gt;</span>
<span class="err">|</span>      <span class="err">|</span>
<span class="err">|</span>      <span class="err">|</span>     <span class="err">Timers</span> <span class="err">subsystem</span>  <span class="err">---&gt;</span>
<span class="err">|</span>      <span class="err">|</span>      <span class="err">|</span> <span class="err">[*]</span> <span class="err">High</span> <span class="err">Resolution</span> <span class="err">Timer</span> <span class="err">Support</span>
<span class="err">|</span>      <span class="err">|</span>
<span class="err">|</span> <span class="err">Processor</span> <span class="err">type</span> <span class="err">and</span> <span class="err">features</span>  <span class="err">---&gt;</span>
<span class="err">|</span>      <span class="err">|</span>
<span class="err">|</span>      <span class="err">|</span> <span class="err">[*]</span> <span class="err">Symmetric</span> <span class="err">multi-processing</span> <span class="err">support</span>
</pre>
<!-- |      | [*] Support x2apic
|      | [ ] Support for extended (non-PC) x86 platforms
|      | [*] Intel Low Power Subsystem Support
|      |     Processor family (Generic-x86-64)  - - ->
|      | [ ] Old AMD GART IOMMU support
|      | [ ] IBM Calgary IOMMU support
|      | [ ] Enable Maximum number of SMP Processors and NUMA Nodes
|      | [*] SMT (Hyperthreading) scheduler support
|      | [*] Multi-core scheduler support
|      | [*] Machine Check / overheating reporting
|      | [*]   Intel MCE features (NEW)
|      | [ ]   AMD MCE features
|      | < > CPU microcode loading support
|      | <*> /dev/cpu/*/msr - Model-specific register support
|      | <*> /dev/cpu/*/cpuid - CPU information support
|      | [ ] Numa Memory Allocation and Scheduler Support
|      | [*] EFI runtime service support
|      | [*]   EFI stub support
|      | [*] Built-in kernel command line
|      | (root=/dev/sda6 init=/usr/lib/systemd/systemd) Built-in kernel command string
|
| Power management and ACPI options  - - ->
|      |
|      | [*] Suspend to RAM and standby
|      | [*] Hibernation (aka 'suspend to disk')
|      | (/dev/sda5) Default resume partition
|      |
|      | -*- Device power management core functionality
|      | [ ]   Power Management Debug Support
|      |
|      | [*] ACPI (Advanced Configuration and Power Interface) Support  - - ->
|      |      | <*>   Processor
|      |      | <*>   Processor Aggregator
|      |
|      |     CPU Frequency scaling  - - ->
|      |      | [*] CPU Frequency scaling
|      |      | <*>   CPU frequency translation statistics
|      |      | [*]     CPU frequency translation statistics details
|      |      |       Default CPUFreq governor (conservative)  - - ->
|      |      | -*-   'performance' governor
|      |      | <*>   'powersave' governor
|      |      | <*>   'userspace' governor for userspace frequency scaling
|      |      | <*>   'ondemand' cpufreq policy governor
|      |      | -*-   'conservative' cpufreq governor
|      |      |       *** CPU frequency scaling drivers ***
|      |      | [*]   Intel P state control
|      |      | < >   ACPI Processor P-States driver
|      |
|      |     CPU Idle  - - ->
|      |      | [*] CPU idle PM support
|      |      | [ ]   Ladder governor (for periodic timer tick)
|      |      | -*-   Menu governor (for tickless system)
|      |
|      | [*] Cpuidle Driver for Intel Processors
|
| [*] Networking support  - - ->
|      | - - - Networking support
|      |       Networking options  - - ->
|      |        | [*] TCP/IP networking
|      |        | < >   The IPv6 protocol  - - - -
|      |        | [ ]   NetLabel subsystem support
|      |
|      | [ ]   Amateur Radio support  - - - -
|      |
|      | -*-   Wireless  - - ->
|      |        | - - - Wireless
|      |        | <*>   cfg80211 - wireless configuration API
|      |        | [*]     enable powersave by default
|      |        | <*>   Generic IEEE 802.11 Networking Stack (mac80211)
|      |        | [*]   Enable LED triggers
|
| Device Drivers  - - ->
|      |
|      |     Generic Driver Options  - - ->
|      |      | [*]   Include in-kernel firmware blobs in kernel binary
|      |      | (iwlwifi-7260-16.ucode) External firmware blobs to build into the kernel binary
|      |      | (/lib/firmware) Firmware blobs root directory
|      |      | [*] Fallback user-helper invocation for firmware loading
|      |      | [ ] Managed device resources verbose debug messages
|      |
|      | <*> Serial ATA and Parallel ATA drivers (libata)  - - ->
|      |      | [ ]   Verbose ATA error reporting
|      |      | [*]   ATA ACPI Support
|      |      | [ ]   SATA Port Multiplier support
|      |      | <*>   AHCI SATA support
|      |      | [ ]   ATA SFF support (for legacy IDE and PATA)
|      |
|      | [ ] Multiple devices driver support (RAID and LVM)  - - - -
|      | [ ] Macintosh device drivers  - - - -
|      |
|      | [*] Network device support  - - ->
|      |      | - - - Network device support
|      |      | [*]   Ethernet driver support  - - ->
|      |      |        | - - - Ethernet driver support
|      |      |        | [*]   Intel devices
|      |      |        | < >     Intel(R) PRO/100+ support
|      |      |        | < >     Intel(R) PRO/1000 Gigabit Ethernet support
|      |      |        | <*>     Intel(R) PRO/1000 PCI-Express Gigabit Ethernet support
|      |      |        | [ ]     Intel (82586/82593/82596) devices
|      |      |
|      |      | < >   FDDI driver support
|      |      | < >   USB Network Adapters  - - - -
|      |      | < >   PHY Device support and infrastructure  - - - -
|      |      |
|      |      | [*]   Wireless LAN  - - ->
|      |      |        | - - - Wireless LAN
|      |      |        | <*>   Intel Wireless WiFi Next Gen AGN - Wireless-N/Advanced-N/Ultimate-N (iwlwifi)
|      |      |        | < >     Intel Wireless WiFi DVM Firmware support
|      |      |        | <*>     Intel Wireless WiFi MVM Firmware support
|      |      |        | < >   Realtek rtlwifi family of devices  - - - -
|      |
|      |     I2C support  - - ->
|      |      | -*- I2C support
|      |      | <*>   I2C device interface
|      |      |       I2C Hardware Bus support  - - ->
|      |      |        | <*> Intel 82801 (ICH/PCH)
|      |      |        | <*> SMBus Control Method Interface
|      |
|      |     Character devices  - - ->
|      |      | < > Hardware Random Number Generator Core support  - - ->
|      | -->
<!-- |      | [*] GPIO Support  - - -> -->
<!-- |      |      | <*>   Intel Lynxpoint GPIO support                          *******************************************
|      |
|      | -*- Hardware Monitoring support  - - ->
|      |      | <*>   Intel Core/Core2/Atom temperature sensor
|      |
|      | -*- Generic Thermal sysfs driver  - - ->
|      |      |       Default Thermal governor (step_wise)  - - ->
|      |      | -*-   Step_wise thermal governor
|      |      | <*>   Intel PowerClamp idle injection driver
|      |      | <*>   X86 package temperature thermal driver
|      |
|      |     Multifunction device drivers  - - ->
|      |      | <*> Intel ICH LPC
|      |
|      |     Graphics support  - - ->
|      |      |     Direct Rendering Manager  - - ->
|      |      |      | <*> Direct Rendering Manager (XFree86 4.1.0 and higher DRI support)  - - -
|      |      |      | <*> Intel 8xx/9xx/G3x/G4x/HD Graphics
|      |
|      |     <*> Sound card support  - - ->
|      |      | <*>   Advanced Linux Sound Architecture  - - ->
|      |      |      | [*]   PCI sound devices  - - ->
|      |      |      |       HD-Audio  - - ->
|      |      |      |        | <*> HD Audio PCI
|      |      |      |        | <*> Build Realtek HD-audio codec support
|      |      |      |        | <*> Build HDMI/DisplayPort HD-audio codec support
|      |      |      |
|      |      |      | (2048) Pre-allocated buffer size for HD-audio driver
|      |      |      |
|      |      |      | [ ]   USB sound devices  - - - -
|      |      |      | [ ]   PCMCIA sound devices  - - - -
|      |
|      | [*] USB support  - - ->
|      |      | <*>   Support for Host-side USB
|      |      | < >     USB Monitor
|      |      | <*>     xHCI HCD (USB 3.0) support
|      |      | <*>     EHCI HCD (USB 2.0) support
|      |      | < >     OHCI HCD (USB 1.1) support
|      |      | < >     UHCI HCD (most Intel and VIA) support
|      |
|      | [*] X86 Platform Specific Device Drivers  - - ->
|      |      | <*>   ThinkPad ACPI Laptop Extras
|      |      | [*]     Console audio control ALSA interface (NEW)
|      |      | [ ]     Maintainer debug facilities (NEW)
|      |      | [ ]     Verbose debug mode (NEW)
|      |      | [ ]     Allow control of important LEDs (unsafe) (NEW)
|      |      | [*]     Video output control support (NEW)
|      |      | [*]     Support NVRAM polling for hot keys (NEW)
|      |      | < >   Eee PC Hotkey Driver
|      |
|      | [*] IOMMU Hardware Support  - - ->
|      |      | - - - IOMMU Hardware Support
|      |      | [ ]   AMD IOMMU support
|      |      | [*]   Support for Intel IOMMU using DMA Remapping Devices
|      |      | [*]     Enable Intel DMA Remapping Devices by default
|      |      | [*]   Support for Interrupt Remapping
|      |
|      | [*] Pulse-Width Modulation (PWM) Support  - - ->
|      |      | <*>   Intel LPSS PWM support
|      |      | <*>     Intel LPSS PWM PCI driver
|      |      | <*>     Intel LPSS PWM platform driver
|      |
|      | [*] Generic powercap sysfs driver  - - ->
|
|    File systems  - - ->
|      |
|      | <*> The Extended 4 (ext4) filesystem
|      | <*> XFS filesystem support
|      | <*> FUSE (Filesystem in Userspace) support
|      |
|      |     Pseudo filesystems  - - ->
|      |      | <*>   EFI Variable filesystem
|      |
|      | [ ] Miscellaneous filesystems  - - - -
|      |
|      | [*] Network File Systems  - - ->
|      |      | - - - Network File Systems
|      |      | <*>   NFS client support
|      |      | < >     NFS client support for NFS version 2
|      |      | < >     NFS client support for NFS version 3
|      |      | <*>     NFS client support for NFS version 4
|      |      | [ ]   Root file system on NFS
|      |      | <*>   CIFS support (advanced network filesystem, SMBFS successor)
|      |      | [ ]     Enable CIFS debugging routines
|
| -*- Cryptographic API  - - ->
|      |
|      |       *** Digest ***
|      | -*-   CRC32c CRC algorithm
|      | <*>   CRC32c INTEL hardware acceleration
|      | -*-   SHA1 digest algorithm
|      | <*>   SHA1 digest algorithm (SSSE3/AVX/AVX2)
|      | <*>   SHA256 digest algorithm (SSSE3/AVX/AVX2)
|      | <*>   SHA512 digest algorithm (SSSE3/AVX/AVX2)
|      |
|      |       *** Ciphers ***
|      | -*-   AES cipher algorithms
|      | -*-   AES cipher algorithms (x86_64)
|      | <*>   AES cipher algorithms (AES-NI)
|      |
|      | [ ]   Hardware crypto devices  - - - - -->
</div>
<div class="section" id="kernel-optional-configuration">
<h2>Kernel optional configuration</h2>
<div class="section" id="kerberos-cryptography-support">
<h3>Kerberos cryptography support</h3>
<pre class="code ini literal-block">
<span class="err">|</span> <span class="err">-*-</span> <span class="err">Cryptographic</span> <span class="err">API</span>  <span class="err">---&gt;</span>
<span class="err">|</span>      <span class="err">|</span> <span class="err">-*-</span> <span class="err">Cryptographic</span> <span class="err">API</span> <span class="err">---&gt;</span>
<span class="err">|</span>      <span class="err">|</span> <span class="err">&lt;*&gt;</span>   <span class="err">CBC</span> <span class="err">support</span>
<span class="err">|</span>      <span class="err">|</span> <span class="err">&lt;*&gt;</span>   <span class="err">CTS</span> <span class="err">support</span>
<span class="err">|</span>      <span class="err">|</span> <span class="err">-*-</span>   <span class="err">ECB</span> <span class="err">support</span>
<span class="err">|</span>      <span class="err">|</span> <span class="err">-*-</span>   <span class="err">HMAC</span> <span class="err">support</span>
<span class="err">|</span>      <span class="err">|</span> <span class="err">-*-</span>   <span class="err">ARC4</span> <span class="err">cipher</span> <span class="err">algorithm</span>
<span class="err">|</span>      <span class="err">|</span> <span class="err">-*-</span>   <span class="err">DES</span> <span class="err">and</span> <span class="err">Triple</span> <span class="err">DES</span> <span class="err">EDE</span> <span class="err">cipher</span> <span class="err">algorithms</span>
<span class="err">|</span>      <span class="err">|</span> <span class="err">&lt;*&gt;</span>   <span class="err">Triple</span> <span class="err">DES</span> <span class="err">EDE</span> <span class="err">cipher</span> <span class="err">algorithm</span> <span class="err">(x86-64)</span>
</pre>
</div>
<div class="section" id="virtualization-with-kvm">
<h3>Virtualization with KVM</h3>
<pre class="code ini literal-block">
<span class="err">|</span>     <span class="err">General</span> <span class="err">setup</span>  <span class="err">---&gt;</span>
<span class="err">|</span>      <span class="err">|</span> <span class="err">-*-</span> <span class="err">Control</span> <span class="err">Group</span> <span class="err">support</span>  <span class="err">---&gt;</span>
<span class="err">|</span>      <span class="err">|</span>        <span class="err">|</span> <span class="err">[*]</span>   <span class="err">Memory</span> <span class="err">Resource</span> <span class="err">Controller</span> <span class="err">for</span> <span class="err">Control</span> <span class="err">Groups</span>
<span class="err">|</span>      <span class="err">|</span>        <span class="err">|</span> <span class="err">[*]</span>     <span class="err">Memory</span> <span class="err">Resource</span> <span class="err">Controller</span> <span class="err">Swap</span> <span class="err">Extension</span>
<span class="err">|</span>      <span class="err">|</span>        <span class="err">|</span> <span class="err">[*]</span>       <span class="err">Memory</span> <span class="err">Resource</span> <span class="err">Controller</span> <span class="err">Swap</span> <span class="err">Extension</span> <span class="err">enabled</span> <span class="err">by</span> <span class="err">default</span> <span class="err">(NEW)</span>
<span class="err">|</span>      <span class="err">|</span>        <span class="err">|</span> <span class="err">[*]</span>     <span class="err">Memory</span> <span class="err">Resource</span> <span class="err">Controller</span> <span class="err">Kernel</span> <span class="err">Memory</span> <span class="err">accounting</span>
<span class="err">|</span>
<span class="err">|</span> <span class="err">[*]</span> <span class="err">Virtualization</span>  <span class="err">---&gt;</span>
<span class="err">|</span>      <span class="err">|</span> <span class="err">---</span> <span class="err">Virtualization</span>
<span class="err">|</span>      <span class="err">|</span> <span class="err">&lt;*&gt;</span>   <span class="err">Kernel-based</span> <span class="err">Virtual</span> <span class="err">Machine</span> <span class="err">(KVM)</span> <span class="err">support</span>
<span class="err">|</span>      <span class="err">|</span> <span class="err">&lt;*&gt;</span>     <span class="err">KVM</span> <span class="err">for</span> <span class="err">Intel</span> <span class="err">processors</span> <span class="err">support</span>
<span class="err">|</span>      <span class="err">|</span> <span class="err">&lt;</span> <span class="err">&gt;</span>     <span class="err">KVM</span> <span class="err">for</span> <span class="err">AMD</span> <span class="err">processors</span> <span class="err">support</span> <span class="err">(NEW)</span>
<span class="err">|</span>      <span class="err">|</span> <span class="err">[</span> <span class="err">]</span>     <span class="err">Audit</span> <span class="err">KVM</span> <span class="err">MMU</span> <span class="err">(NEW)</span>
<span class="err">|</span>      <span class="err">|</span> <span class="err">[</span> <span class="err">]</span>     <span class="err">KVM</span> <span class="err">legacy</span> <span class="err">PCI</span> <span class="err">device</span> <span class="err">assignment</span> <span class="err">support</span>
<span class="err">|</span>      <span class="err">|</span> <span class="err">&lt;</span> <span class="err">&gt;</span>   <span class="err">Host</span> <span class="err">kernel</span> <span class="err">accelerator</span> <span class="err">for</span> <span class="err">virtio</span> <span class="err">net</span> <span class="err">(NEW)</span>
</pre>
<p>Configuration for bridge network</p>
<pre class="code ini literal-block">
<span class="err">|</span> <span class="err">[*]</span> <span class="err">Networking</span> <span class="err">support</span>  <span class="err">---&gt;</span>
<span class="err">|</span>      <span class="err">|</span> <span class="err">---</span> <span class="err">Networking</span> <span class="err">support</span>
<span class="err">|</span>      <span class="err">|</span>       <span class="err">Networking</span> <span class="err">options</span>  <span class="err">---&gt;</span>
<span class="err">|</span>      <span class="err">|</span>        <span class="err">|</span> <span class="err">&lt;*&gt;</span> <span class="err">802.1d</span> <span class="err">Ethernet</span> <span class="err">Bridging</span>
<span class="err">|</span>      <span class="err">|</span>        <span class="err">|</span> <span class="err">[*]</span> <span class="err">Network</span> <span class="err">packet</span> <span class="err">filtering</span> <span class="err">framework</span> <span class="err">(Netfilter)</span>  <span class="err">---&gt;</span>
<span class="err">|</span>      <span class="err">|</span>        <span class="err">|</span>        <span class="err">|</span> <span class="err">&lt;*&gt;</span>   <span class="err">Ethernet</span> <span class="err">Bridge</span> <span class="err">tables</span> <span class="err">(ebtables)</span> <span class="err">support</span>  <span class="err">---&gt;</span>
<span class="err">|</span>      <span class="err">|</span>        <span class="err">|</span>        <span class="err">|</span>        <span class="err">|</span> <span class="err">&lt;*&gt;</span>   <span class="err">ebt:</span> <span class="err">mark</span> <span class="err">target</span> <span class="err">support</span>
<span class="err">|</span>
<span class="err">|</span> <span class="err">Device</span> <span class="err">Drivers</span>  <span class="err">---&gt;</span>
<span class="err">|</span>      <span class="err">|</span> <span class="err">[*]</span> <span class="err">Network</span> <span class="err">device</span> <span class="err">support</span>  <span class="err">---&gt;</span>
<span class="err">|</span>      <span class="err">|</span>      <span class="err">|</span> <span class="err">---</span> <span class="err">Network</span> <span class="err">device</span> <span class="err">support</span>
<span class="err">|</span>      <span class="err">|</span>      <span class="err">|</span> <span class="err">&lt;*&gt;</span>     <span class="err">MAC-VLAN</span> <span class="err">support</span>
<span class="err">|</span>      <span class="err">|</span>      <span class="err">|</span> <span class="err">&lt;*&gt;</span>       <span class="err">MAC-VLAN</span> <span class="err">based</span> <span class="err">tap</span> <span class="err">driver</span>
<span class="err">|</span>      <span class="err">|</span>      <span class="err">|</span> <span class="err">&lt;*&gt;</span>     <span class="err">Universal</span> <span class="err">TUN/TAP</span> <span class="err">device</span> <span class="err">driver</span> <span class="err">support</span>
</pre>
<p>Configuration for virtual network</p>
<pre class="code ini literal-block">
<span class="err">|</span> <span class="err">[*]</span> <span class="err">Networking</span> <span class="err">support</span>  <span class="err">---&gt;</span>
<span class="err">|</span>      <span class="err">|</span> <span class="err">---</span> <span class="err">Networking</span> <span class="err">support</span>
<span class="err">|</span>      <span class="err">|</span>       <span class="err">Networking</span> <span class="err">options</span>  <span class="err">---&gt;</span>
<span class="err">|</span>      <span class="err">|</span>
<span class="err">|</span>      <span class="err">|</span>        <span class="err">|</span> <span class="err">[*]</span> <span class="err">Network</span> <span class="err">packet</span> <span class="err">filtering</span> <span class="err">framework</span> <span class="err">(Netfilter)</span>  <span class="err">---&gt;</span>
<span class="err">|</span>      <span class="err">|</span>        <span class="err">|</span>       <span class="err">|</span> <span class="err">[*]</span>   <span class="err">Advanced</span> <span class="err">netfilter</span> <span class="err">configuration</span>
<span class="err">|</span>      <span class="err">|</span>        <span class="err">|</span>       <span class="err">|</span>       <span class="err">Core</span> <span class="err">Netfilter</span> <span class="err">Configuration</span>  <span class="err">---&gt;</span>
<span class="err">|</span>      <span class="err">|</span>        <span class="err">|</span>       <span class="err">|</span>       <span class="err">|</span> <span class="err">&lt;*&gt;</span>   <span class="err">ctmark</span> <span class="err">target</span> <span class="err">and</span> <span class="err">match</span> <span class="err">support</span>
<span class="err">|</span>      <span class="err">|</span>        <span class="err">|</span>       <span class="err">|</span>       <span class="err">|</span> <span class="err">&lt;*&gt;</span>   <span class="err">CHECKSUM</span> <span class="err">target</span> <span class="err">support</span>
<span class="err">|</span>      <span class="err">|</span>        <span class="err">|</span>       <span class="err">|</span> <span class="err">&lt;*&gt;</span>   <span class="err">Ethernet</span> <span class="err">Bridge</span> <span class="err">tables</span> <span class="err">(ebtables)</span> <span class="err">support</span>  <span class="err">---&gt;</span>
<span class="err">|</span>      <span class="err">|</span>        <span class="err">|</span>       <span class="err">|</span>       <span class="err">|</span> <span class="err">&lt;*&gt;</span>   <span class="err">ebt:</span> <span class="err">nat</span> <span class="err">table</span> <span class="err">support</span>
<span class="err">|</span>      <span class="err">|</span>        <span class="err">|</span>       <span class="err">|</span>       <span class="err">|</span> <span class="err">&lt;*&gt;</span>   <span class="err">ebt:</span> <span class="err">mark</span> <span class="err">target</span> <span class="err">support</span>
<span class="err">|</span>      <span class="err">|</span>        <span class="err">|</span>
<span class="err">|</span>      <span class="err">|</span>        <span class="err">|</span> <span class="err">[*]</span> <span class="err">QoS</span> <span class="err">and/or</span> <span class="err">fair</span> <span class="err">queueing</span>  <span class="err">---&gt;</span>
<span class="err">|</span>      <span class="err">|</span>        <span class="err">|</span>       <span class="err">|</span> <span class="err">&lt;*&gt;</span>   <span class="err">Hierarchical</span> <span class="err">Token</span> <span class="err">Bucket</span> <span class="err">(HTB)</span>
<span class="err">|</span>      <span class="err">|</span>        <span class="err">|</span>       <span class="err">|</span> <span class="err">&lt;*&gt;</span>   <span class="err">Stochastic</span> <span class="err">Fairness</span> <span class="err">Queueing</span> <span class="err">(SFQ)</span>
<span class="err">|</span>      <span class="err">|</span>        <span class="err">|</span>       <span class="err">|</span> <span class="err">&lt;*&gt;</span>   <span class="err">Ingress</span> <span class="err">Qdisc</span>
<span class="err">|</span>      <span class="err">|</span>        <span class="err">|</span>       <span class="err">|</span> <span class="err">&lt;*&gt;</span>   <span class="err">Netfilter</span> <span class="err">mark</span> <span class="err">(FW)</span>
<span class="err">|</span>      <span class="err">|</span>        <span class="err">|</span>       <span class="err">|</span> <span class="err">&lt;*&gt;</span>   <span class="err">Universal</span> <span class="err">32bit</span> <span class="err">comparisons</span> <span class="err">w/</span> <span class="err">hashing</span> <span class="err">(U32)</span>
<span class="err">|</span>      <span class="err">|</span>        <span class="err">|</span>       <span class="err">|</span> <span class="err">[*]</span>   <span class="err">Actions</span>
<span class="err">|</span>      <span class="err">|</span>        <span class="err">|</span>       <span class="err">|</span> <span class="err">&lt;*&gt;</span>     <span class="err">Traffic</span> <span class="err">Policing</span>
</pre>
</div>
<div class="section" id="chromimum">
<h3>Chromimum</h3>
<pre class="code ini literal-block">
<span class="err">|</span> <span class="err">General</span> <span class="err">setup</span>  <span class="err">---&gt;</span>
<span class="err">|</span>      <span class="err">|</span> <span class="err">-*-</span> <span class="err">Namespaces</span> <span class="err">support</span>  <span class="err">---&gt;</span>
<span class="err">|</span>      <span class="err">|</span>      <span class="err">|</span> <span class="err">[*]</span>   <span class="err">User</span> <span class="err">namespace</span>
</pre>
</div>
</div>
<div class="section" id="kernel-compilation">
<h2>Kernel compilation</h2>
<pre class="code console literal-block">
<span class="gp">#</span> make <span class="o">&amp;&amp;</span> make modules_install
</pre>
</div>
<div class="section" id="id1">
<h2>Kernel installation</h2>
<p>Mount ESP (EFI System Partition)</p>
<pre class="code console literal-block">
<span class="gp">#</span> mkdir /mnt/ESP
<span class="gp">#</span> mount /dev/sda2 /mnt/ESP
</pre>
<p>Create directory</p>
<pre class="code console literal-block">
<span class="gp">#</span> mkdir /mnt/ESP/EFI/GentooLinux
</pre>
<p>Copy kernel</p>
<pre class="code console literal-block">
<span class="gp">#</span> cp /usr/src/linux/arch/x86_64/boot/bzImage /mnt/ESP/EFI/GentooLinux/4.4.6.efi
</pre>
<p>Unmount ESP (EFI System Partition)</p>
<pre class="code console literal-block">
<span class="gp">#</span> umount /mnt/ESP
</pre>
</div>
<div class="section" id="update-uefi-bootloader">
<h2>Update UEFI bootloader</h2>
<p>Install EFI boot manager</p>
<pre class="code console literal-block">
<span class="gp">#</span> emerge efibootmgr
</pre>
<p>Add the new kernel</p>
<pre class="code console literal-block">
<span class="gp">#</span> efibootmgr -c -d /dev/sda -p <span class="m">2</span> -L <span class="s2">"Gentoo Linux 4.4.6"</span> -l <span class="s2">"\EFI\GentooLinux\4.4.6.efi"</span>
</pre>
<p>Print the menu</p>
<pre class="code console literal-block">
<span class="gp">#</span> efibootmgr -v
</pre>
<p>Remove the previous kernel (after testing the new kernel)</p>
<pre class="code console literal-block">
<span class="gp">#</span> efibootmgr -b <span class="m">15</span> -B
</pre>
</div>
<div class="section" id="references">
<h2>References</h2>
<blockquote>
<ul class="simple">
<li><a class="reference external" href="https://wiki.gentoo.org/wiki/EFI_stub_kernel">Wiki Gentoo - EFI stub kernel</a></li>
</ul>
</blockquote>
</div>

            </div>
            <!-- /.entry-content -->
        </article>
    </section>

        </div>
        <div class="col-sm-3" id="sidebar">
            <aside>
<div id="aboutme">
        <p>
            <img width="60%" class="img-thumbnail" src="/images/avatar.png"/>
        </p>
    <p>
        <strong>About D. Bernaudeau</strong><br/>
        Iâ€™m Didier Bernaudeau, an Information Systems Security Professional. This site is a way to note some experimentations.
    </p>
</div>
<section class="well well-sm">
    <ul class="list-group list-group-flush">



            <li class="list-group-item"><a href="http://didier.bernaudeau.net/"><h4><i class="fa fa-tags fa-lg"></i><span class="icon-label">Tags</span></h4></a>
                <ul class="list-group list-inline tagcloud" id="tags">
                    <li class="list-group-item tag-2">
                        <a href="http://didier.bernaudeau.net/tag/certificate.html">
                            Certificate
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://didier.bernaudeau.net/tag/cryptography.html">
                            Cryptography
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://didier.bernaudeau.net/tag/development.html">
                            Development
                        </a>
                    </li>
                    <li class="list-group-item tag-1">
                        <a href="http://didier.bernaudeau.net/tag/gentoo.html">
                            Gentoo
                        </a>
                    </li>
                    <li class="list-group-item tag-1">
                        <a href="http://didier.bernaudeau.net/tag/hardware.html">
                            Hardware
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://didier.bernaudeau.net/tag/html.html">
                            HTML
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://didier.bernaudeau.net/tag/javascript.html">
                            JavaScript
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://didier.bernaudeau.net/tag/linux.html">
                            Linux
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://didier.bernaudeau.net/tag/network.html">
                            Network
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://didier.bernaudeau.net/tag/pelican.html">
                            Pelican
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://didier.bernaudeau.net/tag/php.html">
                            PHP
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://didier.bernaudeau.net/tag/pki.html">
                            PKI
                        </a>
                    </li>
                    <li class="list-group-item tag-1">
                        <a href="http://didier.bernaudeau.net/tag/press-review.html">
                            Press review
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://didier.bernaudeau.net/tag/software.html">
                            Software
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://didier.bernaudeau.net/tag/virtualization.html">
                            Virtualization
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://didier.bernaudeau.net/tag/website.html">
                            WebSite
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://didier.bernaudeau.net/tag/windows.html">
                            Windows
                        </a>
                    </li>
                </ul>
            </li>


    </ul>
</section>
            </aside>
        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2016 D. Bernaudeau
            &middot; Powered by <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>              <p><small>  <a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/"><img alt="Creative Commons License" style="border-width:0" src="//i.creativecommons.org/l/by-nc-nd/4.0/80x15.png" /></a>
    Content
  licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/">Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License</a>, except where indicated otherwise.
</small></p>
         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="http://didier.bernaudeau.net/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="http://didier.bernaudeau.net/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="http://didier.bernaudeau.net/theme/js/respond.min.js"></script>


</body>
</html>