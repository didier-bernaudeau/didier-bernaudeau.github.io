<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>My personal blog note - Tutorials</title><link href="http://didier.bernaudeau.net/" rel="alternate"></link><link href="http://didier.bernaudeau.net/feeds/tutorials.atom.xml" rel="self"></link><id>http://didier.bernaudeau.net/</id><updated>2018-04-15T09:08:00+02:00</updated><entry><title>Asynchronous GPIO interupts</title><link href="http://didier.bernaudeau.net/Asynchronous_GPIO_interupts.html" rel="alternate"></link><published>2018-04-15T09:08:00+02:00</published><updated>2018-04-14T09:48:00+02:00</updated><author><name>Didier BERNAUDEAU</name></author><id>tag:didier.bernaudeau.net,2018-04-15:/Asynchronous_GPIO_interupts.html</id><summary type="html">&lt;p&gt;Rpi.GPIO is a powerful framework to control GPIO on Raspberry. However, this framework is not really compatible with asynchronous programming.&lt;/p&gt;
&lt;p&gt;Actually, a part of the documentation says: &lt;strong&gt;"the callback functions are run sequentially, not concurrently. This is because there is only one thread used for callbacks, in which every callback is run, in the order in which they have been defined"&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;So, this post describes a workaround to make asynchronous GPIO interupts.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;Rpi.GPIO is a powerful framework to control GPIO on Raspberry. However, this framework is not really compatible with asynchronous programming.&lt;/p&gt;
&lt;p&gt;Actually, a part of the documentation says: &lt;strong&gt;"the callback functions are run sequentially, not concurrently. This is because there is only one thread used for callbacks, in which every callback is run, in the order in which they have been defined"&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;So, this post describes a workaround to make asynchronous GPIO interupts.&lt;/p&gt;

&lt;p&gt;For this example, a switch button is connected on 3,3V and GPIO 4 (PIN 7).&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;asyncio&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;RPi.GPIO&lt;/span&gt; &lt;span class="kn"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;GPIO&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;sys&lt;/span&gt;

&lt;span class="n"&gt;loop&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;FunctionEventCallback&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Channel&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Event detected: "&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Channel&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;GPIO&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"closed"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Open"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;StartEventThread&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;PinGPIO&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Pin: "&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;PinGPIO&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="n"&gt;loop&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;call_soon_threadsafe&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;FunctionEventCallback&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;PinGPIO&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s1"&gt;'__main__'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="c1"&gt;# setup the GPIO&lt;/span&gt;
        &lt;span class="n"&gt;GPIO&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;setwarnings&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;GPIO&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;setmode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;GPIO&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;BOARD&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;GPIO&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;setup&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;GPIO&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;IN&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pull_up_down&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;GPIO&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;PUD_DOWN&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;GPIO&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_event_detect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;GPIO&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;BOTH&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;callback&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;StartEventThread&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bouncetime&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;300&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="c1"&gt;# run the event loop&lt;/span&gt;
        &lt;span class="n"&gt;loop&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;asyncio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_event_loop&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="n"&gt;loop&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;run_forever&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="n"&gt;loop&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Error:"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exc_info&lt;/span&gt;&lt;span class="p"&gt;()[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;

    &lt;span class="c1"&gt;# cleanup&lt;/span&gt;
    &lt;span class="n"&gt;GPIO&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cleanup&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Then run it :&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; python3.5 script.py
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;Reminder:&lt;/strong&gt; the framework "rpi-gpio.js" supports asynchronous programming but it doesn't support pull up/down resistor yet. Wait &amp;amp; see !&lt;/p&gt;</content><category term="Python"></category><category term="Rpi.GPIO"></category></entry><entry><title>WebSocket server in Python</title><link href="http://didier.bernaudeau.net/WebSocketServerPython.html" rel="alternate"></link><published>2018-03-28T11:08:00+02:00</published><updated>2018-03-28T12:17:00+02:00</updated><author><name>Didier BERNAUDEAU</name></author><id>tag:didier.bernaudeau.net,2018-03-28:/WebSocketServerPython.html</id><summary type="html">&lt;p&gt;This post will walk-through programming a WebSocket server in Python with Gevent WebSocket. It's difficult to use this framework because the documentation is very poor.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;This post will walk-through programming a WebSocket server in Python with Gevent WebSocket. It's difficult to use this framework because the documentation is very poor.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Install python tool&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo apt-get install python3-pip
&lt;span class="gp"&gt;$&lt;/span&gt; sudo pip3 install virtualenv 
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Create virtual environment&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; virtualenv --python&lt;span class="o"&gt;=&lt;/span&gt;/usr/bin/python3.5 PyWS
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Enable virtual environment&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; &lt;span class="nb"&gt;cd&lt;/span&gt; PyWS
&lt;span class="gp"&gt;$&lt;/span&gt; &lt;span class="nb"&gt;source&lt;/span&gt; bin/activate
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Install Gevent WebSocket&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; pip install gevent-websocket
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Create App&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; nano PyWS.py
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;geventwebsocket&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;WebSocketServer&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;WebSocketApplication&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Resource&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;collections&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;OrderedDict&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;GreetingsApplication&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;WebSocketApplication&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;on_open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Connection opened"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;on_message&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;UserName&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ws&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;send&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Hello "&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;UserName&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;"!"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;UserName&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;on_close&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Connection closed!"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s1"&gt;'__main__'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;WebSocketServer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
      &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'0.0.0.0'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;8000&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
      &lt;span class="n"&gt;Resource&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;OrderedDict&lt;/span&gt;&lt;span class="p"&gt;([(&lt;/span&gt;&lt;span class="s1"&gt;'/'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;GreetingsApplication&lt;/span&gt;&lt;span class="p"&gt;)]))&lt;/span&gt;
    &lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;serve_forever&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Run WebSocket server&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; bin/python3.5 PyWS.py
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Test with "Smart websocket client" (chrome add-ons)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Quit&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; deactivate
&lt;/pre&gt;&lt;/div&gt;</content><category term="Python"></category><category term="WebSocket"></category></entry><entry><title>WebSocket front end with Angular</title><link href="http://didier.bernaudeau.net/WebSocket_frontend_with_Angular.html" rel="alternate"></link><published>2018-03-25T12:17:00+02:00</published><updated>2018-03-28T12:24:00+02:00</updated><author><name>Didier BERNAUDEAU</name></author><id>tag:didier.bernaudeau.net,2018-03-25:/WebSocket_frontend_with_Angular.html</id><summary type="html">&lt;p&gt;RxJS (Reactive-Extensions) is the library chosen by Angular to build reactive application. This post will walk-through programming a websocket client in a web browser.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;RxJS (Reactive-Extensions) is the library chosen by Angular to build reactive application. This post will walk-through programming a websocket client in a web browser.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Create Angular Application&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; ng new WebSocket
&lt;span class="gp"&gt;$&lt;/span&gt; &lt;span class="nb"&gt;cd&lt;/span&gt; WebSocket
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Create services&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; ng g service WebSocketEcho
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; nano src/app/web-socket-echo.service.ts
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;import&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="nx"&gt;Injectable&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="nx"&gt;from&lt;/span&gt; &lt;span class="s1"&gt;'@angular/core'&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="kr"&gt;import&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="kr"&gt;as&lt;/span&gt; &lt;span class="nx"&gt;Rx&lt;/span&gt; &lt;span class="nx"&gt;from&lt;/span&gt; &lt;span class="s1"&gt;'rxjs/Rx'&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="kd"&gt;@Injectable&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="kr"&gt;export&lt;/span&gt; &lt;span class="kr"&gt;class&lt;/span&gt; &lt;span class="nx"&gt;WebSocketEchoService&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;

  &lt;span class="kr"&gt;constructor&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt;

  &lt;span class="kr"&gt;private&lt;/span&gt; &lt;span class="nx"&gt;subject&lt;/span&gt;: &lt;span class="kt"&gt;Rx.Subject&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;MessageEvent&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

  &lt;span class="kr"&gt;public&lt;/span&gt; &lt;span class="nx"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;url&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;Rx&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;Subject&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;MessageEvent&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;subject&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
      &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;subject&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;create&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;url&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
      &lt;span class="nx"&gt;console&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Successfully connected: "&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nx"&gt;url&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt; 
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;subject&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt;

  &lt;span class="kr"&gt;private&lt;/span&gt; &lt;span class="nx"&gt;create&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;url&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;Rx&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;Subject&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;MessageEvent&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;ws&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="nx"&gt;WebSocket&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;url&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;observable&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;Rx&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;Observable&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;create&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
      &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;obs&lt;/span&gt;: &lt;span class="kt"&gt;Rx.Observer&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;MessageEvent&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nx"&gt;ws&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;onmessage&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;obs&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;next&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;bind&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;obs&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="nx"&gt;ws&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;onerror&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;obs&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;error&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;bind&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;obs&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="nx"&gt;ws&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;onclose&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;obs&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;complete&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;bind&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;obs&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;ws&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;close&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;bind&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;ws&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;})&lt;/span&gt;

    &lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;observer&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
      &lt;span class="nx"&gt;next&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;data&lt;/span&gt;: &lt;span class="kt"&gt;Object&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;ws&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;readyState&lt;/span&gt; &lt;span class="o"&gt;===&lt;/span&gt; &lt;span class="nx"&gt;WebSocket&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;OPEN&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
          &lt;span class="nx"&gt;ws&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;send&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;JSON&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;stringify&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
      &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;Rx&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;Subject&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;create&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;observer&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;observable&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; ng g service chat
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; nano src/app/chat.service.ts
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;import&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="nx"&gt;Injectable&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="nx"&gt;from&lt;/span&gt; &lt;span class="s1"&gt;'@angular/core'&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="kr"&gt;import&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="nx"&gt;Observable&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;Subject&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="nx"&gt;from&lt;/span&gt; &lt;span class="s1"&gt;'rxjs/Rx'&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="kr"&gt;import&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="nx"&gt;WebSocketEchoService&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="nx"&gt;from&lt;/span&gt; &lt;span class="s1"&gt;'./web-socket-echo.service'&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;CHAT_URL&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'ws://echo.websocket.org/'&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="kr"&gt;export&lt;/span&gt; &lt;span class="kr"&gt;interface&lt;/span&gt; &lt;span class="nx"&gt;Message&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="nx"&gt;author&lt;/span&gt;: &lt;span class="kt"&gt;string&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="nx"&gt;message&lt;/span&gt;: &lt;span class="kt"&gt;string&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;


&lt;span class="kd"&gt;@Injectable&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="kr"&gt;export&lt;/span&gt; &lt;span class="kr"&gt;class&lt;/span&gt; &lt;span class="nx"&gt;ChatService&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;

  &lt;span class="kr"&gt;public&lt;/span&gt; &lt;span class="nx"&gt;messages&lt;/span&gt;: &lt;span class="kt"&gt;Subject&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;Message&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

  &lt;span class="kr"&gt;constructor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;wsService&lt;/span&gt;: &lt;span class="kt"&gt;WebSocketEchoService&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;messages&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;Subject&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;Message&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="nx"&gt;wsService&lt;/span&gt;
      &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;CHAT_URL&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
      &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;map&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="nx"&gt;response&lt;/span&gt;: &lt;span class="kt"&gt;MessageEvent&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;Message&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;JSON&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;parse&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;response&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
          &lt;span class="nx"&gt;author&lt;/span&gt;: &lt;span class="kt"&gt;data.author&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
          &lt;span class="nx"&gt;message&lt;/span&gt;: &lt;span class="kt"&gt;data.message&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
      &lt;span class="p"&gt;});&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Custom Angular application&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; nano src/app/app.component.ts
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;import&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="nx"&gt;Component&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="nx"&gt;from&lt;/span&gt; &lt;span class="s1"&gt;'@angular/core'&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="kr"&gt;import&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="nx"&gt;WebSocketEchoService&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="nx"&gt;from&lt;/span&gt; &lt;span class="s1"&gt;'./web-socket-echo.service'&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="kr"&gt;import&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="nx"&gt;ChatService&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="nx"&gt;from&lt;/span&gt; &lt;span class="s1"&gt;'./chat.service'&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="kd"&gt;@Component&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;
  &lt;span class="nx"&gt;selector&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'app-root'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="nx"&gt;templateUrl&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'./app.component.html'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="nx"&gt;styleUrls&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'./app.component.css'&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
  &lt;span class="nx"&gt;providers&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="nx"&gt;WebSocketEchoService&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;ChatService&lt;/span&gt; &lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="p"&gt;})&lt;/span&gt;

&lt;span class="kr"&gt;export&lt;/span&gt; &lt;span class="kr"&gt;class&lt;/span&gt; &lt;span class="nx"&gt;AppComponent&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="nx"&gt;title&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'app'&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

  &lt;span class="kr"&gt;constructor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kr"&gt;private&lt;/span&gt; &lt;span class="nx"&gt;chatService&lt;/span&gt;: &lt;span class="kt"&gt;ChatService&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nx"&gt;chatService&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;messages&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;subscribe&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;msg&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;         
      &lt;span class="nx"&gt;console&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Response from websocket: "&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nx"&gt;msg&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="p"&gt;});&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

  &lt;span class="kr"&gt;private&lt;/span&gt; &lt;span class="nx"&gt;message&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nx"&gt;author&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'Tux'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="nx"&gt;message&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'this is a test message'&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

  &lt;span class="nx"&gt;sendMsg() {&lt;/span&gt;
        &lt;span class="nx"&gt;console&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'new message from client to websocket: '&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;message&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;chatService&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;messages&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;next&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;message&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;message&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;message&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;''&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; nano src/app/app.component.html
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c"&gt;&amp;lt;!-- app.component.html --&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;h1&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
  Angular 2 WebSockets Tutorial
&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;h1&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;

&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;button&lt;/span&gt; &lt;span class="err"&gt;(&lt;/span&gt;&lt;span class="na"&gt;click&lt;/span&gt;&lt;span class="err"&gt;)="&lt;/span&gt;&lt;span class="na"&gt;sendMsg&lt;/span&gt;&lt;span class="err"&gt;()"&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Send Message&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;button&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Running the development server&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; ng serve --open
&lt;/pre&gt;&lt;/div&gt;
&lt;!-- https://tutorialedge.net/typescript/angular/angular-websockets-tutorial/ --&gt;</content><category term="Angular"></category><category term="WebSocket"></category></entry><entry><title>How to use SNMP on a Cisco SG200</title><link href="http://didier.bernaudeau.net/HowTo_use_SNMP_on_a_Cisco_SG200.html" rel="alternate"></link><published>2018-02-20T17:07:00+01:00</published><updated>2018-02-25T11:29:00+01:00</updated><author><name>Didier BERNAUDEAU</name></author><id>tag:didier.bernaudeau.net,2018-02-20:/HowTo_use_SNMP_on_a_Cisco_SG200.html</id><summary type="html">&lt;p&gt;SNMP is a protocol largely used to monitor network hardware, and I would have used it to monitor my CISCO SG200 but the implementation is very limited. For instance, this switch doesn't have temperature sensor. This post walks you through configuring the swith then installing SNMP tools on your computer.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;SNMP is a protocol largely used to monitor network hardware, and I would have used it to monitor my CISCO SG200 but the implementation is very limited. For instance, this switch doesn't have temperature sensor. This post walks you through configuring the swith then installing SNMP tools on your computer.&lt;/p&gt;

&lt;h1&gt;Switch configuration&lt;/h1&gt;
&lt;p&gt;The web console is the only way to manage the SG200 because it doesn't support any CLI.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Create an SNMP community: SNMP &amp;gt; Communities&lt;/li&gt;
&lt;/ul&gt;
&lt;p align="center"&gt;&lt;img class="img-responsive" src="images/2018-02-20_HowTo_use_SNMP_on_a_Cisco_SG200.png" width="60%"/&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Allow SNMP service : Security &amp;gt; TCP/UDP Services&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Save the new configuration&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;Install SNMP tools&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Install Net SNMP&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; emerge -pv net-analyzer/net-snmp
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Create directory for MIB files&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; mkdir -p ~/.snmp/mibs
&lt;span class="gp"&gt;$&lt;/span&gt; &lt;span class="nb"&gt;cd&lt;/span&gt; ~/.snmp/mibs
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Download MIB&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; wget http://www.circitor.fr/Mibs/Mib/C/CISCOSB-MIB.mib
&lt;span class="gp"&gt;$&lt;/span&gt; wget http://www.circitor.fr/Mibs/Mib/C/CISCOSB-HWENVIROMENT.mib
&lt;span class="gp"&gt;$&lt;/span&gt; wget http://www.circitor.fr/Mibs/Mib/C/CISCOSB-rndMng.mib
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;SNMP request&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Parse all OID&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; snmpwalk -Os -v2c -c private &lt;span class="m"&gt;10&lt;/span&gt;.93.3.25 .1.3.6.1.4.1.9.6.1
&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;Processor&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;CPU utilization during last second&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; snmpwalk -m ~/.snmp/mibs/CISCOSB-rndMng.mib -Os -v2c -c private &lt;span class="m"&gt;10&lt;/span&gt;.93.3.25 .1.3.6.1.4.1.9.6.1.101.1.7
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;rlCpuUtilDuringLastSecond.0 = INTEGER: 21
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;CPU utilization during last minute&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; snmpwalk -m ~/.snmp/mibs/CISCOSB-rndMng.mib -Os -v2c -c private &lt;span class="m"&gt;10&lt;/span&gt;.93.3.25 .1.3.6.1.4.1.9.6.1.101.1.8
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;rlCpuUtilDuringLastMinute.0 = INTEGER: 1
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;CPU utilization during last 5 minutes&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; snmpwalk -m ~/.snmp/mibs/CISCOSB-rndMng.mib -Os -v2c -c private &lt;span class="m"&gt;10&lt;/span&gt;.93.3.25 .1.3.6.1.4.1.9.6.1.101.1.9
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;rlCpuUtilDuringLast5Minutes.0 = INTEGER: 1
&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;Fan&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; snmpwalk -m ~/.snmp/mibs/CISCOSB-HWENVIROMENT.mib -Os -v2c -c public &lt;span class="m"&gt;10&lt;/span&gt;.93.3.25 .1.3.6.1.4.1.9.6.1.101.83
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;rlEnvMonFanStatusDescr.67109249 = STRING: fan1_unit1
rlEnvMonFanStatusDescr.67109250 = STRING: fan2_unit1
rlEnvMonFanStatusDescr.67109251 = STRING: fan3_unit1
rlEnvMonFanStatusDescr.67109252 = STRING: fan4_unit1
rlEnvMonFanState.67109249 = INTEGER: normal(1)
rlEnvMonFanState.67109250 = INTEGER: notPresent(5)
rlEnvMonFanState.67109251 = INTEGER: notPresent(5)
rlEnvMonFanState.67109252 = INTEGER: notPresent(5)
rlEnvFanDataStackUnit.1 = INTEGER: 1
rlEnvFanDataTemp.1 = INTEGER: 0
rlEnvFanDataSpeed.1 = INTEGER: 0
rlEnvFanDataOperLevel.1 = INTEGER: 0
rlEnvFanDataAdminLevel.1 = INTEGER: 0
rlEnvFanDataDirection.1 = INTEGER: unKnown(1)
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;As you can see, the temperature data (FanDataTemp) is not relevant. Another OID regarding temperature is ".1.3.6.1.4.1.9.9.13.1.3.1.3" from CISCOSB-HWENVIROMENT.mib but it's not supported by Switch SG200.&lt;/p&gt;</content><category term="Cisco"></category><category term="Network"></category><category term="SNMP"></category></entry><entry><title>Building an API Gateway with Spring Cloud - Part 3 (Zuul)</title><link href="http://didier.bernaudeau.net/Building_an_API_Gateway_with_SpringCloud_Zuul.html" rel="alternate"></link><published>2018-02-02T12:22:00+01:00</published><updated>2018-01-31T14:43:00+01:00</updated><author><name>Didier BERNAUDEAU</name></author><id>tag:didier.bernaudeau.net,2018-02-02:/Building_an_API_Gateway_with_SpringCloud_Zuul.html</id><summary type="html">&lt;p&gt;This post walks you through installing an embedded Zuul which is part of Spring Cloud developed by netflix OSS (Open Source Software). Zuul will use Eureka server in order to know how and where to route incoming requests and Ribbon to forward requests to the microservice. Ribbon is a HTTP client which allows client side load balancing.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;This post walks you through installing an embedded Zuul which is part of Spring Cloud developed by netflix OSS (Open Source Software). Zuul will use Eureka server in order to know how and where to route incoming requests and Ribbon to forward requests to the microservice. Ribbon is a HTTP client which allows client side load balancing.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Create the directory structure&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; mkdir -p zuul/src/main/java/zuul
&lt;span class="gp"&gt;$&lt;/span&gt; mkdir -p zuul/src/main/resources
&lt;span class="gp"&gt;$&lt;/span&gt; &lt;span class="nb"&gt;cd&lt;/span&gt; zuul
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Create a Gradle build file&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; nano build.gradle
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;buildscript&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
  &lt;span class="n"&gt;repositories&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;mavenCentral&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt;
  &lt;span class="o"&gt;}&lt;/span&gt;
  &lt;span class="n"&gt;dependencies&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;classpath&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"org.springframework.boot:spring-boot-gradle-plugin:1.5.10.RELEASE"&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
  &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;


&lt;span class="n"&gt;apply&lt;/span&gt; &lt;span class="nl"&gt;plugin:&lt;/span&gt; &lt;span class="s1"&gt;'java'&lt;/span&gt;
&lt;span class="n"&gt;apply&lt;/span&gt; &lt;span class="nl"&gt;plugin:&lt;/span&gt; &lt;span class="s1"&gt;'org.springframework.boot'&lt;/span&gt;
&lt;span class="n"&gt;apply&lt;/span&gt; &lt;span class="nl"&gt;plugin:&lt;/span&gt; &lt;span class="s1"&gt;'io.spring.dependency-management'&lt;/span&gt;

&lt;span class="n"&gt;jar&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;baseName&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'gateway-zuul'&lt;/span&gt;
    &lt;span class="n"&gt;version&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'1.0'&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="n"&gt;sourceCompatibility&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;1.8&lt;/span&gt;
&lt;span class="n"&gt;targetCompatibility&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;1.8&lt;/span&gt;

&lt;span class="n"&gt;repositories&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;mavenCentral&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;

&lt;span class="n"&gt;dependencies&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;compile&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'org.springframework.cloud:spring-cloud-starter-eureka'&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;compile&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'org.springframework.cloud:spring-cloud-starter-zuul'&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;compile&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'org.springframework.boot:spring-boot-starter-web'&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;

&lt;span class="n"&gt;dependencyManagement&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
  &lt;span class="n"&gt;imports&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;mavenBom&lt;/span&gt; &lt;span class="s1"&gt;'org.springframework.cloud:spring-cloud-dependencies:Edgware.RELEASE'&lt;/span&gt;
  &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Create application&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; nano src/main/java/zuul/GatewayZuulApplication.java
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;package&lt;/span&gt; &lt;span class="nn"&gt;zuul&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;

&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;org.springframework.boot.SpringApplication&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;org.springframework.boot.autoconfigure.SpringBootApplication&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;org.springframework.cloud.netflix.zuul.EnableZuulProxy&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;

&lt;span class="nd"&gt;@EnableZuulProxy&lt;/span&gt;
&lt;span class="nd"&gt;@SpringBootApplication&lt;/span&gt;
&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;GatewayZuulApplication&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;

  &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;SpringApplication&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;run&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;GatewayZuulApplication&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
  &lt;span class="o"&gt;}&lt;/span&gt;

&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Configure Zuul&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; nano src/main/resources/application.yml
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;spring&lt;/span&gt;&lt;span class="p p-Indicator"&gt;:&lt;/span&gt;
  &lt;span class="l l-Scalar l-Scalar-Plain"&gt;application&lt;/span&gt;&lt;span class="p p-Indicator"&gt;:&lt;/span&gt;
    &lt;span class="l l-Scalar l-Scalar-Plain"&gt;name&lt;/span&gt;&lt;span class="p p-Indicator"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;zuul&lt;/span&gt;

&lt;span class="l l-Scalar l-Scalar-Plain"&gt;ribbon&lt;/span&gt;&lt;span class="p p-Indicator"&gt;:&lt;/span&gt; 
  &lt;span class="l l-Scalar l-Scalar-Plain"&gt;ConnectTimeout&lt;/span&gt;&lt;span class="p p-Indicator"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;30000&lt;/span&gt;
  &lt;span class="l l-Scalar l-Scalar-Plain"&gt;ReadTimeout&lt;/span&gt;&lt;span class="p p-Indicator"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;990000&lt;/span&gt;
  &lt;span class="l l-Scalar l-Scalar-Plain"&gt;maxAutoRetries&lt;/span&gt;&lt;span class="p p-Indicator"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;1&lt;/span&gt;
  &lt;span class="l l-Scalar l-Scalar-Plain"&gt;MaxAutoRetriesNextServer&lt;/span&gt;&lt;span class="p p-Indicator"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;2&lt;/span&gt;
  &lt;span class="l l-Scalar l-Scalar-Plain"&gt;eureka&lt;/span&gt;&lt;span class="p p-Indicator"&gt;:&lt;/span&gt;
    &lt;span class="l l-Scalar l-Scalar-Plain"&gt;enabled&lt;/span&gt;&lt;span class="p p-Indicator"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;true&lt;/span&gt;

&lt;span class="l l-Scalar l-Scalar-Plain"&gt;server&lt;/span&gt;&lt;span class="p p-Indicator"&gt;:&lt;/span&gt; 
  &lt;span class="l l-Scalar l-Scalar-Plain"&gt;port&lt;/span&gt;&lt;span class="p p-Indicator"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;8080&lt;/span&gt;

&lt;span class="l l-Scalar l-Scalar-Plain"&gt;zuul&lt;/span&gt;&lt;span class="p p-Indicator"&gt;:&lt;/span&gt; 
  &lt;span class="l l-Scalar l-Scalar-Plain"&gt;ignoredServices&lt;/span&gt;&lt;span class="p p-Indicator"&gt;:&lt;/span&gt; &lt;span class="s"&gt;'*'&lt;/span&gt;
  &lt;span class="l l-Scalar l-Scalar-Plain"&gt;routes&lt;/span&gt;&lt;span class="p p-Indicator"&gt;:&lt;/span&gt;
    &lt;span class="l l-Scalar l-Scalar-Plain"&gt;api&lt;/span&gt;&lt;span class="p p-Indicator"&gt;:&lt;/span&gt;
      &lt;span class="l l-Scalar l-Scalar-Plain"&gt;path&lt;/span&gt;&lt;span class="p p-Indicator"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;/api/**&lt;/span&gt;
      &lt;span class="l l-Scalar l-Scalar-Plain"&gt;serviceId&lt;/span&gt;&lt;span class="p p-Indicator"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;api&lt;/span&gt;
      &lt;span class="l l-Scalar l-Scalar-Plain"&gt;sensitiveHeaders&lt;/span&gt;&lt;span class="p p-Indicator"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;Authorization&lt;/span&gt;

&lt;span class="l l-Scalar l-Scalar-Plain"&gt;eureka&lt;/span&gt;&lt;span class="p p-Indicator"&gt;:&lt;/span&gt;
  &lt;span class="l l-Scalar l-Scalar-Plain"&gt;client&lt;/span&gt;&lt;span class="p p-Indicator"&gt;:&lt;/span&gt;
    &lt;span class="l l-Scalar l-Scalar-Plain"&gt;serviceUrl&lt;/span&gt;&lt;span class="p p-Indicator"&gt;:&lt;/span&gt;
      &lt;span class="l l-Scalar l-Scalar-Plain"&gt;defaultZone&lt;/span&gt;&lt;span class="p p-Indicator"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;http://localhost:8761/eureka/&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Build&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; gradle build
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Start Eureka and Microservice instances&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Run&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; java -jar build/libs/gateway-zuul-1.0.jar
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;List routes&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; curl http://localhost:8080/routes
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Test API access&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="go"&gt;curl http://localhost:8080/api/greeting&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;{"id":8,"content":"Hello, World!"}
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;What still needs to be done&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Secure access to "routes" path&lt;/li&gt;
&lt;li&gt;Add Hystrix dashboard&lt;/li&gt;
&lt;li&gt;Add User Account and Authentication service&lt;/li&gt;
&lt;/ul&gt;</content><category term="Spring"></category><category term="Spring Cloud"></category><category term="Java"></category></entry><entry><title>Building an API Gateway with Spring Cloud - Part 3 (API)</title><link href="http://didier.bernaudeau.net/Building_an_API_Gateway_with_SpringCloud_API.html" rel="alternate"></link><published>2018-01-31T15:22:00+01:00</published><updated>2018-01-31T15:22:00+01:00</updated><author><name>Didier BERNAUDEAU</name></author><id>tag:didier.bernaudeau.net,2018-01-31:/Building_an_API_Gateway_with_SpringCloud_API.html</id><summary type="html">&lt;p&gt;This post walks you through developing a REST API with @restcontroller component from Spring Boot Framework. This API will be installed in a Spring Cloud infrastructure : Zull, Eureka, ...&lt;/p&gt;
</summary><content type="html">&lt;p&gt;This post walks you through developing a REST API with @restcontroller component from Spring Boot Framework. This API will be installed in a Spring Cloud infrastructure : Zull, Eureka, ...&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Create the directory structure&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; mkdir -p api/src/main/java/api
&lt;span class="gp"&gt;$&lt;/span&gt; mkdir -p api/src/main/resources
&lt;span class="gp"&gt;$&lt;/span&gt; &lt;span class="nb"&gt;cd&lt;/span&gt; api
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Create a Gradle build file&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; nano build.gradle 
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;buildscript&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
  &lt;span class="n"&gt;repositories&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;mavenCentral&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt;
  &lt;span class="o"&gt;}&lt;/span&gt;
  &lt;span class="n"&gt;dependencies&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;classpath&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"org.springframework.boot:spring-boot-gradle-plugin:1.5.10.RELEASE"&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
  &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;

&lt;span class="n"&gt;apply&lt;/span&gt; &lt;span class="nl"&gt;plugin:&lt;/span&gt; &lt;span class="s1"&gt;'java'&lt;/span&gt;
&lt;span class="n"&gt;apply&lt;/span&gt; &lt;span class="nl"&gt;plugin:&lt;/span&gt; &lt;span class="s1"&gt;'org.springframework.boot'&lt;/span&gt;

&lt;span class="n"&gt;jar&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
  &lt;span class="n"&gt;baseName&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'api'&lt;/span&gt;
  &lt;span class="n"&gt;version&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;  &lt;span class="s1"&gt;'1.0'&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;

&lt;span class="n"&gt;repositories&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
  &lt;span class="n"&gt;mavenCentral&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;

&lt;span class="n"&gt;dependencyManagement&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
  &lt;span class="n"&gt;imports&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;mavenBom&lt;/span&gt; &lt;span class="s1"&gt;'org.springframework.cloud:spring-cloud-dependencies:Edgware.RELEASE'&lt;/span&gt;
  &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;

&lt;span class="n"&gt;sourceCompatibility&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;1.8&lt;/span&gt;
&lt;span class="n"&gt;targetCompatibility&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;1.8&lt;/span&gt;

&lt;span class="n"&gt;dependencies&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
  &lt;span class="n"&gt;compile&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'org.springframework.cloud:spring-cloud-starter-eureka'&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
  &lt;span class="n"&gt;compile&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'org.springframework.boot:spring-boot-starter-web'&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Create the View&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; nano src/main/java/api/Greeting.java
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;package&lt;/span&gt; &lt;span class="nn"&gt;api&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;

&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Greeting&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;

    &lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="kt"&gt;long&lt;/span&gt; &lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;

    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="nf"&gt;Greeting&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;long&lt;/span&gt; &lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;id&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;content&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kt"&gt;long&lt;/span&gt; &lt;span class="nf"&gt;getId&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="nf"&gt;getContent&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Create a controller&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; nano src/main/java/api/GreetingController.java
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;package&lt;/span&gt; &lt;span class="nn"&gt;api&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;

&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;java.util.concurrent.atomic.AtomicLong&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;org.springframework.web.bind.annotation.RequestMapping&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;org.springframework.web.bind.annotation.RequestParam&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;org.springframework.web.bind.annotation.RestController&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;

&lt;span class="nd"&gt;@RestController&lt;/span&gt;
&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;GreetingController&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;

    &lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;template&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;"Hello, %s!"&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;AtomicLong&lt;/span&gt; &lt;span class="n"&gt;counter&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;AtomicLong&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;

    &lt;span class="nd"&gt;@RequestMapping&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"/greeting"&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="n"&gt;Greeting&lt;/span&gt; &lt;span class="nf"&gt;greeting&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nd"&gt;@RequestParam&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"name"&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;defaultValue&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"World"&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;Greeting&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;counter&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;incrementAndGet&lt;/span&gt;&lt;span class="o"&gt;(),&lt;/span&gt;
                            &lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;format&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;template&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;));&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Creates a standalone application&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; nano src/main/java/api/Application.java
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;package&lt;/span&gt; &lt;span class="nn"&gt;api&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;

&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;org.springframework.beans.factory.annotation.Autowired&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;org.springframework.boot.SpringApplication&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;org.springframework.boot.autoconfigure.SpringBootApplication&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;org.springframework.cloud.client.ServiceInstance&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;org.springframework.cloud.client.discovery.DiscoveryClient&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;org.springframework.cloud.client.discovery.EnableDiscoveryClient&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;org.springframework.web.bind.annotation.PathVariable&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;org.springframework.web.bind.annotation.RequestMapping&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;org.springframework.web.bind.annotation.RestController&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;

&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;java.util.List&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;

&lt;span class="nd"&gt;@EnableDiscoveryClient&lt;/span&gt;
&lt;span class="nd"&gt;@SpringBootApplication&lt;/span&gt;
&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Application&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;

    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;SpringApplication&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;run&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Application&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;

&lt;span class="nd"&gt;@RestController&lt;/span&gt;
&lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;ServiceInstanceRestController&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;

    &lt;span class="nd"&gt;@Autowired&lt;/span&gt;
    &lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="n"&gt;DiscoveryClient&lt;/span&gt; &lt;span class="n"&gt;discoveryClient&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;

    &lt;span class="nd"&gt;@RequestMapping&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"/service-instances/{applicationName}"&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;ServiceInstance&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="nf"&gt;serviceInstancesByApplicationName&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;
            &lt;span class="nd"&gt;@PathVariable&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;applicationName&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;discoveryClient&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getInstances&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;applicationName&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Configure Application&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; nano src/main/resources/bootstrap.properties
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;spring&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;application&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;GreetingAPI&lt;/span&gt;
&lt;span class="n"&gt;eureka&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;client&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;serviceUrl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;defaultZone&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="c1"&gt;//localhost:8761/eureka/&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Build&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; gradle build
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Run&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; java -jar -Dserver.port&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;9901&lt;/span&gt; build/libs/api-1.0.jar
&lt;span class="gp"&gt;$&lt;/span&gt; java -jar -Dserver.port&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;9902&lt;/span&gt; build/libs/api-1.0.jar
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Test via gateway&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; curl http://localhost:8080/books/greeting
&lt;span class="gp"&gt;$&lt;/span&gt; curl http://localhost:8080/greeting?name&lt;span class="o"&gt;=&lt;/span&gt;User
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;What still needs to be done&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Create a true CRUD REST API&lt;/li&gt;
&lt;li&gt;Data storage in database with DTO to prevent insecure direct object references&lt;/li&gt;
&lt;li&gt;Output encoding (to prevent XSS)&lt;/li&gt;
&lt;/ul&gt;</content><category term="Spring"></category><category term="Spring Boot"></category><category term="Spring Cloud"></category><category term="REST"></category><category term="API"></category></entry><entry><title>Building an API Gateway with Spring Cloud - Part 1 (Eureka)</title><link href="http://didier.bernaudeau.net/Building_an_API_Gateway_with_SpringCloud_Eureka.html" rel="alternate"></link><published>2018-01-31T14:18:00+01:00</published><updated>2018-01-31T14:49:00+01:00</updated><author><name>Didier BERNAUDEAU</name></author><id>tag:didier.bernaudeau.net,2018-01-31:/Building_an_API_Gateway_with_SpringCloud_Eureka.html</id><summary type="html">&lt;p&gt;This post walks you through installing an embedded Eureka server with Spring Cloud. Eureka is a registry and discovery server developed by netflix OSS (Open Source Software).&lt;/p&gt;
</summary><content type="html">&lt;p&gt;This post walks you through installing an embedded Eureka server with Spring Cloud. Eureka is a registry and discovery server developed by netflix OSS (Open Source Software).&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Create the directory structure&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; mkdir -p eureka/src/main/java/eureka
&lt;span class="gp"&gt;$&lt;/span&gt; mkdir -p eureka/src/main/resources
&lt;span class="gp"&gt;$&lt;/span&gt; &lt;span class="nb"&gt;cd&lt;/span&gt; eureka
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Create a Gradle build file&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; nano build.gradle
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;buildscript&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;ext&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;springBootVersion&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'1.5.10.RELEASE'&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;repositories&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;mavenCentral&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;dependencies&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;classpath&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"org.springframework.boot:spring-boot-gradle-plugin:${springBootVersion}"&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;

&lt;span class="n"&gt;apply&lt;/span&gt; &lt;span class="nl"&gt;plugin:&lt;/span&gt; &lt;span class="s1"&gt;'java'&lt;/span&gt;
&lt;span class="n"&gt;apply&lt;/span&gt; &lt;span class="nl"&gt;plugin:&lt;/span&gt; &lt;span class="s1"&gt;'eclipse'&lt;/span&gt;
&lt;span class="n"&gt;apply&lt;/span&gt; &lt;span class="nl"&gt;plugin:&lt;/span&gt; &lt;span class="s1"&gt;'idea'&lt;/span&gt;
&lt;span class="n"&gt;apply&lt;/span&gt; &lt;span class="nl"&gt;plugin:&lt;/span&gt; &lt;span class="s1"&gt;'org.springframework.boot'&lt;/span&gt;

&lt;span class="n"&gt;jar&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;baseName&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'gateway-eureka'&lt;/span&gt;
    &lt;span class="n"&gt;version&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'1.0'&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="n"&gt;sourceCompatibility&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;1.8&lt;/span&gt;
&lt;span class="n"&gt;targetCompatibility&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;1.8&lt;/span&gt;

&lt;span class="n"&gt;repositories&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;mavenCentral&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;


&lt;span class="n"&gt;dependencyManagement&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;imports&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;mavenBom&lt;/span&gt; &lt;span class="s1"&gt;'org.springframework.cloud:spring-cloud-dependencies:Edgware.RELEASE'&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;

&lt;span class="n"&gt;dependencies&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;compile&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'org.springframework.cloud:spring-cloud-starter-eureka-server'&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;testCompile&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'org.springframework.boot:spring-boot-starter-test'&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;


&lt;span class="n"&gt;eclipse&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;classpath&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
         &lt;span class="n"&gt;containers&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;remove&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'org.eclipse.jdt.launching.JRE_CONTAINER'&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
         &lt;span class="n"&gt;containers&lt;/span&gt; &lt;span class="s1"&gt;'org.eclipse.jdt.launching.JRE_CONTAINER/org.eclipse.jdt.internal.debug.ui.launcher.StandardVMType/JavaSE-1.8'&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Create application&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; nano src/main/java/eureka/GatewayEurekaApplication.java
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;package&lt;/span&gt; &lt;span class="nn"&gt;eureka&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;

&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;org.springframework.boot.SpringApplication&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;org.springframework.boot.autoconfigure.SpringBootApplication&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;org.springframework.cloud.netflix.eureka.server.EnableEurekaServer&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;

&lt;span class="nd"&gt;@EnableEurekaServer&lt;/span&gt;
&lt;span class="nd"&gt;@SpringBootApplication&lt;/span&gt;
&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;GatewayEurekaApplication&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;

    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;SpringApplication&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;run&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;GatewayEurekaApplication&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Configure Eureka&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; nano src/main/resources/application.properties
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;server&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;port&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;8761&lt;/span&gt;

&lt;span class="n"&gt;eureka&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;client&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;register&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;with&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;eureka&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;false&lt;/span&gt;
&lt;span class="n"&gt;eureka&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;client&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;fetch&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;registry&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;false&lt;/span&gt;

&lt;span class="n"&gt;logging&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;level&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;com&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;netflix&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;eureka&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;OFF&lt;/span&gt;
&lt;span class="n"&gt;logging&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;level&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;com&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;netflix&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;discovery&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;OFF&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Build&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; gradle build
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Run&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; java -jar build/libs/gateway-eureka-1.0.jar
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Open &lt;a href="http://localhost:8761/"&gt;the dashboard&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><category term="Spring"></category><category term="Spring Cloud"></category><category term="REST"></category><category term="API"></category></entry><entry><title>How to install NodeJS on Gentoo Linux</title><link href="http://didier.bernaudeau.net/HowTo_install_NodeJS.html" rel="alternate"></link><published>2017-12-30T17:13:00+01:00</published><updated>2018-03-25T16:32:00+02:00</updated><author><name>Didier BERNAUDEAU</name></author><id>tag:didier.bernaudeau.net,2017-12-30:/HowTo_install_NodeJS.html</id><summary type="html">&lt;p&gt;Node.js is a powerful JavaScript run-time environment for executing JavaScript code server-side. This post will walk-through installing Node.js with essential additional software on Gentoo Linux.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;Node.js is a powerful JavaScript run-time environment for executing JavaScript code server-side. This post will walk-through installing Node.js with essential additional software on Gentoo Linux.&lt;/p&gt;

&lt;h1&gt;NodeJS&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Install NodeJS 9.8&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; nano /etc/portage/package.accept_keywords
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;=net-libs/nodejs-9.8.0       ~amd64
=net-libs/http-parser-2.7.1  ~amd64
=net-libs/nghttp2-1.29.0     ~amd64
=dev-libs/libuv-1.19.2       ~amd64
=dev-libs/icu-60.2           ~amd64
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; &lt;span class="nv"&gt;emerge&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;net-libs/nodejs-9.8.0
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;NPM&lt;/h1&gt;
&lt;p&gt;NPM (stands for Node Package Manager) is a command line interface program to manage node.js libraries. This tools is provided by default with NodeJs.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Install NPM&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; npm install -g npm
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Install a package&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; npm install -g PackageName
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;/!\ Packages are installed in the following directory: "/usr/lib64/node_modules/".&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Uninstall a package&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; npm uninstall -g PackageName
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Get information about a package&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; npm list PackageName
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Update NPM packages&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; npm update -g --unsafe-perm
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Clear NPM cache&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; npm cache verify
&lt;span class="gp"&gt;#&lt;/span&gt; npm cache clear --force
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Create a project&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; npm init
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Yarn&lt;/h1&gt;
&lt;p&gt;Yarn is an another package manager from Facebook. Yarn is an alternative to NPM.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Install Yarn (1.2.1)&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; nano /etc/portage/package.accept_keywords
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;=sys-apps/yarn-1.2.1    ~amd64
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; emerge sys-apps/yarn
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Install package for all users&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; yarn global add PackageName
&lt;/pre&gt;&lt;/div&gt;</content><category term="NodeJs"></category><category term="Gentoo"></category></entry><entry><title>Video Streaming with HLSjs</title><link href="http://didier.bernaudeau.net/Video_Streaming_with_HLSjs.html" rel="alternate"></link><published>2017-12-23T10:36:00+01:00</published><updated>2017-12-23T13:06:00+01:00</updated><author><name>Didier BERNAUDEAU</name></author><id>tag:didier.bernaudeau.net,2017-12-23:/Video_Streaming_with_HLSjs.html</id><summary type="html">&lt;p&gt;This tutorial describes a way to stream video from my surveillance camera. The backend is a Nginx (as RTMP proxy server) with FFmpeg for video transcoding. The frontend is based on HLSjs framework. Finally, HLS protocol (Also known as HTTP Live Streaming) is used for the communication between back and front.
This solution doesn't work on Android device. So, I did not take that option and this article is not really finish.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;This tutorial describes a way to stream video from my surveillance camera. The backend is a Nginx (as RTMP proxy server) with FFmpeg for video transcoding. The frontend is based on HLSjs framework. Finally, HLS protocol (Also known as HTTP Live Streaming) is used for the communication between back and front.
This solution doesn't work on Android device. So, I did not take that option and this article is not really finish.&lt;/p&gt;

&lt;p align="center"&gt;&lt;img class="img-responsive" src="images/2017-12-23_Video_Streaming_with_HLSjs.png" width="80%"/&gt;&lt;/p&gt;
&lt;h1&gt;Backend&lt;/h1&gt;
&lt;h2&gt;RTMP Server&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Install Nginx&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; nano /etc/portage/package.use
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;www-servers/nginx    rtmp
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Install nginx&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; emerge nginx
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Configure nginx&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;rtmp {
    server {
        listen 1935; # Listen on standard RTMP port
        chunk_size 4000;

        application show {
            live on;
            # Turn on HLS
            hls on;
            hls_path /mnt/hls/;
            hls_fragment 3;
            hls_playlist_length 60;
            # disable consuming the stream from nginx as rtmp
            #deny play all;
        }
    }
}

http {
      ...
      sendfile off;
      tcp_nopush on;
      tcp_nodelay on;
      directio 512;

      server {
        listen 8081;
        root /var/www/app/;
      }

      server {
        listen 8080;
        server_name hostname;

        location / {
          # Disable cache
          add_header 'Cache-Control' 'no-cache';

          # CORS setup
          add_header 'Access-Control-Allow-Origin' '*' always;
          add_header 'Access-Control-Expose-Headers' 'Content-Length';

          # allow CORS preflight requests (Don't use this configure in production environment)
          if ($request_method = 'OPTIONS') {
            add_header 'Access-Control-Allow-Origin' '*';
            add_header 'Access-Control-Max-Age' 1728000;
            add_header 'Content-Type' 'text/plain charset=UTF-8';
            add_header 'Content-Length' 0;
            return 204;
          }

          types {
            application/dash+xml mpd;
            application/vnd.apple.mpegurl m3u8;
            video/mp2t ts;
          }

          root /mnt/;
        }
      }
}
&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;Video transcoding&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Install ffmpeg&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; emerge ffmpeg
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Transcode video&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; ffmpeg -i rtsp://username:password@10.X.Y.Z:554/VideoInput/chan1/h264/1 -vcodec libx264 -vprofile baseline -acodec aac -strict -2 -f flv rtmp://localhost/show/stream
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Frontend&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Create webpage&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; mkdir /var/www/app
&lt;span class="gp"&gt;#&lt;/span&gt; nano /var/www/app/hls.html
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;html&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;

&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;head&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
  &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;script&lt;/span&gt; &lt;span class="na"&gt;src&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"https://cdn.jsdelivr.net/npm/hls.js@latest"&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;script&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;head&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;

&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;body&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;

&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;h1&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Test streaming&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;h1&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;

&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;video&lt;/span&gt; &lt;span class="na"&gt;id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"video"&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;video&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;script&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
  &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;Hls&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;isSupported&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;video&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;document&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;getElementById&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'video'&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;hls&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="nx"&gt;Hls&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="nx"&gt;hls&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;loadSource&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'http://hostname.domain.net:8080/hls/stream.m3u8'&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="nx"&gt;hls&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;attachMedia&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;video&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="nx"&gt;hls&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;on&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;Hls&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;Events&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;MANIFEST_PARSED&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
      &lt;span class="nx"&gt;video&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;play&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
  &lt;span class="p"&gt;});&lt;/span&gt;
 &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;script&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;

&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;body&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;html&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Open your browser on http://hostname.domain.net:8081/app/hls.html&lt;/li&gt;
&lt;/ul&gt;</content><category term="Nginx"></category><category term="Gentoo"></category></entry><entry><title>How to install DLNA server</title><link href="http://didier.bernaudeau.net/HowTo_install_DLNA_Server.html" rel="alternate"></link><published>2017-12-01T18:24:00+01:00</published><updated>2018-03-04T20:36:00+01:00</updated><author><name>Didier BERNAUDEAU</name></author><id>tag:didier.bernaudeau.net,2017-12-01:/HowTo_install_DLNA_Server.html</id><summary type="html">&lt;p&gt;This post describes how to install a MiniDLNA server on my &lt;a href="http://didier.bernaudeau.net/Home_Server.html"&gt;home server&lt;/a&gt;.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;This post describes how to install a MiniDLNA server on my &lt;a href="http://didier.bernaudeau.net/Home_Server.html"&gt;home server&lt;/a&gt;.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Install MiniDLNA&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo apt-get install -y minidlna
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Configure MiniDLNA&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /etc/minidlna.conf
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;media_dir=A,/data/multimedia/music
network_interface=enp3s0
friendly_name=Cube Server

port=8200

friendly_name=MusiCube

inotify=yes
notify_interval=60 
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Force rescan&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /etc/default/minidlna 
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;DAEMON_OPTS="-R"
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Start MiniDLNA&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl start minidlna
&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl &lt;span class="nb"&gt;enable&lt;/span&gt; minidlna
&lt;/pre&gt;&lt;/div&gt;</content><category term="Home Server"></category></entry><entry><title>How to install NFS</title><link href="http://didier.bernaudeau.net/HowTo_install_NFS.html" rel="alternate"></link><published>2017-11-30T09:37:00+01:00</published><updated>2018-03-04T20:34:00+01:00</updated><author><name>Didier BERNAUDEAU</name></author><id>tag:didier.bernaudeau.net,2017-11-30:/HowTo_install_NFS.html</id><summary type="html">&lt;p&gt;NFS (Network file System) allows remote hosts to mount file systems over a network and interact with those file systems as though they are mounted locally. This post describes how to install NFS on Debian 9 (Stretch) on my &lt;a href="http://didier.bernaudeau.net/Home_Server.html"&gt;home server&lt;/a&gt;.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;NFS (Network file System) allows remote hosts to mount file systems over a network and interact with those file systems as though they are mounted locally. This post describes how to install NFS on Debian 9 (Stretch) on my &lt;a href="http://didier.bernaudeau.net/Home_Server.html"&gt;home server&lt;/a&gt;.&lt;/p&gt;

&lt;h1&gt;NFS server&lt;/h1&gt;
&lt;h2&gt;Private directory&lt;/h2&gt;
&lt;p&gt;In this case, a user (Bob) will be allowed to access remotely to his own directory (/data/perso/bob).&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Create user and group&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo adduser --no-create-home --disabled-password --disabled-login bob
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Create directory&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo mkdir /data/perso
&lt;span class="gp"&gt;$&lt;/span&gt; sudo mkdir /data/perso/bob
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Set Posix rights&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo chown bob:bob /data/perso/bob
&lt;span class="gp"&gt;$&lt;/span&gt; sudo chmod &lt;span class="m"&gt;700&lt;/span&gt; /data/perso/bob/
&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;Shared directory&lt;/h2&gt;
&lt;p&gt;In this case, a group of person will be allowed to access remotely to a shared directory (/data/common).&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Create groupe&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo groupadd -g &lt;span class="m"&gt;2000&lt;/span&gt; common
&lt;span class="gp"&gt;$&lt;/span&gt; sudo usermod -a -G common bob
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Create directory&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo mkdir /data/common
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Set Posix rights&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo chown root:common /data/common
&lt;span class="gp"&gt;$&lt;/span&gt; sudo chmod g+w /data/common/
&lt;span class="gp"&gt;$&lt;/span&gt; sudo chmod -R o-rx /data/common
&lt;span class="gp"&gt;$&lt;/span&gt; sudo find /data/common -type d -exec chmod g+s &lt;span class="o"&gt;{}&lt;/span&gt; &lt;span class="se"&gt;\;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;The last command line set the "setGID" on each directory. Thus, all files and folders created under /data/common will have the same owning group “common” and will have SetGID set.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;Scheduling a task to set access right&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo crontab -e
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;0 3 * * * chmod -R g+w /data/common/ &amp;amp;&amp;amp; chmod -R o-rx /data/common &amp;amp;&amp;amp; chown -R root:common /data/common
&lt;/pre&gt;&lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;I have already tried with the following solutions without success :&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Setting the default umask to "067"&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Using SetACL command line to define access rights. But, this works only locally with POSIX and it's not take into consideration by NFS.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Using NFS4-ACL command line to define access rights. But, this doesn't work POSIX which will be an inconvenient if the users use an another protocol such as SSH.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;So, the workaround is to set access right every night.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;NFS software&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Install NFS&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo apt-get install -y nfs-kernel-server
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Check the status&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl status nfs-kernel-server
&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl &lt;span class="nb"&gt;enable&lt;/span&gt; nfs-kernel-server
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Exporting directory&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /etc/exports
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;/data/perso             10.XXX.3.0/24(rw,sync,subtree_check)
/data/common            10.XXX.3.0/24(rw,sync,subtree_check)
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Shared directory&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo exportfs -a
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Client&lt;/h1&gt;
&lt;h2&gt;Mount by hand&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; mount -t nfs cube.domain.net:/data/common /mnt/nfs/
&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;Mount automatically (with AutoFS)&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Creating mount point&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; mkdir /mnt/cube.domain.net
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Configure AutoFS&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; nano /etc/autofs/auto.master
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;/mnt/nfs /etc/autofs/auto.nfs --ghost --timeout 30
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; nano /etc/autofs/auto.nfs
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;perso       -fstype=nfs4,rw,async,actimeo=120,subtree_check,intr,rsize=32768,wsize=32768     cube.domain.net:/data/perso
common      -fstype=nfs4,rw,async,actimeo=120,subtree_check,intr,rsize=32768,wsize=32768     cube.domain.net:/data/common
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Start AutoFS&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; systemctl start autofs
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;NFS Tuning&lt;/h1&gt;
&lt;h2&gt;Hard vs Soft&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Hard: If you have mounted the NFS filesystem using hard mount, it will repeatedly retry to contact the server. Once the server is back online, the program will continue to execute undisturbed from the state where it was during server crash. We can use the mount option “intr” which allows NFS requests to be interrupted if the server goes down or cannot be reached. Hence the recommended settings are hard and intr options.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Soft: When a program or application requests a file from the NFS filesystem, NFS client daemons will try to retrieve the data from the NFS server. But, if it doesn’t get any response from the NFS server (due to any crash or failure of NFS server), the NFS client will report an error to the process on the client machine requesting the file access. The advantage of this mechanism is “fast responsiveness” as it doesn’t wait for the NFS server to respond. But the main disadvantage of this method is data corruption or loss of data. So this is not a recommended option to use.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Sync vs async&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Sync: this option means that the server only confirms write operations after they are actually written to the disk.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Async: this option means that the server immediately acknowledges the write-operation to the client when it is processed but not yet written to the disk. This is a little bit more unreliable (for instance: in case of a power failure).&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Intr vs Nointr&lt;/h2&gt;
&lt;p&gt;Selects whether to allow signals to interrupt file operations on this mount point. If neither option is specified (or if nointr is specified), signals do not interrupt NFS file operations. If intr is specified, system calls return EINTR if an in-progress NFS operation is interrupted by a signal.&lt;/p&gt;
&lt;h2&gt;Subtree Checking&lt;/h2&gt;
&lt;p&gt;This option enforces additional checks on the server to verify that the requested file is contained within the exported hierarchy.&lt;/p&gt;</content><category term="Home Server"></category><category term="Debian Stretch"></category></entry><entry><title>How to install Cups</title><link href="http://didier.bernaudeau.net/HowTo_install_Cups.html" rel="alternate"></link><published>2017-11-25T12:46:00+01:00</published><updated>2017-12-22T21:26:00+01:00</updated><author><name>Didier BERNAUDEAU</name></author><id>tag:didier.bernaudeau.net,2017-11-25:/HowTo_install_Cups.html</id><summary type="html">&lt;p&gt;This post describes how to create a printing server with CUPS on Debian Stretch then how to install a printer (Brother MFC295CN) which requires a 32bits driver from manufacturer.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;This post describes how to create a printing server with CUPS on Debian Stretch then how to install a printer (Brother MFC295CN) which requires a 32bits driver from manufacturer.&lt;/p&gt;

&lt;h1&gt;Network Configuration&lt;/h1&gt;
&lt;p&gt;Set A record in your local DNS for "cups.domain.net" and "brother.domain.net"&lt;/p&gt;
&lt;h1&gt;32 bits Support&lt;/h1&gt;
&lt;p&gt;Debian removed ia32-libs from the repository. So to run 32bit code on 64bit system, you need to enable multiarch support&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Add i386 architecture&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo dpkg --add-architecture i386
&lt;span class="gp"&gt;$&lt;/span&gt; sudo dpkg --print-foreign-architectures
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Update package repository&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo apt-get update
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Install 32bits package&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo apt-get install libstdc++6:i386 libgcc1:i386 zlib1g:i386 libncurses5:i386
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Firewall&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Incoming flow&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; Cups
&lt;span class="go"&gt;sudo iptables -A INPUT -i $LanInterface -d $LanAddress -p tcp --dport 631 -m conntrack --ctstate NEW,RELATED,ESTABLISHED -j ACCEPT&lt;/span&gt;

&lt;span class="gp"&gt;#&lt;/span&gt; Allow outgoing established connection
&lt;span class="go"&gt;sudo iptables -A OUTPUT -o $LanInterface -s $LanAddress -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Outgoing flow&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; LPD &lt;span class="o"&gt;(&lt;/span&gt;Print protocol to Brother&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="go"&gt;sudo iptables -A OUTPUT -o $LanInterface -s $LanAddress -d $PrintBrother -p tcp --dport 515 -m conntrack --ctstate NEW,RELATED,ESTABLISHED -j ACC$&lt;/span&gt;

&lt;span class="gp"&gt;#&lt;/span&gt; Allow incoming established connection
&lt;span class="go"&gt;sudo iptables -A INPUT -i $LanInterface -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Local flow&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; CUPS
&lt;span class="gp"&gt;$&lt;/span&gt; sudo iptables -A OUTPUT -o lo -s &lt;span class="m"&gt;127&lt;/span&gt;.0.0.1 -d &lt;span class="m"&gt;127&lt;/span&gt;.0.0.1 -p tcp --dport &lt;span class="m"&gt;631&lt;/span&gt; -m conntrack --ctstate NEW,RELATED,ESTABLISHED -j ACCEPT
&lt;span class="gp"&gt;$&lt;/span&gt; sudo iptables -A INPUT -i lo -s &lt;span class="m"&gt;127&lt;/span&gt;.0.0.1 -d &lt;span class="m"&gt;127&lt;/span&gt;.0.0.1 -p tcp --dport &lt;span class="m"&gt;631&lt;/span&gt; -m conntrack --ctstate NEW,RELATED,ESTABLISHED -j ACCEPT
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Cups&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Install CUPS&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo apt-get install cups
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Configure CUPS&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /etc/cups/cupsd.conf
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Listen 10.XXX.3.254:631
Listen /var/run/cups/cups.sock

ServerAlias cups.domain.net

&lt;span class="nt"&gt;&amp;lt;Location&lt;/span&gt; &lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
  Order allow,deny
  allow 10.XXX.3.0/24
&lt;span class="nt"&gt;&amp;lt;/Location&amp;gt;&lt;/span&gt;

&lt;span class="nt"&gt;&amp;lt;Location&lt;/span&gt; &lt;span class="err"&gt;/admin&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
  Order allow,deny
  allow 10.XXX.3.0/24
&lt;span class="nt"&gt;&amp;lt;/Location&amp;gt;&lt;/span&gt;

&lt;span class="nt"&gt;&amp;lt;Location&lt;/span&gt; &lt;span class="err"&gt;/admin/conf&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
  Order allow,deny
  allow 10.XXX.3.0/24
&lt;span class="nt"&gt;&amp;lt;Location&lt;/span&gt; &lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Restart CUPS&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl restart cups
&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl &lt;span class="nb"&gt;enable&lt;/span&gt; cups
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Open your browser on http://cups.domain.net:631&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;Brother MFC295CN&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Set static IP Address (DHCP is not supported): 10.XXX.93.100/24 &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Download the last driver LPR on http://support.brother.com/g/b/producttop.aspx&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; curl -LO http://download.brother.com/welcome/dlf006084/mfc295cnlpr-1.1.3-1.i386.deb
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Create spool directory&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo mkdir /var/spool/lpd/
&lt;span class="gp"&gt;$&lt;/span&gt; sudo mkdir /var/spool/lpd/mfc295cn
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Instal LPR driver&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo dpkg -i --force-all mfc295cnlpr-1.1.3-1.i386.deb
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Configurer le pilote LPR&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /etc/printcap
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;MFC295CN:\
      :mx=0:\
      :sd=/var/spool/lpd/mfc295cn:\
      :sh:\
      :lp=brother.lazuly.net\
      :if=/opt/brother/Printers/mfc295cn/lpd/filtermfc295cn
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Download Cups Wrapper&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; curl -LO http://download.brother.com/welcome/dlf006086/mfc295cncupswrapper-1.1.3-1.i386.deb
&lt;span class="go"&gt;```console&lt;/span&gt;

&lt;span class="go"&gt;* Install cups wrapper&lt;/span&gt;

&lt;span class="go"&gt;```console&lt;/span&gt;
&lt;span class="gp"&gt;$&lt;/span&gt; sudo dpkg -i --force-all mfc295cncupswrapper-1.1.3-1.i386.deb
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Add printer via the admin interface (https://cups.domain.net:631/admin/ with root user)&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;"Administration &amp;gt; Printer &amp;gt; Add printer"
"Other Network Printers: Hôte ou imprimante LPD/LPR" then "continue"
"Connection = lpd://brother.domain.net/BINARY_P1" then "continue"
"Printer name = Brother" and check "Share This Printer" then "continue"
"Model" : Brother MFC-295CN CUPS (en)" then "add printer"
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Cups client&lt;/h1&gt;
&lt;h2&gt;Linux&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; nano /etc/cups/client.conf
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;ServerName cups.lazuly.net
&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;Android&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Install Cups Print via Play store and configuration it as below :&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Réglage &amp;gt; impression : activer le service "Impression Android CUPS"
Ajouter une imprimante : http://cups.domain.net:631/printers/Brother et donner lui un nom
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Troubleshooting&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Erreur "L'application spooleur d'impression s'est malheureusement arrêtée" est affichée mais l'impression suit son cours (et le document est présent dans la liste des échecs d'impression)&lt;/p&gt;</content><category term="Network"></category><category term="Debian Stretch"></category><category term="APU"></category></entry><entry><title>System monitoring with Grafana</title><link href="http://didier.bernaudeau.net/System_monitoring_with_Grafana.html" rel="alternate"></link><published>2017-10-16T21:19:00+02:00</published><updated>2018-02-19T10:28:00+01:00</updated><author><name>Didier BERNAUDEAU</name></author><id>tag:didier.bernaudeau.net,2017-10-16:/System_monitoring_with_Grafana.html</id><summary type="html">&lt;p&gt;Grafana is an alternative to Chronograf in a TICK stack (Telegraf, InfluxDB, Chronograf, Kapacitor) and allows to create more beautiful dashboard than Chronograf. So, we could call that "TIGK" (Telegraf, InfluxDB, Grafana, Kapacitor). This post walks you through installing Grafana on Debian Stretch on which Telegraf and InfluxDB are already installed.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;Grafana is an alternative to Chronograf in a TICK stack (Telegraf, InfluxDB, Chronograf, Kapacitor) and allows to create more beautiful dashboard than Chronograf. So, we could call that "TIGK" (Telegraf, InfluxDB, Grafana, Kapacitor). This post walks you through installing Grafana on Debian Stretch on which Telegraf and InfluxDB are already installed.&lt;/p&gt;

&lt;h1&gt;Add additional repository&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;add Grafana secret key (from Package Cloud)&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; curl -sL https://packagecloud.io/gpg.key &lt;span class="p"&gt;|&lt;/span&gt; sudo apt-key add -
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Add Grafana repository&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;"deb https://packagecloud.io/grafana/stable/debian/ stretch main"&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; sudo tee /etc/apt/sources.list.d/grafana.list
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Grafana&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Install Grafana&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo apt-get install grafana
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Configure firewall&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo iptables -A INPUT -i &lt;span class="nv"&gt;$LanInterface&lt;/span&gt; -d &lt;span class="nv"&gt;$LanAddress&lt;/span&gt; -p tcp --dport &lt;span class="m"&gt;3000&lt;/span&gt; -m conntrack --ctstate NEW,RELATED,ESTABLISHED -j ACCEPT
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Start Grafana&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl start grafana-server
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Open Grafana in your browser http://g8way.domain.net:3000&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Default user: admin&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Default password: admin&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;Configure Grafana&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Add a data source (Type: influxdb)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Import existing dashboards from https://grafana.com/dashboards/&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;</content><category term="APU"></category><category term="Debian Stretch"></category></entry><entry><title>System monitoring with InfluxData’s TICK stack</title><link href="http://didier.bernaudeau.net/System_monitoring_with_TICK_stack.html" rel="alternate"></link><published>2017-10-15T21:19:00+02:00</published><updated>2018-02-19T10:28:00+01:00</updated><author><name>Didier BERNAUDEAU</name></author><id>tag:didier.bernaudeau.net,2017-10-15:/System_monitoring_with_TICK_stack.html</id><summary type="html">&lt;p&gt;The InfluxData TICK (Telegraf, InfluxDB, Chronograf, Kapacitor) stack is a modern solution for system monitoring. In this post, I describe a way to monitor my homemade router / firewall and other systems. The main drawback of InfluxDB is the high memory consumption.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;The InfluxData TICK (Telegraf, InfluxDB, Chronograf, Kapacitor) stack is a modern solution for system monitoring. In this post, I describe a way to monitor my homemade router / firewall and other systems. The main drawback of InfluxDB is the high memory consumption.&lt;/p&gt;

&lt;h1&gt;Add additional repository&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Add InfluxData secret key&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; curl -sL https://repos.influxdata.com/influxdb.key &lt;span class="p"&gt;|&lt;/span&gt; sudo apt-key add -
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Add InfluxData repository&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;"deb https://repos.influxdata.com/debian stretch stable"&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; sudo tee /etc/apt/sources.list.d/influxdb.list
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Update repository&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo apt-get update
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Influxdb&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Install InfluxDB&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo apt-get install influxdb
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Configure firewall&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; Influxdb
&lt;span class="go"&gt;sudo iptables -A INPUT -i lo -d 127.0.0.1 -p tcp --dport 8086 -m conntrack --ctstate NEW,RELATED,ESTABLISHED -j ACCEPT&lt;/span&gt;
&lt;span class="go"&gt;sudo iptables -A OUTPUT -o lo -d 127.0.0.1 -p tcp --dport 8086 -m conntrack --ctstate NEW,RELATED,ESTABLISHED -j ACCEPT&lt;/span&gt;

&lt;span class="gp"&gt;#&lt;/span&gt; Allow outgoing and incoming established connection
&lt;span class="go"&gt;sudo iptables -A OUTPUT -o lo -s 127.0.0.1 -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT&lt;/span&gt;
&lt;span class="go"&gt;sudo iptables -A INPUT -i lo -s 127.0.0.1 -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Start InfluxDB&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl start influxdb
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Install required monitoring tools&lt;/h1&gt;
&lt;h2&gt;Disk monitoring&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Install SMART disk tool&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo apt-get install smartmontools
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Enabled SMART&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo smartctl -s on /dev/sda
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;test&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="go"&gt;sudo smartctl --info --attributes --health -n standby --format=brief /dev/sda&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Telegraf&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Install Telegraf&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo apt-get install telegraf
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Edit configuration&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /etc/telegraf/telegraf.conf
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;[[inputs.conntrack]]&lt;/span&gt;
  &lt;span class="na"&gt;files&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;["ip_conntrack_count","ip_conntrack_max","nf_conntrack_count","nf_conntrack_max"]&lt;/span&gt;
&lt;span class="s"&gt;  dirs = ["/proc/sys/net/ipv4/netfilter","/proc/sys/net/netfilter"]&lt;/span&gt;

&lt;span class="k"&gt;[[inputs.netstat]]&lt;/span&gt;

&lt;span class="k"&gt;[[inputs.net]]&lt;/span&gt;
  &lt;span class="na"&gt;interfaces&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;["enp1s0 enp2s0 enp3s0"]&lt;/span&gt;

&lt;span class="k"&gt;[[inputs.iptables]]&lt;/span&gt;
  &lt;span class="na"&gt;use_sudo&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;false&lt;/span&gt;
&lt;span class="s"&gt;  use_lock = false&lt;/span&gt;
&lt;span class="s"&gt;  table = "filter"&lt;/span&gt;
&lt;span class="s"&gt;  chains = [ "INPUT" ]&lt;/span&gt;


&lt;span class="c1"&gt;# Processor Temperture&lt;/span&gt;
&lt;span class="k"&gt;[[inputs.sensors]]&lt;/span&gt;

&lt;span class="c1"&gt;# SMART Disk (Doesn't work because SMART features require Telegraf 1.5)&lt;/span&gt;
&lt;span class="k"&gt;[[inputs.smart]]&lt;/span&gt;
  &lt;span class="na"&gt;use_sudo&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;true&lt;/span&gt;
&lt;span class="s"&gt;  nocheck = "standby"&lt;/span&gt;
&lt;span class="s"&gt;  devices = [ "/dev/sda" ]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Edit service capabilities&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl edit telegraf.service
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;[Service]&lt;/span&gt;
&lt;span class="na"&gt;CapabilityBoundingSet&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;CAP_NET_RAW CAP_NET_ADMIN&lt;/span&gt;
&lt;span class="na"&gt;AmbientCapabilities&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;CAP_NET_RAW CAP_NET_ADMIN&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;start Telegraf&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl start telegraf
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Chronograf&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Install Chronograf&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo apt-get install chronograf
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;start Chronograf&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl start chronograf
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Open Chronograf http://g8way.domain.net:8888&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Enter information for telegraf source&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;Create the dashboard for my router/firewall&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;CPU Load&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;SELECT&lt;/span&gt; &lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="ss"&gt;"usage_idle"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt; &lt;span class="k"&gt;AS&lt;/span&gt; &lt;span class="ss"&gt;"mean_usage_idle"&lt;/span&gt; &lt;span class="k"&gt;FROM&lt;/span&gt; &lt;span class="ss"&gt;"telegraf"&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="ss"&gt;"autogen"&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="ss"&gt;"cpu"&lt;/span&gt; &lt;span class="k"&gt;WHERE&lt;/span&gt; &lt;span class="n"&gt;time&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;dashboardTime&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="k"&gt;AND&lt;/span&gt; &lt;span class="ss"&gt;"host"&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'g8way'&lt;/span&gt; &lt;span class="k"&gt;GROUP&lt;/span&gt; &lt;span class="k"&gt;BY&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nb"&gt;interval&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;FILL&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;null&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;CPU Temp&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;SELECT&lt;/span&gt; &lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="ss"&gt;"temp_input"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;AS&lt;/span&gt; &lt;span class="ss"&gt;"mean_temp_input"&lt;/span&gt; &lt;span class="k"&gt;FROM&lt;/span&gt; &lt;span class="ss"&gt;"telegraf"&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="ss"&gt;"autogen"&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="ss"&gt;"sensors"&lt;/span&gt; &lt;span class="k"&gt;WHERE&lt;/span&gt; &lt;span class="n"&gt;time&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;dashboardTime&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="k"&gt;GROUP&lt;/span&gt; &lt;span class="k"&gt;BY&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nb"&gt;interval&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;FILL&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;null&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;CPU Power&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;SELECT&lt;/span&gt; &lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="ss"&gt;"power_average"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;AS&lt;/span&gt; &lt;span class="ss"&gt;"mean_power_average"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="ss"&gt;"power_average_interval"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;AS&lt;/span&gt; &lt;span class="ss"&gt;"mean_power_average_interval"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="ss"&gt;"power_crit"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;AS&lt;/span&gt; &lt;span class="ss"&gt;"mean_power_crit"&lt;/span&gt; &lt;span class="k"&gt;FROM&lt;/span&gt; &lt;span class="ss"&gt;"telegraf"&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="ss"&gt;"autogen"&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="ss"&gt;"sensors"&lt;/span&gt; &lt;span class="k"&gt;WHERE&lt;/span&gt; &lt;span class="n"&gt;time&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;dashboardTime&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="k"&gt;GROUP&lt;/span&gt; &lt;span class="k"&gt;BY&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nb"&gt;interval&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;FILL&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;null&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Uptime (Days)&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;SELECT&lt;/span&gt; &lt;span class="k"&gt;last&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="ss"&gt;"uptime"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;86400&lt;/span&gt; &lt;span class="k"&gt;AS&lt;/span&gt; &lt;span class="ss"&gt;"last_uptime"&lt;/span&gt; &lt;span class="k"&gt;FROM&lt;/span&gt; &lt;span class="ss"&gt;"telegraf"&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="ss"&gt;"autogen"&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="ss"&gt;"system"&lt;/span&gt; &lt;span class="k"&gt;WHERE&lt;/span&gt; &lt;span class="n"&gt;time&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;dashboardTime&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="k"&gt;GROUP&lt;/span&gt; &lt;span class="k"&gt;BY&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nb"&gt;interval&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;FILL&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;none&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Memory Usage&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;SELECT&lt;/span&gt; &lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="ss"&gt;"used"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;AS&lt;/span&gt; &lt;span class="ss"&gt;"mean_used"&lt;/span&gt; &lt;span class="k"&gt;FROM&lt;/span&gt; &lt;span class="ss"&gt;"telegraf"&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="ss"&gt;"autogen"&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="ss"&gt;"mem"&lt;/span&gt; &lt;span class="k"&gt;WHERE&lt;/span&gt; &lt;span class="n"&gt;time&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;dashboardTime&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="k"&gt;AND&lt;/span&gt; &lt;span class="ss"&gt;"host"&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'g8way'&lt;/span&gt; &lt;span class="k"&gt;GROUP&lt;/span&gt; &lt;span class="k"&gt;BY&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nb"&gt;interval&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;FILL&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;null&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p align="center"&gt;&lt;img class="img-responsive" src="images/2017-10-15_System_monitoring_01.png" width="60%"/&gt;&lt;/p&gt;</content><category term="APU"></category><category term="Debian Stretch"></category></entry><entry><title>Edge Router on Dedibox</title><link href="http://didier.bernaudeau.net/Edge_Router_on_dedibox.html" rel="alternate"></link><published>2017-09-03T22:46:00+02:00</published><updated>2018-01-16T00:11:00+01:00</updated><author><name>Didier BERNAUDEAU</name></author><id>tag:didier.bernaudeau.net,2017-09-03:/Edge_Router_on_dedibox.html</id><summary type="html">&lt;p&gt;An edge router ensures the connectivity of its network with external networks. In my case, this router is a Dedibox hosted by Online at Amsterdam and ensures the connectivity between my LAN and Internet through a VPN network. This post describes the first step to configure ArchLinux.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;An edge router ensures the connectivity of its network with external networks. In my case, this router is a Dedibox hosted by Online at Amsterdam and ensures the connectivity between my LAN and Internet through a VPN network. This post describes the first step to configure ArchLinux.&lt;/p&gt;

&lt;h1&gt;Hardware&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Processor&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; cat /proc/cpuinfo 
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;vendor_id&lt;/span&gt;       &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;GenuineIntel&lt;/span&gt;
&lt;span class="n"&gt;cpu&lt;/span&gt; &lt;span class="n"&gt;family&lt;/span&gt;      &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;
&lt;span class="n"&gt;model&lt;/span&gt;           &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;77&lt;/span&gt;
&lt;span class="n"&gt;model&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;      &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Intel&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;R&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="n"&gt;Atom&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;TM&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="n"&gt;CPU&lt;/span&gt;  &lt;span class="n"&gt;C2350&lt;/span&gt;  &lt;span class="err"&gt;@&lt;/span&gt; &lt;span class="mf"&gt;1.74&lt;/span&gt;&lt;span class="n"&gt;GHz&lt;/span&gt;
&lt;span class="n"&gt;stepping&lt;/span&gt;        &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;
&lt;span class="n"&gt;microcode&lt;/span&gt;       &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mh"&gt;0x127&lt;/span&gt;
&lt;span class="n"&gt;cpu&lt;/span&gt; &lt;span class="n"&gt;MHz&lt;/span&gt;         &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mf"&gt;1745.553&lt;/span&gt;
&lt;span class="n"&gt;cache&lt;/span&gt; &lt;span class="n"&gt;size&lt;/span&gt;      &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;1024&lt;/span&gt; &lt;span class="n"&gt;KB&lt;/span&gt;
&lt;span class="n"&gt;physical&lt;/span&gt; &lt;span class="n"&gt;id&lt;/span&gt;     &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
&lt;span class="n"&gt;siblings&lt;/span&gt;        &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;
&lt;span class="n"&gt;core&lt;/span&gt; &lt;span class="n"&gt;id&lt;/span&gt;         &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
&lt;span class="n"&gt;cpu&lt;/span&gt; &lt;span class="n"&gt;cores&lt;/span&gt;       &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;
&lt;span class="n"&gt;apicid&lt;/span&gt;          &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
&lt;span class="n"&gt;initial&lt;/span&gt; &lt;span class="n"&gt;apicid&lt;/span&gt;  &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
&lt;span class="n"&gt;fpu&lt;/span&gt;             &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;yes&lt;/span&gt;
&lt;span class="n"&gt;fpu_exception&lt;/span&gt;   &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;yes&lt;/span&gt;
&lt;span class="n"&gt;cpuid&lt;/span&gt; &lt;span class="n"&gt;level&lt;/span&gt;     &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;11&lt;/span&gt;
&lt;span class="n"&gt;wp&lt;/span&gt;              &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;yes&lt;/span&gt;
&lt;span class="n"&gt;flags&lt;/span&gt;           &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;fpu&lt;/span&gt; &lt;span class="n"&gt;vme&lt;/span&gt; &lt;span class="n"&gt;de&lt;/span&gt; &lt;span class="n"&gt;pse&lt;/span&gt; &lt;span class="n"&gt;tsc&lt;/span&gt; &lt;span class="n"&gt;msr&lt;/span&gt; &lt;span class="n"&gt;pae&lt;/span&gt; &lt;span class="n"&gt;mce&lt;/span&gt; &lt;span class="n"&gt;cx8&lt;/span&gt; &lt;span class="n"&gt;apic&lt;/span&gt; &lt;span class="n"&gt;sep&lt;/span&gt; &lt;span class="n"&gt;mtrr&lt;/span&gt; &lt;span class="n"&gt;pge&lt;/span&gt; &lt;span class="n"&gt;mca&lt;/span&gt; &lt;span class="n"&gt;cmov&lt;/span&gt; &lt;span class="n"&gt;pat&lt;/span&gt; &lt;span class="n"&gt;pse36&lt;/span&gt; &lt;span class="n"&gt;clflush&lt;/span&gt; &lt;span class="n"&gt;dts&lt;/span&gt; &lt;span class="n"&gt;acpi&lt;/span&gt; &lt;span class="n"&gt;mmx&lt;/span&gt; &lt;span class="n"&gt;fxsr&lt;/span&gt; &lt;span class="n"&gt;sse&lt;/span&gt; &lt;span class="n"&gt;sse2&lt;/span&gt; &lt;span class="n"&gt;ss&lt;/span&gt; &lt;span class="n"&gt;ht&lt;/span&gt; &lt;span class="n"&gt;tm&lt;/span&gt; &lt;span class="n"&gt;pbe&lt;/span&gt; &lt;span class="n"&gt;syscall&lt;/span&gt; &lt;span class="n"&gt;nx&lt;/span&gt; &lt;span class="n"&gt;rdtscp&lt;/span&gt; &lt;span class="n"&gt;lm&lt;/span&gt; &lt;span class="n"&gt;constant_tsc&lt;/span&gt; &lt;span class="n"&gt;arch_perfmon&lt;/span&gt; &lt;span class="n"&gt;pebs&lt;/span&gt; &lt;span class="n"&gt;bts&lt;/span&gt; &lt;span class="n"&gt;rep_good&lt;/span&gt; &lt;span class="n"&gt;nopl&lt;/span&gt; &lt;span class="n"&gt;xtopology&lt;/span&gt; &lt;span class="n"&gt;nonstop_tsc&lt;/span&gt; &lt;span class="n"&gt;cpuid&lt;/span&gt; &lt;span class="n"&gt;aperfmperf&lt;/span&gt; &lt;span class="n"&gt;pni&lt;/span&gt; &lt;span class="n"&gt;pclmulqdq&lt;/span&gt; &lt;span class="n"&gt;dtes64&lt;/span&gt; &lt;span class="n"&gt;monitor&lt;/span&gt; &lt;span class="n"&gt;ds_cpl&lt;/span&gt; &lt;span class="n"&gt;vmx&lt;/span&gt; &lt;span class="n"&gt;est&lt;/span&gt; &lt;span class="n"&gt;tm2&lt;/span&gt; &lt;span class="n"&gt;ssse3&lt;/span&gt; &lt;span class="n"&gt;cx16&lt;/span&gt; &lt;span class="n"&gt;xtpr&lt;/span&gt; &lt;span class="n"&gt;pdcm&lt;/span&gt; &lt;span class="n"&gt;sse4_1&lt;/span&gt; &lt;span class="n"&gt;sse4_2&lt;/span&gt; &lt;span class="n"&gt;movbe&lt;/span&gt; &lt;span class="n"&gt;popcnt&lt;/span&gt; &lt;span class="n"&gt;tsc_deadline_timer&lt;/span&gt; &lt;span class="n"&gt;aes&lt;/span&gt; &lt;span class="n"&gt;rdrand&lt;/span&gt; &lt;span class="n"&gt;lahf_lm&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="n"&gt;dnowprefetch&lt;/span&gt; &lt;span class="n"&gt;cpuid_fault&lt;/span&gt; &lt;span class="n"&gt;epb&lt;/span&gt; &lt;span class="n"&gt;tpr_shadow&lt;/span&gt; &lt;span class="n"&gt;vnmi&lt;/span&gt; &lt;span class="n"&gt;flexpriority&lt;/span&gt; &lt;span class="n"&gt;ept&lt;/span&gt; &lt;span class="n"&gt;vpid&lt;/span&gt; &lt;span class="n"&gt;tsc_adjust&lt;/span&gt; &lt;span class="n"&gt;smep&lt;/span&gt; &lt;span class="n"&gt;erms&lt;/span&gt; &lt;span class="n"&gt;dtherm&lt;/span&gt; &lt;span class="n"&gt;ida&lt;/span&gt; &lt;span class="n"&gt;arat&lt;/span&gt;
&lt;span class="n"&gt;bugs&lt;/span&gt;            &lt;span class="o"&gt;:&lt;/span&gt;
&lt;span class="n"&gt;bogomips&lt;/span&gt;        &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mf"&gt;3492.56&lt;/span&gt;
&lt;span class="n"&gt;clflush&lt;/span&gt; &lt;span class="n"&gt;size&lt;/span&gt;    &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;64&lt;/span&gt;
&lt;span class="n"&gt;cache_alignment&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;64&lt;/span&gt;
&lt;span class="n"&gt;address&lt;/span&gt; &lt;span class="n"&gt;sizes&lt;/span&gt;   &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;36&lt;/span&gt; &lt;span class="n"&gt;bits&lt;/span&gt; &lt;span class="n"&gt;physical&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;48&lt;/span&gt; &lt;span class="n"&gt;bits&lt;/span&gt; &lt;span class="n"&gt;virtual&lt;/span&gt;
&lt;span class="n"&gt;power&lt;/span&gt; &lt;span class="n"&gt;management&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;PCI&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo lspci 
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="mi"&gt;00&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;00.0&lt;/span&gt; &lt;span class="n"&gt;Host&lt;/span&gt; &lt;span class="n"&gt;bridge&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Intel&lt;/span&gt; &lt;span class="n"&gt;Corporation&lt;/span&gt; &lt;span class="n"&gt;Atom&lt;/span&gt; &lt;span class="n"&gt;processor&lt;/span&gt; &lt;span class="n"&gt;C2000&lt;/span&gt; &lt;span class="n"&gt;SoC&lt;/span&gt; &lt;span class="n"&gt;Transaction&lt;/span&gt; &lt;span class="n"&gt;Router&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rev&lt;/span&gt; &lt;span class="mi"&gt;02&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="mi"&gt;00&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="n"&gt;Host&lt;/span&gt; &lt;span class="n"&gt;bridge&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Intel&lt;/span&gt; &lt;span class="n"&gt;Corporation&lt;/span&gt; &lt;span class="n"&gt;Atom&lt;/span&gt; &lt;span class="n"&gt;processor&lt;/span&gt; &lt;span class="n"&gt;C2000&lt;/span&gt; &lt;span class="n"&gt;RAS&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rev&lt;/span&gt; &lt;span class="mi"&gt;02&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="mi"&gt;00&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="n"&gt;IOMMU&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Intel&lt;/span&gt; &lt;span class="n"&gt;Corporation&lt;/span&gt; &lt;span class="n"&gt;Atom&lt;/span&gt; &lt;span class="n"&gt;processor&lt;/span&gt; &lt;span class="n"&gt;C2000&lt;/span&gt; &lt;span class="n"&gt;RCEC&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rev&lt;/span&gt; &lt;span class="mi"&gt;02&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="mi"&gt;00&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;13.0&lt;/span&gt; &lt;span class="n"&gt;System&lt;/span&gt; &lt;span class="n"&gt;peripheral&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Intel&lt;/span&gt; &lt;span class="n"&gt;Corporation&lt;/span&gt; &lt;span class="n"&gt;Atom&lt;/span&gt; &lt;span class="n"&gt;processor&lt;/span&gt; &lt;span class="n"&gt;C2000&lt;/span&gt; &lt;span class="n"&gt;SMBus&lt;/span&gt; &lt;span class="mf"&gt;2.0&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rev&lt;/span&gt; &lt;span class="mi"&gt;02&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="mi"&gt;00&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;14.0&lt;/span&gt; &lt;span class="n"&gt;Ethernet&lt;/span&gt; &lt;span class="n"&gt;controller&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Intel&lt;/span&gt; &lt;span class="n"&gt;Corporation&lt;/span&gt; &lt;span class="n"&gt;Ethernet&lt;/span&gt; &lt;span class="n"&gt;Connection&lt;/span&gt; &lt;span class="n"&gt;I354&lt;/span&gt; &lt;span class="mf"&gt;2.5&lt;/span&gt; &lt;span class="n"&gt;GbE&lt;/span&gt; &lt;span class="n"&gt;Backplane&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rev&lt;/span&gt; &lt;span class="mi"&gt;03&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="mi"&gt;00&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;16.0&lt;/span&gt; &lt;span class="n"&gt;USB&lt;/span&gt; &lt;span class="n"&gt;controller&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Intel&lt;/span&gt; &lt;span class="n"&gt;Corporation&lt;/span&gt; &lt;span class="n"&gt;Atom&lt;/span&gt; &lt;span class="n"&gt;processor&lt;/span&gt; &lt;span class="n"&gt;C2000&lt;/span&gt; &lt;span class="n"&gt;USB&lt;/span&gt; &lt;span class="n"&gt;Enhanced&lt;/span&gt; &lt;span class="n"&gt;Host&lt;/span&gt; &lt;span class="n"&gt;Controller&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rev&lt;/span&gt; &lt;span class="mi"&gt;02&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="mi"&gt;00&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;18.0&lt;/span&gt; &lt;span class="n"&gt;SATA&lt;/span&gt; &lt;span class="n"&gt;controller&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Intel&lt;/span&gt; &lt;span class="n"&gt;Corporation&lt;/span&gt; &lt;span class="n"&gt;Atom&lt;/span&gt; &lt;span class="n"&gt;processor&lt;/span&gt; &lt;span class="n"&gt;C2000&lt;/span&gt; &lt;span class="n"&gt;AHCI&lt;/span&gt; &lt;span class="n"&gt;SATA3&lt;/span&gt; &lt;span class="n"&gt;Controller&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rev&lt;/span&gt; &lt;span class="mi"&gt;02&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="mi"&gt;00&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="n"&gt;ISA&lt;/span&gt; &lt;span class="n"&gt;bridge&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Intel&lt;/span&gt; &lt;span class="n"&gt;Corporation&lt;/span&gt; &lt;span class="n"&gt;Atom&lt;/span&gt; &lt;span class="n"&gt;processor&lt;/span&gt; &lt;span class="n"&gt;C2000&lt;/span&gt; &lt;span class="n"&gt;PCU&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rev&lt;/span&gt; &lt;span class="mi"&gt;02&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="mi"&gt;00&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt; &lt;span class="n"&gt;SMBus&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Intel&lt;/span&gt; &lt;span class="n"&gt;Corporation&lt;/span&gt; &lt;span class="n"&gt;Atom&lt;/span&gt; &lt;span class="n"&gt;processor&lt;/span&gt; &lt;span class="n"&gt;C2000&lt;/span&gt; &lt;span class="n"&gt;PCU&lt;/span&gt; &lt;span class="n"&gt;SMBus&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rev&lt;/span&gt; &lt;span class="mi"&gt;02&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;USB&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="go"&gt;lsusb&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Bus 001 Device 002: ID 8087:07db Intel Corp. 
Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Operating System&lt;/h1&gt;
&lt;p&gt;My Edge Router run with ArchLinux.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Change password for main user&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; passwd
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Change password for root user&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo su
&lt;span class="gp"&gt;$&lt;/span&gt; passwd
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Sync repository&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo pacman -Sy
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Update system&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo pacman -Su
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Configure nano (text editor)&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /etc/nanorc
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;set nowrap
include "/usr/share/nano/*.nanorc"
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Fail2ban&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Configure SSH daemon&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /etc/ssh/sshd_config
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;LogLevel VERBOSE
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Restart SSH daemon&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl restart sshd
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Install fail2ban&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo pacman -S --noconfirm fail2ban
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Configure fail2ban for SSH daemon&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /etc/fail2ban/jail.d/jail.conf
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;[DEFAULT]&lt;/span&gt;
&lt;span class="na"&gt;bantime&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;864000&lt;/span&gt;
&lt;span class="na"&gt;ignoreip&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;127.0.0.1/8 10.0.0.0/24 10.XXX.3.0/24&lt;/span&gt;


&lt;span class="k"&gt;[sshd]&lt;/span&gt;
&lt;span class="na"&gt;enabled&lt;/span&gt;  &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;true&lt;/span&gt;
&lt;span class="na"&gt;filter&lt;/span&gt;   &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;sshd&lt;/span&gt;
&lt;span class="na"&gt;action&lt;/span&gt;   &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;iptables[name=SSH, port=ssh, protocol=tcp]&lt;/span&gt;
&lt;span class="na"&gt;backend&lt;/span&gt;  &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;systemd&lt;/span&gt;
&lt;span class="na"&gt;maxretry&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;5&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Start fail2ban&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl start fail2ban.service
&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl &lt;span class="nb"&gt;enable&lt;/span&gt; fail2ban.service
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Read log (for debugging purposes)&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo journalctl -b -u fail2ban -n &lt;span class="m"&gt;50&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;ARP Wathching&lt;/h1&gt;
&lt;p&gt;Arpwatch is an open source computer software program that helps you to monitor Ethernet traffic activity (like Changing IP and MAC Addresses) on your network and maintains a database of ethernet/ip address pairings.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Install ARP Watch (in progress)&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo pacman -S --noconfirm arpwatch
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Select msmtp-mta as smtp-forwarder&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Create unit file for SystemD&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /etc/systemd/system/arpwatch.service
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;[Unit]&lt;/span&gt;
&lt;span class="na"&gt;Description&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;Arpwatch daemon which keeps track of ethernet/ip address pairings&lt;/span&gt;
&lt;span class="na"&gt;After&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;network.target&lt;/span&gt;

&lt;span class="k"&gt;[Service]&lt;/span&gt;
&lt;span class="na"&gt;Type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;forking&lt;/span&gt;
&lt;span class="na"&gt;ExecStart&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;/usr/sbin/arpwatch -u arpwatch -e root -s 'root (Arpwatch)'&lt;/span&gt;

&lt;span class="k"&gt;[Install]&lt;/span&gt;
&lt;span class="na"&gt;WantedBy&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;multi-user.target&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Start ARP Watch&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl start arpwatch.service
&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl &lt;span class="nb"&gt;enable&lt;/span&gt; arpwatch.service
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Next step&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Install &lt;a href="http://didier.bernaudeau.net/HowTo_install_OpenVPN_on_ArchLinux.html"&gt;OpenVPN&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><category term="Network"></category><category term="ArchLinux"></category><category term="Dedibox"></category></entry><entry><title>How to install OpenVPN on ArchLinux</title><link href="http://didier.bernaudeau.net/HowTo_install_OpenVPN_on_ArchLinux.html" rel="alternate"></link><published>2017-09-03T22:46:00+02:00</published><updated>2017-11-18T01:55:00+01:00</updated><author><name>Didier BERNAUDEAU</name></author><id>tag:didier.bernaudeau.net,2017-09-03:/HowTo_install_OpenVPN_on_ArchLinux.html</id><summary type="html">&lt;p&gt;OpenVPN is an open-source software application that implements virtual private network (VPN) for creating secure point-to-point connections. This software is available on all Linux distributions. This tutorial describes how to install an OpenVPN server on ArchLinux with routed lan.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;OpenVPN is an open-source software application that implements virtual private network (VPN) for creating secure point-to-point connections. This software is available on all Linux distributions. This tutorial describes how to install an OpenVPN server on ArchLinux with routed lan.&lt;/p&gt;

&lt;p align="center"&gt;&lt;img class="img-responsive" src="images/2017-09-03_OpenVPN_01.png" width="60%"/&gt;&lt;/p&gt;
&lt;h1&gt;Create a PKI&lt;/h1&gt;
&lt;p&gt;This following PKI is created on my laptop with Gentoo Linux. This is a quick way to create a PKI for testing purpose only.&lt;/p&gt;
&lt;h2&gt;Certificate Authority&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Install Easy RSA&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; emerge app-crypt/easy-rsa
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Copy files for a new Certificate Authority&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; cp -a /usr/share/easy-rsa /root/MyPKI
&lt;span class="gp"&gt;#&lt;/span&gt; &lt;span class="nb"&gt;cd&lt;/span&gt; /root/MyPKI
&lt;span class="gp"&gt;#&lt;/span&gt; mv vars.example vars
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Configure&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; nano /root/MyPKI/vars
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;set_var EASYRSA_DN      "org"

set_var EASYRSA_REQ_COUNTRY     "FR"
set_var EASYRSA_REQ_PROVINCE    "MyProvince"
set_var EASYRSA_REQ_CITY        "MyCity"
set_var EASYRSA_REQ_ORG         "MyOrg"
set_var EASYRSA_REQ_EMAIL       "me@org.net"

set_var EASYRSA_ALGO            ec
set_var EASYRSA_CURVE           secp384r1

set_var EASYRSA_CA_EXPIRE       3650
set_var EASYRSA_CERT_EXPIRE     1825
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Delete any previously created certificates&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; /root/MyPKI/easyrsa init-pki
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Generates the Certificate Authority certificate.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; /root/MyPKI/easyrsa build-ca
&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;Server Certificate&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Generates a server certificate &lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; /root/MyPKI/easyrsa gen-req openvpn nopass
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Sign the certificate&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; /root/MyPKI/easyrsa sign-req server openvpn
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Send files to the server&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; scp -p /root/MyPKI/pki/ca.crt user@hostname:/home/user/
&lt;span class="gp"&gt;#&lt;/span&gt; scp -p /root/MyPKI/pki/issued/openvpn.crt user@hostname:/home/user/
&lt;span class="gp"&gt;#&lt;/span&gt; scp -p /root/MyPKI/pki/private/openvpn.key user@hostname:/home/user/
&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;Client Certificate&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Create a certificate&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; &lt;span class="nb"&gt;cd&lt;/span&gt; /root/MyPKI/
&lt;span class="gp"&gt;#&lt;/span&gt; ./easyrsa build-client-full hostname nopass
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Get private key&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; nano /root/MyPKI/pki/private/hostname.key
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Get certificate&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; nano /root/MyPKI/pki/issued/hostname.crt
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;or&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; openssl x509 -in hostname.crt -text
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Server Side&lt;/h1&gt;
&lt;p&gt;OpenVPN server is install on "edge.domain.net", a dedicated server hosted by an hosting provider.&lt;/p&gt;
&lt;h2&gt;OpenVPN&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Install OpenVPN&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo pacman -S --noconfirm openvpn
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Copy certificate files&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo mv /home/user/ca.crt /etc/openvpn/server/
&lt;span class="gp"&gt;$&lt;/span&gt; sudo mv /home/user/openvpn.crt /etc/openvpn/server/server.crt
&lt;span class="gp"&gt;$&lt;/span&gt; sudo mv /home/user/openvpn.key /etc/openvpn/server/server.key
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Generate TLS Auth secret key&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo openvpn --genkey --secret /etc/openvpn/server/ta.key
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Generate Diffie Hellman parameters (Still needed even with elliptic curve cryptography)&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; sudo openssl dhparam -out /etc/openvpn/server/dh2048.pem &lt;span class="m"&gt;2048&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Define client configuration&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo mkdir /etc/openvpn/ccd
&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /etc/openvpn/ccd/g8way
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;iroute 10.XXX.3.0 255.255.255.0
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Configure&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo cp /usr/share/openvpn/examples/server.conf /etc/openvpn/server/server.conf
&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /etc/openvpn/server/server.conf
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;ca ca.crt
cert server.crt
key server.key
dh dh2048.pem

topology subnet
server 10.0.0.0 255.255.255.0

push "route 10.XXX.3.0 255.255.255.0"
route 10.XXX.3.0 255.255.255.0

client-config-dir /etc/openvpn/ccd

push "redirect-gateway def1 bypass-dhcp"
push "dhcp-option DNS w.x.y.z"
push "dhcp-option DNS w.x.y.z"

tls-auth ta.key 0
cipher AES-256-GCM

user nobody
group nobody

tls-version-min 1.2
tls-cipher TLS-ECDHE-ECDSA-WITH-AES-256-GCM-SHA384
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Start&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl start openvpn-server@server.service
&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl &lt;span class="nb"&gt;enable&lt;/span&gt; openvpn-server@server.service
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Read log for debugging&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo journalctl -u openvpn-server@server.service --since today
&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;Network routing&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Edit kernel configuration&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /etc/sysctl.d/10-IpForward.conf
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;net.ipv4.ip_forward=1
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Apply changes&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="go"&gt;sudo sysctl --system&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Verify&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo sysctl net.ipv4.ip_forward
&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;Configure Netfilter&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Create configuration file&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo touch /etc/iptables/iptables.rules
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Start iptables&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl start iptables
&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl &lt;span class="nb"&gt;enable&lt;/span&gt; iptables
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Configure&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; nano iptables.sh
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;# !/bin/bash

PublicAddress=w.x.y.z
PublicInterface=enp0s20

VpnNetwork=10.0.0.0/24
G8wayAddress=10.0.0.Y
LanNetwork=10.XX.3.0/24

###### Init

# flush existing rules
sudo iptables -F
sudo iptables -X
sudo iptables -t nat -F
sudo iptables -t nat -X

# Default policy
sudo iptables -t filter -P INPUT DROP
sudo iptables -t filter -P FORWARD DROP
sudo iptables -t filter -P OUTPUT DROP


###### Logging

# Create chain for logging
sudo iptables -N LogInputChain
sudo iptables -N LogOutputChain
sudo iptables -N LogForwardChain

# Configure chain for logging
sudo iptables -A LogInputChain -m limit --limit 2/min -j LOG --log-prefix "Dropped in Input chain: " --log-level 4
sudo iptables -A LogOutputChain -m limit --limit 2/min -j LOG --log-prefix "Dropped in Output chain: " --log-level 4
sudo iptables -A LogForwardChain -m limit --limit 2/min -j LOG --log-prefix "Dropped in Forward chain: " --log-level 4


###### NAT

# Outgoing flow to internet from VPN
sudo iptables -t nat -A POSTROUTING -s $VpnNetwork -o $PublicInterface -j MASQUERADE

# Outgoing flow to internet from LAN
sudo iptables -t nat -A POSTROUTING -s $LanNetwork -o $PublicInterface -j MASQUERADE


###### Forwarding flows (from G8way)

# DNS
sudo iptables -A FORWARD -i tun0 -o $PublicInterface -s $G8wayAddress -p udp --dport 53 -m conntrack --ctstate NEW,RELATED,ESTABLISHED -j ACCEPT
sudo iptables -A FORWARD -i tun0 -o $PublicInterface -s $G8wayAddress -p tcp --dport 53 -m conntrack --ctstate NEW,RELATED,ESTABLISHED -j ACCEPT

# NTP
sudo iptables -A FORWARD -i tun0 -o $PublicInterface -s $G8wayAddress -p udp --dport 123 -m conntrack --ctstate NEW,RELATED,ESTABLISHED -j ACCEPT

# HTTP
sudo iptables -A FORWARD -i tun0 -o $PublicInterface -s $G8wayAddress -p tcp --dport 80 -m conntrack --ctstate NEW,RELATED,ESTABLISHED -j ACCEPT

# HTTPS
sudo iptables -A FORWARD -i tun0 -o $PublicInterface -s $G8wayAddress -p tcp --dport 443 -m conntrack --ctstate NEW,RELATED,ESTABLISHED -j ACCEPT


###### Forwarding flows (from internal LAN)

# HTTP
sudo iptables -A FORWARD -i tun0 -o $PublicInterface -s $LanNetwork -p tcp --dport 80 -m conntrack --ctstate NEW,RELATED,ESTABLISHED -j ACCEPT

# HTTPS
sudo iptables -A FORWARD -i tun0 -o $PublicInterface -s $LanNetwork -p tcp --dport 443 -m conntrack --ctstate NEW,RELATED,ESTABLISHED -j ACCEPT

# SMTP (Submission with Start TLS)
sudo iptables -A FORWARD -i tun0 -o $PublicInterface -s $LanNetwork -p tcp --dport 465 -m conntrack --ctstate NEW,RELATED,ESTABLISHED -j ACCEPT

# SMTPS (Submission with SSL)
sudo iptables -A FORWARD -i tun0 -o $PublicInterface -s $LanNetwork -p tcp --dport 587 -m conntrack --ctstate NEW,RELATED,ESTABLISHED -j ACCEPT

# RSYNC
sudo iptables -A FORWARD -i tun0 -o $PublicInterface -s $LanNetwork -p tcp --dport 873 -m conntrack --ctstate NEW,RELATED,ESTABLISHED -j ACCEPT

# IMAPS
sudo iptables -A FORWARD -i tun0 -o $PublicInterface -s $LanNetwork -p tcp --dport 993 -m conntrack --ctstate NEW,RELATED,ESTABLISHED -j ACCEPT

# Allow forwarding for already established connection
sudo iptables -A FORWARD -i $PublicInterface -o tun0 -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT


###### Incoming flow (from Internet)

# OpenVPN
sudo iptables -A INPUT -i $PublicInterface -d $PublicAddress -p udp --dport 1194 -m conntrack --ctstate NEW,RELATED,ESTABLISHED -j ACCEPT

# SSH
sudo iptables -A INPUT -i enp0s20 -d $PublicAddress -p tcp --dport 22 -m conntrack --ctstate NEW,RELATED,ESTABLISHED -j ACCEPT

# Allow already established connection
sudo iptables -A OUTPUT -o $PublicInterface -s $PublicAddress -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT


###### Incoming flow (from VPN)

# SSH
sudo iptables -A INPUT -i tun0 -p tcp --dport 22 -m conntrack --ctstate NEW,RELATED,ESTABLISHED -j ACCEPT

# Allow already established connection
sudo iptables -A OUTPUT -o tun0 -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT


#### Outgoing flows (to Internet)

# DNS
sudo iptables -A OUTPUT -o $PublicInterface -s $PublicAddress -p udp --dport 53 -m conntrack --ctstate NEW,RELATED,ESTABLISHED -j ACCEPT

# HTTP
sudo iptables -A OUTPUT -o $PublicInterface -s $PublicAddress -p tcp --dport 80 -m conntrack --ctstate NEW,RELATED,ESTABLISHED -j ACCEPT

# HTTPS
sudo iptables -A OUTPUT -o $PublicInterface -s $PublicAddress -p tcp --dport 443 -m conntrack --ctstate NEW,RELATED,ESTABLISHED -j ACCEPT

# Allow already established connection
sudo iptables -A INPUT -i$PublicInterface -d $PublicAddress -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT


# Log (For debug only)
sudo iptables -A FORWARD -j LogForwardChain
sudo iptables -A INPUT -j LogInputChain
sudo iptables -A OUTPUT -j LogOutputChain
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Change file access right&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; chmod +x iptables.sh
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Execute&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; ./iptables.sh
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Save Configuration&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo iptables-save &lt;span class="p"&gt;|&lt;/span&gt; sudo tee /etc/iptables/iptables.rules
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Restart Iptables&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl restart iptables
&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl &lt;span class="nb"&gt;enable&lt;/span&gt; iptables.service
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Viewing log&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo journalctl -k --since &lt;span class="m"&gt;20&lt;/span&gt;:00 &lt;span class="p"&gt;|&lt;/span&gt; grep &lt;span class="s2"&gt;"Dropped"&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; less
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Client Side&lt;/h1&gt;
&lt;h2&gt;Debian&lt;/h2&gt;
&lt;p&gt;OpenVPN client is install on "g8way.domain.net" based on Debian Linux. The configuration is quite tricky to get routed LAN.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Create system user for OpenVPN&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo adduser --system --no-create-home --disabled-login --group  openvpn
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Install OpenVPN&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo apt-get install openvpn
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="go"&gt;sudo chown openvpn:openvpn /etc/openvpn/client/*&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Client configuration&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /etc/openvpn/client/client.conf
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;client

remote edge.domain.net
remote-cert-tls server

ca "/etc/openvpn/client/ca.crt"
cert "/etc/openvpn/client/g8way.crt"
key "/etc/openvpn/client/g8way.key"

tls-auth "/etc/openvpn/client/ta.key" 1
cipher AES-256-GCM

dev tun
proto udp
topology subnet

nobind
auth-nocache
script-security 2

persist-key
persist-tun

user openvpn
group openvpn

tls-version-min 1.2
tls-cipher TLS-ECDHE-ECDSA-WITH-AES-256-GCM-SHA384
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Start OpenVPN client&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl start openvpn-client@client.service
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Troubleshooting&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Dec 14 02:20:16 g8way openvpn[769]: [openvpn] Inactivity timeout (--ping-restart), restarting
Dec 14 02:20:16 g8way openvpn[769]: SIGUSR1[soft,ping-restart] received, process restarting
Dec 14 02:20:21 g8way openvpn[769]: TCP/UDP: Preserving recently used remote address: [AF_INET]w.x.y.z:1194
Dec 14 02:20:21 g8way openvpn[769]: UDP link local: (not bound)
...
Dec 14 02:21:21 g8way openvpn[769]: TLS Error: TLS key negotiation failed to occur within 60 seconds (check your network connectivity)
Dec 14 02:21:21 g8way openvpn[769]: TLS Error: TLS handshake failed
Dec 14 02:21:21 g8way openvpn[769]: SIGUSR1[soft,tls-error] received, process restarting
&lt;/pre&gt;&lt;/div&gt;
&lt;!--
* Configure IpTables

# Allow incoming flow to TUN interface
sudo iptables -A INPUT -i tun+ -j ACCEPT

# Allow outgoing flow from TUN interface
sudo iptables -A OUTPUT -o tun+ -j ACCEPT

# Allow TUN interface connections to be forwarded through other interfaces
sudo iptables -A FORWARD -i tun+ -j ACCEPT
sudo iptables -A FORWARD -i tun+ -o enp3s0 -m state --state RELATED,ESTABLISHED -j ACCEPT
sudo iptables -A FORWARD -i enp3s0: -o tun+ -m state --state RELATED,ESTABLISHED -j ACCEPT
--&gt;
&lt;h2&gt;Android&lt;/h2&gt;
&lt;p&gt;Install "OpenVPN Connect" then import the following profil:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;client

remote edge.lazuly.net
remote-cert-tls server

cipher AES-256-GCM

dev tun
proto udp
topology subnet

nobind
auth-nocache
script-security 2

persist-key
persist-tun

user openvpn
group openvpn

tls-version-min 1.2
tls-cipher TLS-ECDHE-ECDSA-WITH-AES-256-GCM-SHA384

&lt;span class="nt"&gt;&amp;lt;ca&amp;gt;&lt;/span&gt;
-----BEGIN CERTIFICATE-----
...
-----END CERTIFICATE-----
&lt;span class="nt"&gt;&amp;lt;/ca&amp;gt;&lt;/span&gt;

&lt;span class="nt"&gt;&amp;lt;cert&amp;gt;&lt;/span&gt;
-----BEGIN CERTIFICATE-----
...
-----END CERTIFICATE-----
&lt;span class="nt"&gt;&amp;lt;/cert&amp;gt;&lt;/span&gt;

&lt;span class="nt"&gt;&amp;lt;key&amp;gt;&lt;/span&gt;
-----BEGIN PRIVATE KEY-----
.....
-----END PRIVATE KEY-----
&lt;span class="nt"&gt;&amp;lt;/key&amp;gt;&lt;/span&gt;

key-direction 1

&lt;span class="nt"&gt;&amp;lt;tls-auth&amp;gt;&lt;/span&gt;
#
# 2048 bit OpenVPN static key
#
-----BEGIN OpenVPN Static key V1-----
.....
-----END OpenVPN Static key V1-----
&lt;span class="nt"&gt;&amp;lt;/tls-auth&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;nowadays, the ciphersuite "ECDHE-ECDSA-AES256-GCM-SHA384" seems to be unsupported by OpenVPN Connect 1.1.22&lt;/p&gt;</content><category term="Network"></category><category term="ArchLinux"></category><category term="Debian Stretch"></category><category term="VPN"></category><category term="APU"></category></entry><entry><title>Homemade firewall/router on APU</title><link href="http://didier.bernaudeau.net/Homemade_firewall_router_on_APU.html" rel="alternate"></link><published>2017-08-30T21:50:00+02:00</published><updated>2017-11-25T17:42:00+01:00</updated><author><name>Didier BERNAUDEAU</name></author><id>tag:didier.bernaudeau.net,2017-08-30:/Homemade_firewall_router_on_APU.html</id><summary type="html">&lt;p&gt;A personal firewall/router is imperative to secure home network and, above all, to preserve your privacy against indiscretion from your ISP. This firewall/router must provide the minimal network services such as : routing, DHCP, DNS, ...&lt;/p&gt;
&lt;p&gt;In this configuration, IPv6 is completely disabled because my ISP doesn't support prefix delegation, which is mandatory to have IPv6 subnetting on a non-flat network.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;A personal firewall/router is imperative to secure home network and, above all, to preserve your privacy against indiscretion from your ISP. This firewall/router must provide the minimal network services such as : routing, DHCP, DNS, ...&lt;/p&gt;
&lt;p&gt;In this configuration, IPv6 is completely disabled because my ISP doesn't support prefix delegation, which is mandatory to have IPv6 subnetting on a non-flat network.&lt;/p&gt;

&lt;h1&gt;Network Manager&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Install&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo apt-get install -y network-manager
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Configure Network Manager&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /etc/NetworkManager/NetworkManager.conf
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;[ifupdown]&lt;/span&gt;
&lt;span class="na"&gt;managed&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;true&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Configure interfaces&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /etc/network/interfaces
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;# The primary network interface
allow-hotplug enp1s0
iface enp1s0 inet static
        address 10.XXX.1.254
        netmask 255.255.255.0
        gateway 10.XXX.1.1

# Second network interface (IOT)
allow-hotplug enp2s0
iface enp2s0 inet static
        address 10.XXX.2.254
        netmask 255.255.255.0
        gateway 10.XXX.1.1

# Third network interface (LAN)
allow-hotplug enp3s0
iface enp3s0 inet static
        address 10.XXX.3.254
        netmask 255.255.255.0
        gateway 10.XXX.1.1
        dns-nameserver 127.0.0.1
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Start&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl start NetworkManager
&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl &lt;span class="nb"&gt;enable&lt;/span&gt; NetworkManager
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;NTP&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Install NTP server&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo apt-get install -y ntp
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Configure NTP server&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /etc/ntp.conf
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;restrict -4 default kod notrap nomodify nopeer noquery limited
restrict 10.XXX.3.0 mask 255.255.255.0 nomodify notrap
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Configure NTP server&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /etc/default/ntp
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;NTPD_OPTS='-4 -g'
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl start ntp
&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl &lt;span class="nb"&gt;enable&lt;/span&gt; ntp
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Test (On Gentoo Linux)&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; nano /etc/systemd/timesyncd.conf
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;NTP=g8way.domain.net
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; systemctl restart systemd-timesyncd.service
&lt;span class="gp"&gt;#&lt;/span&gt; systemctl status systemd-timesyncd.service
&lt;span class="gp"&gt;#&lt;/span&gt; timedatectl status
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;DHCP Server&lt;/h1&gt;
&lt;p&gt;This DHCP server must assign IP addresses to each client on the networks (LAN and IOT).&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Install&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo apt-get install isc-dhcp-server
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Configure&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="go"&gt;sudo nano /etc/default/isc-dhcp-server&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;INTERFACESv4="enp2s0 enp3s0"
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /etc/dhcp/dhcpd.conf
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;# Include the share secret key for RNDC
include "/etc/bind/rndc.key";

# Enable dynamic DNS with RNDC
ddns-update-style interim;
ignore client-updates;

# Define zone
zone domain.net.
{
        primary 127.0.0.1;
        key rndc-key;
}

zone 3.XXX.10.in-addr.arpa.
{
        primary 127.0.0.1;
        key rndc-key;
}

subnet 10.XXX.3.0 netmask 255.255.255.0 {
        range 10.XXX.3.1 10.XXX.3.99;
        default-lease-time 86400;
        max-lease-time 604800;
        option domain-name "domain.net";
        option domain-name-servers 10.XXX.3.254;
        option subnet-mask 255.255.255.0;
        option broadcast-address 10.XXX.3.255;
        option routers 10.XXX.3.254;
        option ntp-servers 10.XXX.3.254;
}
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /etc/default/isc-dhcp-server
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;INTERFACESv4="enp2s0 enp3s0"
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Start&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl start isc-dhcp-server.service
&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl &lt;span class="nb"&gt;enable&lt;/span&gt; isc-dhcp-server.service
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Test (on Gentoo Linux)&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; dhclient -v enp0s25
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Check DHCP lease&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo tail -f /var/lib/dhcp/dhcpd.leases
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;DNS&lt;/h1&gt;
&lt;p&gt;First of all, Bind is configured to act as a caching DNS server. This configuration will force the server to recursively seek answers from other DNS servers when a client issues a query.
On top of that, Bind is configure to act also as a primary master DNS to serve DNS records for a registered domain name (also used for internal purpose).&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Install Bind&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo apt-get install -y bind9
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Disable IPv6&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /etc/default/bind9
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;OPTIONS="-4 -u bind"
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Generate secret key for RNDC (Remote Name Daemon Control)&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo rndc-confgen -a -c /etc/bind/rndc.key
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Define access right to secret key&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo chmod g+r /etc/bind/rndc.key
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Edit configuration&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /etc/bind/named.conf
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;include "/etc/bind/rndc.key";

controls {
        inet 127.0.0.1 allow { localhost; }
        keys { rndc-key; };
};
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /etc/bind/named.conf.options
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;options {
        directory "/var/cache/bind";
        listen-on { 127.0.0.1; 10.XXX.3.254; };
        listen-on-v6 { none; };
        allow-query { localhost; 10.XXX.3.0/24; };
};
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /etc/bind/named.conf.default-zones
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;zone "domain.net" IN {
        type master;
        file "domain.net.zone";
        allow-update { key rndc-key; };
};

zone "3.XXX.10.in-addr.arpa" IN {
        type master;
        file "10.XXX.3.zone";
        allow-update { key rndc-key; };
};
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Edit zone file for domain.net&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /var/cache/bind/domain.net.zone
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ttl 38400

@               IN      SOA  domain.net.   root.domain.net. (
                                2012032900 ; Serial
                                10800      ; Refresh [3h]
                                3600       ; Retry [1h]
                                604800     ; Expire [1 week]
                                86400      ; TTL [1 jour]
)

@                IN       NS      ns.domain.net.

edge             IN       A       10.0.0.1
g8way            IN       A       10.XXX.3.254
ns               IN       A       10.XXX.3.254
cups             IN       A       10.XXX.3.254
home             IN       A       10.XXX.3.254
brother          IN       A       10.XXX.3.100
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /var/cache/bind/10.XXX.3.zone
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ttl 3h 

@  IN  SOA  domain.net.     root.domain.net. (
                    2012032900 ; Serial
                    10800      ; Refresh [3h]
                    3600       ; Retry [1h]
                    604800     ; Expire [1 week]
                    86400      ; TTL [1 jour]
)

@    IN  NS  ns.domain.net.
254  IN  PTR g8way.domain.net.
100  IN  PTR brother.lazuly.net
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /var/cache/bind/10.0.0.zone
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ttl 3h 

@  IN  SOA  domain.net.     root.domain.net. (
                    2012032900 ; Serial
                    10800      ; Refresh [3h]
                    3600       ; Retry [1h]
                    604800     ; Expire [1 week]
                    86400      ; TTL [1 jour]
)

@    IN  NS  ns.domain.net.
1  IN  PTR edge.domain.net.
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Start&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl start bind9.service
&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl &lt;span class="nb"&gt;enable&lt;/span&gt; bind9.service
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Change journal access right (If needed)&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo chown bind:bind /var/cache/bind/managed-keys.bind.jnl
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Test&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; dig @localhost g8way.domain.net
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Routing&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Enable routing&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="go"&gt;sudo nano /etc/sysctl.conf&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;net.ipv4.ip_forward=1
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Set the new configuration&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo sysctl -p
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;test&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; dig google.fr
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Show route&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="go"&gt;ip route show&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;VPN&lt;/h1&gt;
&lt;p&gt;Follow instruction in this &lt;a href="http://didier.bernaudeau.net/HowTo_install_OpenVPN_on_ArchLinux.html"&gt;post&lt;/a&gt; to install OpenVPN client side on Debian.&lt;/p&gt;
&lt;h1&gt;Firewall&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Create script&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; nano iptables.sh
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;# !/bin/bash

# Interface
PublicInterface=enp1s0
LanInterface=enp3s0

# IP Address
LanAddress=10.XX.3.254
EdgeServer=WWW.XXX.YYY.ZZZ

# Network
LanNetwork=10.XX.3.0/24
PublicNetwork=10.XX.1.0/24
VpnNetwork=10.YY.0.0/24

# flush existing rules
sudo iptables -F
sudo iptables -X

# Default policy
sudo iptables -t filter -P INPUT DROP
sudo iptables -t filter -P FORWARD DROP
sudo iptables -t filter -P OUTPUT DROP


################################ Forwarding (LAN to VPN) ################################

# HTTP
sudo iptables -A FORWARD -i $LanInterface -o tun+ -p tcp --dport 80 -m conntrack --ctstate NEW,RELATED,ESTABLISHED -j ACCEPT

# HTTPS
sudo iptables -A FORWARD -i $LanInterface -o tun+ -p tcp --dport 443 -m conntrack --ctstate NEW,RELATED,ESTABLISHED -j ACCEPT

# SSH
sudo iptables -A FORWARD -i $LanInterface -o tun+ -p tcp --dport 22 -m conntrack --ctstate NEW,RELATED,ESTABLISHED -j ACCEPT

# SMTP Submission with TLS
sudo iptables -A FORWARD -i $LanInterface -o tun+ -p tcp --dport 465 -m conntrack --ctstate NEW,RELATED,ESTABLISHED -j ACCEPT

# SMTP Submission with StartTLS
sudo iptables -A FORWARD -i $LanInterface -o tun+ -p tcp --dport 587 -m conntrack --ctstate NEW,RELATED,ESTABLISHED -j ACCEPT

# IMAPS
sudo iptables -A FORWARD -i $LanInterface -o tun+ -p tcp --dport 993 -m conntrack --ctstate NEW,RELATED,ESTABLISHED -j ACCEPT

# Allow forwarding for already established connection 
sudo iptables -A FORWARD -i tun+ -o $LanInterface -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT


######################## Outgoing flow via LiveBox ########################

# Allow DNS
sudo iptables -A OUTPUT -o $PublicInterface -p udp --dport 53 -m conntrack --ctstate NEW,RELATED,ESTABLISHED -j ACCEPT

# OpenVPN
sudo iptables -A OUTPUT -o $PublicInterface -d $EdgeServer -p udp --dport 1194 -m conntrack --ctstate NEW,RELATED,ESTABLISHED -j ACCEPT

# Allow Internet Browsing
sudo iptables -A OUTPUT -o $PublicInterface -p tcp --dport 80 -m conntrack --ctstate NEW,RELATED,ESTABLISHED -j ACCEPT
sudo iptables -A OUTPUT -o $PublicInterface -p tcp --dport 443 -m conntrack --ctstate NEW,RELATED,ESTABLISHED -j ACCEPT

# Allow incoming established connection
sudo iptables -A INPUT -i $PublicInterface -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT


############################## Outgoing local flow via VPN ##############################

# Allow DNS
sudo iptables -A OUTPUT -o tun+ -p udp --dport 53 -m conntrack --ctstate NEW,RELATED,ESTABLISHED -j ACCEPT
sudo iptables -A OUTPUT -o tun+ -p tcp --dport 53 -m conntrack --ctstate NEW,RELATED,ESTABLISHED -j ACCEPT

# Allow NTP
sudo iptables -A OUTPUT -o tun+ -p udp --dport 123 -m conntrack --ctstate NEW,RELATED,ESTABLISHED -j ACCEPT

# Allow HTTP
sudo iptables -A OUTPUT -o tun+ -p tcp --dport 80 -m conntrack --ctstate NEW,RELATED,ESTABLISHED -j ACCEPT

# Allow HTTPS
sudo iptables -A OUTPUT -o tun+ -p tcp --dport 443 -m conntrack --ctstate NEW,RELATED,ESTABLISHED -j ACCEPT

# Allow incoming established connection from VPN
sudo iptables -A INPUT -i tun+ -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT


########################## Incoming flow from Lan Interface ###########################

# DHCP
sudo iptables -I INPUT -i $LanInterface -p udp -m udp --sport 68 --dport 67 -j ACCEPT

# SSH
sudo iptables -A INPUT -i $LanInterface -d $LanAddress -p tcp --dport 22 -m conntrack --ctstate NEW,RELATED,ESTABLISHED -j ACCEPT

# DNS
sudo iptables -A INPUT -i $LanInterface -d $LanAddress -p udp --dport 53 -m conntrack --ctstate NEW,RELATED,ESTABLISHED -j ACCEPT

# NTP
sudo iptables -A INPUT -i $LanInterface -d $LanAddress -p udp --dport 123 -m conntrack --ctstate NEW,RELATED,ESTABLISHED -j ACCEPT

# Allow outgoing established connection
sudo iptables -A OUTPUT -o $LanInterface -s $LanAddress -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT


######################## Internal flow from Local Interface #########################

# DNS
sudo iptables -A INPUT -i lo -d 127.0.0.1 -p udp --dport 53 -m conntrack --ctstate NEW,RELATED,ESTABLISHED -j ACCEPT
sudo iptables -A OUTPUT -o lo -d 127.0.0.1 -p udp --dport 53 -m conntrack --ctstate NEW,RELATED,ESTABLISHED -j ACCEPT

# RNDC
sudo iptables -A INPUT -i lo -d 127.0.0.1 -p tcp --dport 953 -m conntrack --ctstate NEW,RELATED,ESTABLISHED -j ACCEPT

# Allow outgoing and incoming established connection
sudo iptables -A OUTPUT -o lo -s 127.0.0.1 -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT
sudo iptables -A INPUT -i lo -s 127.0.0.1 -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Execute script to set rules&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; chmod o+w iptables.sh
&lt;span class="gp"&gt;$&lt;/span&gt; ./iptables.sh
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Install tool for iptables&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo apt-get install iptables-persistent
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Save current IPv4 rules? Yes
Save current IPv6 rules? Yes
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Save configuration (to be done after every modification)&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo dpkg-reconfigure iptables-persistent
&lt;/pre&gt;&lt;/div&gt;</content><category term="APU"></category><category term="Debian Stretch"></category></entry><entry><title>HTTP Observatory Website</title><link href="http://didier.bernaudeau.net/HTTP_Observatory_Website.html" rel="alternate"></link><published>2017-08-20T12:16:00+02:00</published><updated>2017-07-24T23:17:00+02:00</updated><author><name>Didier BERNAUDEAU</name></author><id>tag:didier.bernaudeau.net,2017-08-20:/HTTP_Observatory_Website.html</id><summary type="html">&lt;p&gt;HTTP Observatory Web is a web application for TLS and HTTP Observatory. This post describes a way to install HTTP Observatory Web on Red Hat 7.3.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;HTTP Observatory Web is a web application for TLS and HTTP Observatory. This post describes a way to install HTTP Observatory Web on Red Hat 7.3.&lt;/p&gt;

&lt;h1&gt;Nginx&lt;/h1&gt;
&lt;p&gt;Nginx, configured as a reverse proxy, could be used as a single entry point for APIs and Website.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Install Nginx&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo yum install -y nginx
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Configure Nginx to remove IPV6&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /etc/nginx/nginx.conf
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;server {
  listen       80 default_server;
  #listen       [::]:80 default_server;
}
 ```

* Add site for APIs and Website

```console
$ sudo nano /etc/nginx/conf.d/observatory.conf
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;server&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="err"&gt;listen&lt;/span&gt;          &lt;span class="err"&gt;443&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="err"&gt;server_name&lt;/span&gt;     &lt;span class="err"&gt;observatory.intra&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="err"&gt;access_log&lt;/span&gt;      &lt;span class="err"&gt;/var/log/nginx/observatory.access.log&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="err"&gt;error_log&lt;/span&gt;       &lt;span class="err"&gt;/var/log/nginx/observatory.error.log&lt;/span&gt; &lt;span class="err"&gt;debug&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

  &lt;span class="err"&gt;location&lt;/span&gt; &lt;span class="err"&gt;/&lt;/span&gt; &lt;span class="err"&gt;{&lt;/span&gt;
     &lt;span class="err"&gt;proxy_buffering&lt;/span&gt; &lt;span class="err"&gt;off&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
     &lt;span class="err"&gt;proxy_set_header&lt;/span&gt; &lt;span class="err"&gt;Host&lt;/span&gt; &lt;span class="err"&gt;$host&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
     &lt;span class="err"&gt;proxy_set_header&lt;/span&gt; &lt;span class="err"&gt;X-Real-IP&lt;/span&gt; &lt;span class="err"&gt;$remote_addr&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
     &lt;span class="err"&gt;proxy_pass&lt;/span&gt; &lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;//&lt;/span&gt;&lt;span class="n"&gt;localhost&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;intra&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;5500&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
   &lt;span class="p"&gt;}&lt;/span&gt;

  &lt;span class="nt"&gt;location&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;http&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
     &lt;span class="err"&gt;proxy_buffering&lt;/span&gt; &lt;span class="err"&gt;off&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
     &lt;span class="err"&gt;proxy_set_header&lt;/span&gt; &lt;span class="err"&gt;Host&lt;/span&gt; &lt;span class="err"&gt;$host&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
     &lt;span class="err"&gt;proxy_set_header&lt;/span&gt; &lt;span class="err"&gt;X-Real-IP&lt;/span&gt; &lt;span class="err"&gt;$remote_addr&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
     &lt;span class="err"&gt;proxy_pass&lt;/span&gt; &lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;//&lt;/span&gt;&lt;span class="n"&gt;localhost&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;57001&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
   &lt;span class="p"&gt;}&lt;/span&gt;

  &lt;span class="nt"&gt;location&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;tls&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
     &lt;span class="err"&gt;proxy_http_version&lt;/span&gt;  &lt;span class="err"&gt;1.1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
     &lt;span class="err"&gt;proxy_set_header&lt;/span&gt;    &lt;span class="err"&gt;Accept-Encoding&lt;/span&gt; &lt;span class="err"&gt;""&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
     &lt;span class="err"&gt;proxy_set_header&lt;/span&gt;    &lt;span class="err"&gt;Host&lt;/span&gt; &lt;span class="err"&gt;$host&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
     &lt;span class="err"&gt;proxy_set_header&lt;/span&gt;    &lt;span class="err"&gt;X-Real-IP&lt;/span&gt; &lt;span class="err"&gt;$remote_addr&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
     &lt;span class="err"&gt;proxy_set_header&lt;/span&gt;    &lt;span class="err"&gt;X-Forwarded-For&lt;/span&gt; &lt;span class="err"&gt;$proxy_add_x_forwarded_for&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
     &lt;span class="err"&gt;proxy_buffering&lt;/span&gt;     &lt;span class="err"&gt;off&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
     &lt;span class="err"&gt;proxy_pass&lt;/span&gt;          &lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;//&lt;/span&gt;&lt;span class="n"&gt;localhost&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;8083&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

     &lt;span class="err"&gt;sub_filter_once&lt;/span&gt; &lt;span class="err"&gt;off&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
     &lt;span class="err"&gt;sub_filter_types&lt;/span&gt; &lt;span class="err"&gt;text/html&lt;/span&gt; &lt;span class="err"&gt;text/css&lt;/span&gt; &lt;span class="err"&gt;application/javascript&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
     &lt;span class="err"&gt;sub_filter&lt;/span&gt; &lt;span class="err"&gt;"/api/v1/"&lt;/span&gt; &lt;span class="err"&gt;"/tls/api/v1/"&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
     &lt;span class="err"&gt;sub_filter&lt;/span&gt; &lt;span class="err"&gt;"/static/"&lt;/span&gt; &lt;span class="err"&gt;"/tls/static/"&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
   &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="err"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Change access right&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo chmod go+r /etc/nginx/conf.d/observatory.conf
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Démarrer Nginx&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl start nginx
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Get TLS Observatory Website&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Install Git&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo yum install -y git
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Create Apps directory&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo mkdir /apps
&lt;span class="gp"&gt;$&lt;/span&gt; &lt;span class="nb"&gt;cd&lt;/span&gt; /apps
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Clone HTTP Observatory Website&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; git clone https://github.com/mozilla/http-observatory-website.git
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Install Python packages&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Create a new virtual environment for python &lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; &lt;span class="nb"&gt;cd&lt;/span&gt; /apps/http-observatory-website
&lt;span class="gp"&gt;$&lt;/span&gt; virtualenv PyEnv
&lt;span class="gp"&gt;$&lt;/span&gt; &lt;span class="nb"&gt;source&lt;/span&gt; PyEnv/bin/activate
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Install python module&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; pip install -r requirements.txt
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Configure HTTP Observatory Website&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Change network interface&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; nano /apps/http-observatory-website/devserver.py
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;server.serve(root='dist', port=5500, host='0.0.0.0', liveport=35729)
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Define URL of HTTP Observatory API&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; nano /apps/http-observatory-website/js/httpobs.js
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;    &lt;span class="nt"&gt;domain&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'observatory.intra'&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;
    &lt;span class="nt"&gt;grades&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'A+'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'A'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'A-'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'B+'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'B'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'B-'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'C+'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'C'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'C-'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'D+'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'D'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'D-'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'F'&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;
    &lt;span class="nt"&gt;maxQueriesBeforeTimeout&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;600&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;

    &lt;span class="nt"&gt;urls&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
      &lt;span class="n"&gt;api&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'https://observatory.intra/http/api/v1/'&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="o"&gt;...&lt;/span&gt;

    &lt;span class="nt"&gt;loadHTTPObservatoryHostHistory&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;function&lt;/span&gt; &lt;span class="nt"&gt;loadHTTPObservatoryHostHistory&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="err"&gt;'use&lt;/span&gt; &lt;span class="err"&gt;strict'&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="err"&gt;var&lt;/span&gt; &lt;span class="err"&gt;API_URL&lt;/span&gt; &lt;span class="err"&gt;=&lt;/span&gt; &lt;span class="err"&gt;'&lt;/span&gt;&lt;span class="n"&gt;https&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;//&lt;/span&gt;&lt;span class="n"&gt;observatory&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;intra&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;api&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;v1&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;getHostHistory&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="err"&gt;'&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;Observatory&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;hostname&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="err"&gt;var&lt;/span&gt; &lt;span class="err"&gt;successCallback&lt;/span&gt; &lt;span class="err"&gt;=&lt;/span&gt; &lt;span class="err"&gt;function&lt;/span&gt; &lt;span class="err"&gt;f(data)&lt;/span&gt; &lt;span class="err"&gt;{&lt;/span&gt;
      &lt;span class="err"&gt;Observatory.state.history&lt;/span&gt; &lt;span class="err"&gt;=&lt;/span&gt; &lt;span class="err"&gt;data&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="err"&gt;Observatory.insertHTTPObservatoryHostHistory()&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Define URL of TLS Observatory API&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; nano /apps/http-observatory-website/js/httpobs-third-party.js
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;  &lt;span class="nt"&gt;var&lt;/span&gt; &lt;span class="nt"&gt;SCAN_URL&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'https://observatory.intra/tls/api/v1/scan'&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
  &lt;span class="nt"&gt;var&lt;/span&gt; &lt;span class="nt"&gt;RESULTS_URL&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'https://observatory.intra/tls/api/v1/results'&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
  &lt;span class="nt"&gt;var&lt;/span&gt; &lt;span class="nt"&gt;CERTIFICATE_URL&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'https://observatory.intra/tls/api/v1/certificate'&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
  &lt;span class="nt"&gt;var&lt;/span&gt; &lt;span class="nt"&gt;CERTIFICATE_EXPLAINER_URL&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'https://observatory.intra/tls/static/certsplainer.html'&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Edit file to change images and CSS (if needed)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Make website&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; python render.py
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Start for testing purpose only&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; make devserver
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Open this page with your browser: https://observatory.intra&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;Start services&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Create unit file&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /etc/systemd/system/httpobs-web.service
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;[Unit]&lt;/span&gt;
&lt;span class="na"&gt;Description&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;HTTP Observatory Web&lt;/span&gt;
&lt;span class="na"&gt;After&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;network.target auditd.service&lt;/span&gt;

&lt;span class="k"&gt;[Service]&lt;/span&gt;
&lt;span class="na"&gt;WorkingDirectory&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;/apps/http-observatory-website&lt;/span&gt;
&lt;span class="na"&gt;ExecStart&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;/apps/http-observatory-website/PyEnv/bin/python3.4 /apps/http-observatory-website/devserver.py&lt;/span&gt;
&lt;span class="na"&gt;Restart&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;on-failure&lt;/span&gt;
&lt;span class="na"&gt;User&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;httpobs&lt;/span&gt;
&lt;span class="na"&gt;Group&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;httpobs&lt;/span&gt;
&lt;span class="na"&gt;KillSignal&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;SIGINT&lt;/span&gt;

&lt;span class="k"&gt;[Install]&lt;/span&gt;
&lt;span class="na"&gt;WantedBy&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;multi-user.target&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Start services&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl start httpobs-web.service
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Enable services&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl &lt;span class="nb"&gt;enable&lt;/span&gt; httpobs-web.service
&lt;/pre&gt;&lt;/div&gt;</content><category term="TLS"></category></entry><entry><title>TLS Observatory</title><link href="http://didier.bernaudeau.net/TLS_Observatory.html" rel="alternate"></link><published>2017-08-20T11:15:00+02:00</published><updated>2017-07-24T22:12:00+02:00</updated><author><name>Didier BERNAUDEAU</name></author><id>tag:didier.bernaudeau.net,2017-08-20:/TLS_Observatory.html</id><summary type="html">&lt;p&gt;TLS Observatory is a security tools provided by Mozilla to scan TLS endpoint. This post describes a way to install TLS Observatory on Red Hat 7.3.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;TLS Observatory is a security tools provided by Mozilla to scan TLS endpoint. This post describes a way to install TLS Observatory on Red Hat 7.3.&lt;/p&gt;

&lt;h1&gt;Install Go&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Get Go&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; curl -LO https://storage.googleapis.com/golang/go1.7.linux-amd64.tar.gz
&lt;span class="gp"&gt;$&lt;/span&gt; sudo tar -C /apps/ -xvzf go1.7.linux-amd64.tar.gz
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Define environment varibales&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; &lt;span class="nb"&gt;export&lt;/span&gt; &lt;span class="nv"&gt;PATH&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$PATH&lt;/span&gt;:/apps/go/bin
&lt;span class="gp"&gt;$&lt;/span&gt; &lt;span class="nb"&gt;export&lt;/span&gt; &lt;span class="nv"&gt;GOROOT&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"/apps/go/"&lt;/span&gt;
&lt;span class="gp"&gt;$&lt;/span&gt; &lt;span class="nb"&gt;export&lt;/span&gt; &lt;span class="nv"&gt;GOBIN&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"/apps/go/bin"&lt;/span&gt;
&lt;span class="gp"&gt;$&lt;/span&gt; &lt;span class="nb"&gt;export&lt;/span&gt; &lt;span class="nv"&gt;GOPATH&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"/apps/go/src"&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Install Cipherscan&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Get Cipherscan&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo &lt;span class="nb"&gt;cd&lt;/span&gt; /apps/
&lt;span class="gp"&gt;$&lt;/span&gt; sudo git clone https://github.com/mozilla/cipherscan.git
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Change access right&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo chmod go+rx /apps/cipherscan
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Install TLS Observatory&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;get TLS Observatory&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo mkdir -p /apps/go/src/github.com/mozilla
&lt;span class="gp"&gt;$&lt;/span&gt; sudo &lt;span class="nb"&gt;cd&lt;/span&gt; /apps/go/src/github.com/mozilla
&lt;span class="gp"&gt;$&lt;/span&gt; sudo git clone https://github.com/mozilla/tls-observatory.git
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Compile&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo &lt;span class="nb"&gt;cd&lt;/span&gt; /apps/go/src/github.com/mozilla/tls-observatory
&lt;span class="gp"&gt;$&lt;/span&gt; sudo make
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Change access right&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo chmod go+rX -R /apps/go/src/github.com
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Create database&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Install &lt;a href="http://didier.bernaudeau.net/HowTo_Install_Postgresql_On_RedHat.html"&gt;PostgreSQL&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Create database&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo su - postgres
&lt;span class="gp"&gt;$&lt;/span&gt; createdb observatory
&lt;span class="gp"&gt;$&lt;/span&gt; psql observatory &amp;lt; /apps/TlsObs/database/schema.sql
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Define password&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; psql observatory
&lt;span class="go"&gt;observatory=# \password tlsobsapi&lt;/span&gt;
&lt;span class="go"&gt;observatory=# \password tlsobsscanner&lt;/span&gt;
&lt;span class="go"&gt;observatory=# \q&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Logout Postgres user&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; &lt;span class="nb"&gt;exit&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Configure TLS Observatory&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Edit configuration files for API&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /apps/go/src/github.com/mozilla/tls-observatory/conf/api.cfg
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;PostgresUser    = "tlsobsapi"
PostgresPass    = "*******"
APIListenAddr   = ":8083"
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Edit configuration files for Scanner&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /apps/go/src/github.com/mozilla/tls-observatory/conf/scanner.cfg
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;PostgresDB    = "observatory"
PostgresPass  = "scannerpwd"

[TrustStores]
UbuntuTS  = "/apps/go/src/github.com/mozilla/tls-observatory/conf/truststores/CA_ubuntu_latest.crt"
MozillaTS  = "/apps/go/src/github.com/mozilla/tls-observatory/conf/truststores/CA_mozilla_nss.crt"
MicrosoftTS  = "/apps/go/src/github.com/mozilla/tls-observatory/conf/truststores/CA_microsoft.crt"
AppleTS  = "/apps/go/src/github.com/mozilla/tls-observatory/conf/truststores/CA_apple_latest.crt"
AndroidTS  = "/apps/go/src/github.com/mozilla/tls-observatory/conf/truststores/CA_AOSP.crt"
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Start TlS Observatory (for testing purpose only)&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; /apps/go/src/bin/tlsobs-api -c /apps/go/src/github.com/mozilla/tls-observatory/conf/api.cfg
&lt;span class="gp"&gt;$&lt;/span&gt; /apps/go/src/bin/tlsobs-scanner -b /apps/cipherscan/cipherscan -c /apps/go/src/github.com/mozilla/tls-observatory/conf/scanner.cfg
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;test&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; curl http://observatory.intra:8083/api/v1/truststore?store&lt;span class="o"&gt;=&lt;/span&gt;mozilla&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nv"&gt;format&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;pem
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Start services&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Create unit file for API&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /etc/systemd/system/tlsobs-api.service
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;[Unit]&lt;/span&gt;
&lt;span class="na"&gt;Description&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;TLS Observatory API&lt;/span&gt;
&lt;span class="na"&gt;After&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;network.target auditd.service&lt;/span&gt;

&lt;span class="k"&gt;[Service]&lt;/span&gt;
&lt;span class="na"&gt;WorkingDirectory&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;/apps/go/src/github.com/mozilla/tls-observatory&lt;/span&gt;
&lt;span class="na"&gt;ExecStart&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;/apps/go/src/bin/tlsobs-api -c /apps/go/src/github.com/mozilla/tls-observatory/conf/api.cfg&lt;/span&gt;
&lt;span class="na"&gt;Restart&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;on-failure&lt;/span&gt;
&lt;span class="na"&gt;User&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;httpobs&lt;/span&gt;
&lt;span class="na"&gt;Group&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;httpobs&lt;/span&gt;
&lt;span class="na"&gt;KillSignal&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;SIGINT&lt;/span&gt;

&lt;span class="k"&gt;[Install]&lt;/span&gt;
&lt;span class="na"&gt;WantedBy&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;multi-user.target&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Create unit file for Scanner&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /etc/systemd/system/tlsobs-scanner.service
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;[Unit]&lt;/span&gt;
&lt;span class="na"&gt;Description&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;TLS Observatory Scanner&lt;/span&gt;
&lt;span class="na"&gt;After&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;network.target auditd.service&lt;/span&gt;

&lt;span class="k"&gt;[Service]&lt;/span&gt;
&lt;span class="na"&gt;ExecStart&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;/apps/go/src/bin/tlsobs-scanner -b /apps/cipherscan/cipherscan -c /apps/go/src/github.com/mozilla/tls-observatory/conf/scanner.cfg&lt;/span&gt;
&lt;span class="na"&gt;Restart&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;on-failure&lt;/span&gt;
&lt;span class="na"&gt;User&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;httpobs&lt;/span&gt;
&lt;span class="na"&gt;Group&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;httpobs&lt;/span&gt;
&lt;span class="na"&gt;KillSignal&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;SIGINT&lt;/span&gt;

&lt;span class="k"&gt;[Install]&lt;/span&gt;
&lt;span class="na"&gt;WantedBy&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;multi-user.target&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Start services&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl start tlsobs-api.service
&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl start tlsobs-scanner.service
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Enable services&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl &lt;span class="nb"&gt;enable&lt;/span&gt; tlsobs-api.service
&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl &lt;span class="nb"&gt;enable&lt;/span&gt; tlsobs-scanner.service
&lt;/pre&gt;&lt;/div&gt;</content><category term="TLS"></category></entry><entry><title>HTTP Observatory</title><link href="http://didier.bernaudeau.net/HTTP_Observatory.html" rel="alternate"></link><published>2017-08-20T10:15:00+02:00</published><updated>2017-07-24T21:25:00+02:00</updated><author><name>Didier BERNAUDEAU</name></author><id>tag:didier.bernaudeau.net,2017-08-20:/HTTP_Observatory.html</id><summary type="html">&lt;p&gt;HTTP Observatory is a security tools provided by Mozilla to check HTTP security headers. This post describes a way to install HTTP Observatory on Red Hat 7.3.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;HTTP Observatory is a security tools provided by Mozilla to check HTTP security headers. This post describes a way to install HTTP Observatory on Red Hat 7.3.&lt;/p&gt;

&lt;h1&gt;Get TLS Observatory&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Install Git&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo yum install -y git
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Create Apps directory&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo mkdir /apps
&lt;span class="gp"&gt;$&lt;/span&gt; &lt;span class="nb"&gt;cd&lt;/span&gt; /apps
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Clone HTTP Observatory&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; git clone https://github.com/mozilla/http-observatory.git
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Create database&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Install &lt;a href="http://didier.bernaudeau.net/HowTo_Install_Postgresql_On_RedHat.html"&gt;PostgreSQL&lt;/a&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Create database&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo su - postgres
&lt;span class="gp"&gt;$&lt;/span&gt; createdb http_observatory
&lt;span class="gp"&gt;$&lt;/span&gt; psql http_observatory &amp;lt; /apps/http-observatory/httpobs/database/schema.sql
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Define user password&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; psql http_observatory
&lt;span class="go"&gt;http_observatory=# \password httpobsapi&lt;/span&gt;
&lt;span class="go"&gt;http_observatory=# \password httpobsscanner&lt;/span&gt;
&lt;span class="go"&gt;http_observatory=# \q&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;logout postgres user&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; &lt;span class="nb"&gt;exit&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Edit configuration&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /var/lib/pgsql/9.6/data/postgresql.conf
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;max_connections = 512
shared_buffers = 256MB
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Allow access to PostgreSQL from localhost with authentication by password&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /var/lib/pgsql/9.6/data/pg_hba.conf
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="go"&gt;host    all             all             127.0.0.1/32            md5&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;MD5 is the best cryptographic function supported by RedHat to secure the password exchange. Indeed, SCRAM-SHA-256 is not yet available.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Restart Postgresql&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl restart postgresql-9.6
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Test connection&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; psql --host localhost --dbname http_observatory --username httpobsscanner --password
&lt;span class="gp"&gt;$&lt;/span&gt; psql --host localhost --dbname http_observatory --username httpobsapi --password
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Install Python packages&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Create a new virtual environment&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; &lt;span class="nb"&gt;cd&lt;/span&gt; /apps/http-observatory 
&lt;span class="gp"&gt;$&lt;/span&gt; virtualenv PyEnv
&lt;span class="gp"&gt;$&lt;/span&gt; &lt;span class="nb"&gt;source&lt;/span&gt; PyEnv/bin/activate
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Install GCC&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo yum install -y gcc
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Install python module&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; pip install -r requirements.txt
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Redis&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Install Redis client and server&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo yum install -y redis
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Start Redis server&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl &lt;span class="nb"&gt;enable&lt;/span&gt; redis
&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl start redis
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Configure the system&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Add user&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo useradd -m httpobs
&lt;span class="gp"&gt;$&lt;/span&gt; sudo chown -R httpobs:httpobs /apps/http-observatory
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Create needed directories&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; mkdir /apps/http-observatory/log/
&lt;span class="gp"&gt;$&lt;/span&gt; mkdir /apps/http-observatory/run/
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Install HTTP Observatory&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Edit configuration&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; nano /apps/http-observatory/httpobs/conf/httpobs.conf
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;[global]&lt;/span&gt;
&lt;span class="na"&gt;development&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;no &lt;/span&gt;

&lt;span class="k"&gt;[api]&lt;/span&gt;
&lt;span class="na"&gt;cached_result_time&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;86400&lt;/span&gt;
&lt;span class="na"&gt;cooldown&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;180&lt;/span&gt;
&lt;span class="na"&gt;port&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;57001&lt;/span&gt;
&lt;span class="na"&gt;propagate_exceptions&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;no&lt;/span&gt;
&lt;span class="na"&gt;url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;http://observatory.intra/api/v1&lt;/span&gt;

&lt;span class="k"&gt;[database]&lt;/span&gt;
&lt;span class="na"&gt;database&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;http_observatory&lt;/span&gt;
&lt;span class="na"&gt;host&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;localhost&lt;/span&gt;
&lt;span class="na"&gt;pass&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;*********&lt;/span&gt;
&lt;span class="na"&gt;port&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;5432&lt;/span&gt;
&lt;span class="na"&gt;user&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;httpobsapi&lt;/span&gt;

&lt;span class="k"&gt;[retriever]&lt;/span&gt;
&lt;span class="na"&gt;connect_timeout&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;6.05&lt;/span&gt;
&lt;span class="na"&gt;cors_origin&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;http://observatory.intra&lt;/span&gt;
&lt;span class="na"&gt;read_timeout&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;30&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Start services&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Define environment variables for the Scanner&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; nano /apps/http-observatory/VarScanner.env
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;PYTHONPATH=$PYTHONPATH:/apps/http-observatory/
HTTPOBS_BROKER_URL=redis://localhost:6379/0
HTTPOBS_API_URL=http://localhost:57001/api/v1
HTTPOBS_MAX_CONCURRENCY=48
HTTPOBS_DATABASE_USER=httpobsscanner
HTTPOBS_DATABASE_PASS=********
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Create unit file for Celery&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /etc/systemd/system/httpobs-scan-worker-celery.service
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;[Unit]&lt;/span&gt;
&lt;span class="na"&gt;Description&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;CELERY for HTTP Observatory scan worker&lt;/span&gt;
&lt;span class="na"&gt;After&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;network.target auditd.service&lt;/span&gt;
&lt;span class="na"&gt;After&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;redis-server.service&lt;/span&gt;
&lt;span class="na"&gt;Before&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;httpobs-scan-worker.service&lt;/span&gt;
&lt;span class="na"&gt;Requires&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;redis.service&lt;/span&gt;

&lt;span class="k"&gt;[Service]&lt;/span&gt;
&lt;span class="na"&gt;WorkingDirectory&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;/apps/http-observatory&lt;/span&gt;
&lt;span class="na"&gt;RuntimeDirectory&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;httpobs&lt;/span&gt;
&lt;span class="na"&gt;EnvironmentFile&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;/apps/http-observatory/VarScanner.env&lt;/span&gt;
&lt;span class="na"&gt;ExecStart&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;/apps/http-observatory/PyEnv/bin/celery -A httpobs.scanner.tasks \&lt;/span&gt;
&lt;span class="s"&gt;                                                --broker=redis://localhost:6379/0 \&lt;/span&gt;
&lt;span class="s"&gt;                                                --autoscale=128,4 \&lt;/span&gt;
&lt;span class="s"&gt;                                                --hostname=scanner@%%h \&lt;/span&gt;
&lt;span class="s"&gt;                                                --loglevel=info \&lt;/span&gt;
&lt;span class="s"&gt;                                                --maxtasksperchild=1024 \&lt;/span&gt;
&lt;span class="s"&gt;                                                --pidfile=/apps/http-observatory/run/scanner.pid \&lt;/span&gt;
&lt;span class="s"&gt;                                                --logfile=/apps/http-observatory/log/scanner.log \&lt;/span&gt;
&lt;span class="s"&gt;                                                worker&lt;/span&gt;

&lt;span class="na"&gt;Restart&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;on-failure&lt;/span&gt;
&lt;span class="na"&gt;User&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;httpobs&lt;/span&gt;
&lt;span class="na"&gt;Group&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;httpobs&lt;/span&gt;

&lt;span class="k"&gt;[Install]&lt;/span&gt;
&lt;span class="na"&gt;WantedBy&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;multi-user.target&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Create unit file for Scanner&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /etc/systemd/system/httpobs-scan-worker.service
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;[Unit]&lt;/span&gt;
&lt;span class="na"&gt;Description&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;HTTP Observatory scan worker&lt;/span&gt;
&lt;span class="na"&gt;After&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;network.target auditd.service&lt;/span&gt;
&lt;span class="na"&gt;Requires&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;httpobs-scan-worker-celery.service&lt;/span&gt;

&lt;span class="k"&gt;[Service]&lt;/span&gt;
&lt;span class="na"&gt;WorkingDirectory&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;/apps/http-observatory&lt;/span&gt;
&lt;span class="na"&gt;EnvironmentFile&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;/apps/http-observatory/VarScanner.env&lt;/span&gt;
&lt;span class="na"&gt;ExecStart&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;/apps/http-observatory/PyEnv/bin/python3.4 /apps/http-observatory/httpobs/scanner/main.py &amp;gt;&amp;gt; /apps/http-observatory/log/scan-worker.log&lt;/span&gt;
&lt;span class="na"&gt;Restart&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;on-failure&lt;/span&gt;
&lt;span class="na"&gt;User&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;httpobs&lt;/span&gt;
&lt;span class="na"&gt;Group&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;httpobs&lt;/span&gt;

&lt;span class="k"&gt;[Install]&lt;/span&gt;
&lt;span class="na"&gt;WantedBy&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;multi-user.target&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Define environment variables for the API&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /apps/http-observatory/Variables_API.env
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;PYTHONPATH=$PYTHONPATH:/apps/http-observatory/
HTTPOBS_BROKER_URL=redis://localhost:6379/0
HTTPOBS_API_URL=http://localhost:57001/api/v1
HTTPOBS_MAX_CONCURRENCY=48
HTTPOBS_DATABASE_USER=httpobsapi
HTTPOBS_DATABASE_PASS=*******
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Create unit file for API&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /etc/systemd/system/httpobs-api.service
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;[Unit]&lt;/span&gt;
&lt;span class="na"&gt;Description&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;HTTP Observatory API&lt;/span&gt;
&lt;span class="na"&gt;After&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;network.target auditd.service&lt;/span&gt;

&lt;span class="k"&gt;[Service]&lt;/span&gt;
&lt;span class="na"&gt;WorkingDirectory&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;/apps/http-observatory&lt;/span&gt;
&lt;span class="na"&gt;EnvironmentFile&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;/apps/http-observatory/VarAPI.env&lt;/span&gt;
&lt;span class="na"&gt;ExecStart&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;/apps/http-observatory/PyEnv/bin/uwsgi \&lt;/span&gt;
&lt;span class="s"&gt;                 --http :57001 \&lt;/span&gt;
&lt;span class="s"&gt;                 --wsgi-file /opt/http-observatory/httpobs/website/main.py \&lt;/span&gt;
&lt;span class="s"&gt;                 --processes 8 \&lt;/span&gt;
&lt;span class="s"&gt;                 --callable app \&lt;/span&gt;
&lt;span class="s"&gt;                 --master \&lt;/span&gt;
&lt;span class="s"&gt;                 --logto /apps/http-observatory/log/api.log&lt;/span&gt;
&lt;span class="na"&gt;Restart&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;on-failure&lt;/span&gt;
&lt;span class="na"&gt;User&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;httpobs&lt;/span&gt;
&lt;span class="na"&gt;Group&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;httpobs&lt;/span&gt;
&lt;span class="na"&gt;KillSignal&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;SIGINT&lt;/span&gt;

&lt;span class="k"&gt;[Install]&lt;/span&gt;
&lt;span class="na"&gt;WantedBy&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;multi-user.target&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Start services&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl start httpobs-scan-worker-celery.service
&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl start httpobs-scan-worker.service
&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl start httpobs-api.service
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Enable services&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl &lt;span class="nb"&gt;enable&lt;/span&gt; httpobs-scan-worker-celery.service
&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl &lt;span class="nb"&gt;enable&lt;/span&gt; httpobs-scan-worker.service
&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl &lt;span class="nb"&gt;enable&lt;/span&gt; httpobs-api.service
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Test API&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Start a scan&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; curl http://observatory.intra:57001/api/v1/analyze?host&lt;span class="o"&gt;=&lt;/span&gt;www.hostname.com -X POST -v
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Get a report&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; curl http://observatory.intra:57001/api/v1/getScanResults?scan&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</content><category term="TLS"></category></entry><entry><title>How to install ZoneMinder on Debian</title><link href="http://didier.bernaudeau.net/ZoneMinder_Debian.html" rel="alternate"></link><published>2017-07-31T22:46:00+02:00</published><updated>2017-11-22T22:52:00+01:00</updated><author><name>Didier BERNAUDEAU</name></author><id>tag:didier.bernaudeau.net,2017-07-31:/ZoneMinder_Debian.html</id><summary type="html">&lt;p&gt;ZoneMinder is a free and open source CCTV (Closed-circuit television) software application which is suitable for building a DIY home video security system. So, this post describes how to install ZoneMinder on Debian to create your own DVR / NVR (Digital Video Recorder / Network Video Recorder).&lt;/p&gt;
</summary><content type="html">&lt;p&gt;ZoneMinder is a free and open source CCTV (Closed-circuit television) software application which is suitable for building a DIY home video security system. So, this post describes how to install ZoneMinder on Debian to create your own DVR / NVR (Digital Video Recorder / Network Video Recorder).&lt;/p&gt;

&lt;h1&gt;Firewall&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Incoming flow from Lan Interface&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;# Apache for ZoneMinder
sudo iptables -A INPUT -i $LanInterface -d $LanAddress -p tcp --dport 8080 -m conntrack --ctstate NEW,RELATED,ESTABLISHED -j ACCEPT

# Allow outgoing established connection
sudo iptables -A OUTPUT -o $LanInterface -s $LanAddress -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Outgoing flow to LAN&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;# Camera (RTSP) 
sudo iptables -A OUTPUT -o $LanInterface -s $LanAddress -d $LanNetwork -p tcp --dport 554 -m conntrack --ctstate NEW,RELATED,ESTABLISHED -j ACCEPT

# Allow incoming established connection
sudo iptables -A INPUT -i $LanInterface -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Database&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Install MariaDB&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo apt install php mariadb-server php-mysql apache2-mod-php7.0
&lt;span class="gp"&gt;$&lt;/span&gt; sudo mysql_secure_installation
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Configure MariaDB&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo rm /etc/mysql/my.cnf
&lt;span class="gp"&gt;$&lt;/span&gt; sudo cp /etc/mysql/mariadb.conf.d/50-server.cnf /etc/mysql/my.cnf
&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /etc/mysql/my.cnf
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;character-set-server = latin1
collation-server = latin1_swedish_ci
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Restart MariaDB&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl restart mariadb
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Zoneminder&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Add ZoneMinder repository&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /etc/apt/sources.list
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;deb&lt;/span&gt; &lt;span class="s"&gt;http://www.deb-multimedia.org&lt;/span&gt; &lt;span class="kp"&gt;stretch&lt;/span&gt; &lt;span class="kp"&gt;main&lt;/span&gt; &lt;span class="kp"&gt;non-free&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Update repository&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo apt-get update
&lt;span class="gp"&gt;$&lt;/span&gt; sudo apt-get install deb-multimedia-keyring
&lt;span class="gp"&gt;$&lt;/span&gt; sudo apt update
&lt;span class="gp"&gt;$&lt;/span&gt; sudo apt upgrade
&lt;span class="gp"&gt;$&lt;/span&gt; sudo apt dist-upgrade
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Install ZoneMinder&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo apt install zoneminder vlc-plugin-base
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Change access right&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo chmod &lt;span class="m"&gt;740&lt;/span&gt; /etc/zm/zm.conf
&lt;span class="gp"&gt;$&lt;/span&gt; sudo chown root:www-data /etc/zm/zm.conf
&lt;span class="gp"&gt;$&lt;/span&gt; sudo chown -R www-data:www-data /usr/share/zoneminder/
&lt;span class="gp"&gt;$&lt;/span&gt; sudo adduser www-data video
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Start ZoneMinder&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl &lt;span class="nb"&gt;enable&lt;/span&gt; zoneminder.service
&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl start zoneminder.service
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Apache&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Load module&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo a2enmod cgi
&lt;span class="gp"&gt;$&lt;/span&gt; sudo a2enmod rewrite
&lt;span class="gp"&gt;$&lt;/span&gt; sudo a2enconf zoneminder
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Configure PHP&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /etc/php/7.0/apache2/php.ini
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;date.timezone = Europe/Paris
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Change port&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /etc/apache2/ports.conf
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Listen 8080
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /etc/apache2/sites-enabled/000-default.conf
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;VirtualHost&lt;/span&gt; &lt;span class="err"&gt;*:8080&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
...
&lt;span class="nt"&gt;&amp;lt;/VirtualHost&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Restart Apache&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl restart apache2
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Open web browser on http://10.X.Y.Z:8080/zm&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;Configure ZoneMinder&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Add password for admin user&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Remove old event&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Filter name : DeleteOldEvents
Open : Event &amp;gt; Show filter windows
Date less than "-3days"
Delete all matches
Run in Background
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Camera Dlink DC932LB&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;General&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Source Type: Remote 
Function: Modec
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Source&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Remote protocol: http
Remote hostname: user:password@dcs-932lb.domain.net
Remote Host Path: /video.cgi
Capture Width (pixels): 640
Capture Height (pixels): 480
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Reverse Proxy with Nginx&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Install Nginx as TLS endpoint with Let's Encrypt (Published soon)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Install required tools&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo apt-get install nginx-extras fcgiwrap php7.0-fpm
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Configure PHP&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /etc/php/7.0/fpm/php.ini
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;cgi.fix_pathinfo = 0;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Check of PHP FPM is started&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl restart php7.0-fpm.service
&lt;span class="gp"&gt;$&lt;/span&gt; systemctl status php7.0-fpm.service 
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Stop zoneminder&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl stop zoneminder
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Create config file&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /etc/nginx/sites-available/default
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;location&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;camera&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;cgi-bin&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
      &lt;span class="err"&gt;gzip&lt;/span&gt; &lt;span class="err"&gt;off&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="err"&gt;root&lt;/span&gt; &lt;span class="err"&gt;/usr/lib&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

      &lt;span class="err"&gt;include&lt;/span&gt; &lt;span class="err"&gt;fastcgi_params&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="err"&gt;fastcgi_param&lt;/span&gt; &lt;span class="err"&gt;SCRIPT_FILENAME&lt;/span&gt; &lt;span class="err"&gt;/usr/lib/zoneminder/cgi-bin/nph-zms&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="err"&gt;fastcgi_intercept_errors&lt;/span&gt; &lt;span class="err"&gt;on&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="err"&gt;fastcgi_pass&lt;/span&gt; &lt;span class="n"&gt;unix&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;var&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;fcgiwrap&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="nt"&gt;location&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;camera&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
      &lt;span class="err"&gt;gzip&lt;/span&gt; &lt;span class="err"&gt;off&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="err"&gt;alias&lt;/span&gt; &lt;span class="err"&gt;/usr/share/zoneminder/www/&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="err"&gt;index&lt;/span&gt; &lt;span class="err"&gt;index.php&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

      &lt;span class="err"&gt;location&lt;/span&gt; &lt;span class="err"&gt;~&lt;/span&gt; &lt;span class="err"&gt;\.php$&lt;/span&gt; &lt;span class="err"&gt;{&lt;/span&gt;
         &lt;span class="err"&gt;include&lt;/span&gt; &lt;span class="err"&gt;fastcgi_params&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
         &lt;span class="err"&gt;fastcgi_param&lt;/span&gt; &lt;span class="err"&gt;SCRIPT_FILENAME&lt;/span&gt; &lt;span class="err"&gt;$request_filename&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
         &lt;span class="err"&gt;fastcgi_intercept_errors&lt;/span&gt; &lt;span class="err"&gt;on&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
         &lt;span class="err"&gt;fastcgi_pass&lt;/span&gt; &lt;span class="n"&gt;unix&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;var&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;php&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;php7&lt;/span&gt;&lt;span class="mf"&gt;.0&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;fpm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sock&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="p"&gt;}&lt;/span&gt;

      &lt;span class="nt"&gt;location&lt;/span&gt; &lt;span class="o"&gt;~*&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;camera&lt;/span&gt;&lt;span class="o"&gt;/.*&lt;/span&gt;&lt;span class="err"&gt;\&lt;/span&gt;&lt;span class="o"&gt;.(&lt;/span&gt;&lt;span class="nt"&gt;txt&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="nt"&gt;log&lt;/span&gt;&lt;span class="o"&gt;)$&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
         &lt;span class="err"&gt;deny&lt;/span&gt; &lt;span class="err"&gt;all&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="p"&gt;}&lt;/span&gt;

      &lt;span class="nt"&gt;location&lt;/span&gt; &lt;span class="o"&gt;~*&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;camera&lt;/span&gt;&lt;span class="o"&gt;/.*&lt;/span&gt;&lt;span class="err"&gt;\&lt;/span&gt;&lt;span class="o"&gt;.(&lt;/span&gt;&lt;span class="nt"&gt;m4a&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="nt"&gt;mp4&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="nt"&gt;mov&lt;/span&gt;&lt;span class="o"&gt;)$&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
         &lt;span class="err"&gt;mp4&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
         &lt;span class="err"&gt;mp4_buffer_size&lt;/span&gt; &lt;span class="err"&gt;5M&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
         &lt;span class="err"&gt;mp4_max_buffer_size&lt;/span&gt; &lt;span class="err"&gt;10M&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="err"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Restart nginx&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl restart nginx
&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl start zoneminder
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Configure ZoneMinder in "options / Paths" and set PATH_ZMS to "/camera/cgi-bin/nph-zms"&lt;/li&gt;
&lt;/ul&gt;</content><category term="Debian Stretch"></category></entry><entry><title>Install Debian on PC Engines APU3a4</title><link href="http://didier.bernaudeau.net/Install_Debian_on_APU.html" rel="alternate"></link><published>2017-07-30T10:25:00+02:00</published><updated>2017-07-30T10:25:00+02:00</updated><author><name>Didier BERNAUDEAU</name></author><id>tag:didier.bernaudeau.net,2017-07-30:/Install_Debian_on_APU.html</id><summary type="html">&lt;p&gt;This post describes a way to install Debian 9.1 on the APU3C4, a system board from PcEngines.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;This post describes a way to install Debian 9.1 on the APU3C4, a system board from PcEngines.&lt;/p&gt;

&lt;h1&gt;Create boot media&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Download Debian 9.1 for network installation&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; wget https://cdimage.debian.org/debian-cd/current/amd64/iso-cd/debian-9.1.0-amd64-netinst.iso
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Copy iso image on an USB flash drive&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; dd &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;debian-9.1.0-amd64-netinst.iso &lt;span class="nv"&gt;of&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;/dev/sdb &lt;span class="nv"&gt;bs&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;4k
&lt;span class="gp"&gt;#&lt;/span&gt; sync
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Boot the system board&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Plug the serial USB converter on the system board and on your computer&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Start serial interface&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; picocom --baud &lt;span class="m"&gt;115200&lt;/span&gt; --flow n --parity n --stopbits &lt;span class="m"&gt;1&lt;/span&gt; /dev/ttyUSB0
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Plug an Ethernet cable in LAN1 port&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Plug the USB flash drive on the system board&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Plug in and the system board is now power on&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Press F10 and select "USB MSC Drive  USB DISK 2.0 PMAP" in the boot menu&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Debian install menu appears&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p align="center"&gt;&lt;img class="img-responsive" src="images/2017-07-30_Install_Debian_on_APU_01.png" width="60%"/&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Press "tab" to edit the boot command and add "console=ttyS0,115200u8" to the end of the default boot command&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="go"&gt;/install.amd/vmlinuz vga=off initrd=/install.amd/gtk/initrd.gz --- quiet console=ttyS0,115200u8&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;/!\ Changing the "vga=788" to "vga=off" will speed up the boot as it won't stop complaining about not finding video mode.&lt;/p&gt;
&lt;h1&gt;Install Debian Linux&lt;/h1&gt;
&lt;!-- [![my_image](images/2017-07-30_Install_Debian_on_APU_02.png){:width=300px}](images/2017-07-30_Install_Debian_on_APU_02.png "Test"){class="mybox"} --&gt;
&lt;!-- [![my_image](images/2017-07-30_Install_Debian_on_APU_03.png){:width=300px}](images/2017-07-30_Install_Debian_on_APU_03.png "Test"){class="mybox"} --&gt;
&lt;p align="center"&gt;&lt;img class="img-responsive" src="images/2017-07-30_Install_Debian_on_APU_02.png" width="60%"/&gt;&lt;/p&gt;
&lt;p align="center"&gt;&lt;img class="img-responsive" src="images/2017-07-30_Install_Debian_on_APU_03.png" width="60%"/&gt;&lt;/p&gt;
&lt;p align="center"&gt;&lt;img class="img-responsive" src="images/2017-07-30_Install_Debian_on_APU_04.png" width="60%"/&gt;&lt;/p&gt;
&lt;p align="center"&gt;&lt;img class="img-responsive" src="images/2017-07-30_Install_Debian_on_APU_05.png" width="60%"/&gt;&lt;/p&gt;
&lt;p align="center"&gt;&lt;img class="img-responsive" src="images/2017-07-30_Install_Debian_on_APU_06.png" width="60%"/&gt;&lt;/p&gt;
&lt;p align="center"&gt;&lt;img class="img-responsive" src="images/2017-07-30_Install_Debian_on_APU_07.png" width="60%"/&gt;&lt;/p&gt;
&lt;p align="center"&gt;&lt;img class="img-responsive" src="images/2017-07-30_Install_Debian_on_APU_08.png" width="60%"/&gt;&lt;/p&gt;
&lt;p align="center"&gt;&lt;img class="img-responsive" src="images/2017-07-30_Install_Debian_on_APU_09.png" width="60%"/&gt;&lt;/p&gt;
&lt;p align="center"&gt;&lt;img class="img-responsive" src="images/2017-07-30_Install_Debian_on_APU_10.png" width="60%"/&gt;&lt;/p&gt;
&lt;p align="center"&gt;&lt;img class="img-responsive" src="images/2017-07-30_Install_Debian_on_APU_11.png" width="60%"/&gt;&lt;/p&gt;
&lt;p align="center"&gt;&lt;img class="img-responsive" src="images/2017-07-30_Install_Debian_on_APU_12.png" width="60%"/&gt;&lt;/p&gt;
&lt;p align="center"&gt;&lt;img class="img-responsive" src="images/2017-07-30_Install_Debian_on_APU_13.png" width="60%"/&gt;&lt;/p&gt;
&lt;p align="center"&gt;&lt;img class="img-responsive" src="images/2017-07-30_Install_Debian_on_APU_14.png" width="60%"/&gt;&lt;/p&gt;
&lt;p align="center"&gt;&lt;img class="img-responsive" src="images/2017-07-30_Install_Debian_on_APU_15.png" width="60%"/&gt;&lt;/p&gt;
&lt;p align="center"&gt;&lt;img class="img-responsive" src="images/2017-07-30_Install_Debian_on_APU_16.png" width="60%"/&gt;&lt;/p&gt;
&lt;p align="center"&gt;&lt;img class="img-responsive" src="images/2017-07-30_Install_Debian_on_APU_17.png" width="60%"/&gt;&lt;/p&gt;
&lt;p align="center"&gt;&lt;img class="img-responsive" src="images/2017-07-30_Install_Debian_on_APU_18.png" width="60%"/&gt;&lt;/p&gt;
&lt;p align="center"&gt;&lt;img class="img-responsive" src="images/2017-07-30_Install_Debian_on_APU_19.png" width="60%"/&gt;&lt;/p&gt;
&lt;p align="center"&gt;&lt;img class="img-responsive" src="images/2017-07-30_Install_Debian_on_APU_20.png" width="60%"/&gt;&lt;/p&gt;
&lt;p align="center"&gt;&lt;img class="img-responsive" src="images/2017-07-30_Install_Debian_on_APU_21.png" width="60%"/&gt;&lt;/p&gt;
&lt;p align="center"&gt;&lt;img class="img-responsive" src="images/2017-07-30_Install_Debian_on_APU_22.png" width="60%"/&gt;&lt;/p&gt;
&lt;p align="center"&gt;&lt;img class="img-responsive" src="images/2017-07-30_Install_Debian_on_APU_23.png" width="60%"/&gt;&lt;/p&gt;
&lt;p align="center"&gt;&lt;img class="img-responsive" src="images/2017-07-30_Install_Debian_on_APU_24.png" width="60%"/&gt;&lt;/p&gt;
&lt;p align="center"&gt;&lt;img class="img-responsive" src="images/2017-07-30_Install_Debian_on_APU_25.png" width="60%"/&gt;&lt;/p&gt;
&lt;p align="center"&gt;&lt;img class="img-responsive" src="images/2017-07-30_Install_Debian_on_APU_26.png" width="60%"/&gt;&lt;/p&gt;
&lt;p align="center"&gt;&lt;img class="img-responsive" src="images/2017-07-30_Install_Debian_on_APU_27.png" width="60%"/&gt;&lt;/p&gt;
&lt;p align="center"&gt;&lt;img class="img-responsive" src="images/2017-07-30_Install_Debian_on_APU_28.png" width="60%"/&gt;&lt;/p&gt;
&lt;h1&gt;Custom the system&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Install sudo&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; apt-get install -y sudo
&lt;span class="gp"&gt;#&lt;/span&gt; adduser UserName sudo
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Install sensors&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo apt-get install -y lm-sensors
&lt;span class="gp"&gt;$&lt;/span&gt; sudo sensors-detect
&lt;span class="gp"&gt;$&lt;/span&gt; sensors
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;k10temp-pci-00c3
Adapter: PCI adapter
temp1:        +58.8°C  (high = +70.0°C)
                       (crit = +105.0°C, hyst = +104.0°C)

fam15h_power-pci-00c4
Adapter: PCI adapter
power1:        1.82 mW (interval =   0.01 s, crit =   6.00 W)
&lt;/pre&gt;&lt;/div&gt;
&lt;!-- http://pcengines.info/forums/?page=post&amp;id=51C5DE97-2D0E-40E9-BFF7-7F7FE30E18FE --&gt;</content><category term="APU"></category><category term="Debian Stretch"></category></entry><entry><title>How to install Postgresql on RedHat</title><link href="http://didier.bernaudeau.net/HowTo_Install_Postgresql_On_RedHat.html" rel="alternate"></link><published>2017-07-29T21:51:00+02:00</published><updated>2017-10-17T22:24:00+02:00</updated><author><name>Didier BERNAUDEAU</name></author><id>tag:didier.bernaudeau.net,2017-07-29:/HowTo_Install_Postgresql_On_RedHat.html</id><summary type="html">&lt;p&gt;By default, RedHat Linux Enterprise provides python 9.1 only. This post is a way to install Postgresql 9.6 on RedHat 7.3.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;By default, RedHat Linux Enterprise provides python 9.1 only. This post is a way to install Postgresql 9.6 on RedHat 7.3.&lt;/p&gt;

&lt;h1&gt;Installation&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Add the Postgresql repository&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; curl -O https://download.postgresql.org/pub/repos/yum/9.6/redhat/rhel-7-x86_64/pgdg-redhat96-9.6-3.noarch.rpm
&lt;span class="gp"&gt;$&lt;/span&gt; sudo yum install pgdg-redhat96-9.6-3.noarch.rpm
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Install the client and server packages&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo yum install -y postgresql96 postgresql96-server
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Initialize the database&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo /usr/pgsql-9.6/bin/postgresql96-setup initdb
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Enable automatic start&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl &lt;span class="nb"&gt;enable&lt;/span&gt; postgresql-9.6
&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl start postgresql-9.6
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Remote access&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Enable networking&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /var/lib/pgsql/9.6/data/postgresql.conf
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;listen_addresses='*'
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Enable client authentication&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /var/lib/pgsql/9.6/data/pg_hba.conf
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;host all all W.X.Y.Z/32 md5
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Restart Postgresql&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl restart postgresql-9.6
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Check&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo netstat -tlnp &lt;span class="p"&gt;|&lt;/span&gt; grep &lt;span class="m"&gt;5432&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Logging&lt;/h1&gt;
&lt;p&gt;The following step is for debugging purpose only.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Edit configuration&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /var/lib/pgsql/9.6/data/postgresql.conf
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;log_directory = 'pg_log'
log_filename = 'postgresql-%a.log'
log_statement = 'all'
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Restart Postgresql&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl restart postgresql-9.6
&lt;/pre&gt;&lt;/div&gt;
&lt;!-- Source: https://www.postgresql.org/download/linux/redhat/ --&gt;</content><category term="RedHat"></category><category term="Database"></category></entry><entry><title>How to install python on RedHat</title><link href="http://didier.bernaudeau.net/HowTo_Install_Python_On_RedHat.html" rel="alternate"></link><published>2017-07-29T21:26:00+02:00</published><updated>2017-07-29T21:26:00+02:00</updated><author><name>Didier BERNAUDEAU</name></author><id>tag:didier.bernaudeau.net,2017-07-29:/HowTo_Install_Python_On_RedHat.html</id><summary type="html">&lt;p&gt;By default, RedHat Linux Enterprise provides python 2.7 only. This post is a way to install python 3.4 on RedHat.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;By default, RedHat Linux Enterprise provides python 2.7 only. This post is a way to install python 3.4 on RedHat.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Install Python 3.4 and tools from RHEL repository&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo yum install -y python34 python34-devel python34-pip python-pip python-wheel
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Create a group of alternatives for python&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo alternatives --install /usr/bin/python python /usr/bin/python3.4 &lt;span class="m"&gt;2&lt;/span&gt;
&lt;span class="gp"&gt;$&lt;/span&gt; sudo alternatives --install /usr/bin/python python /usr/bin/python2.7 &lt;span class="m"&gt;1&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Select python 3.4&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo alternatives --config python
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Install additional tools from Pypi&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo -H pip3 install virtualenv wheel
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Allow access to python packages for all users&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo chmod o+rX -R /usr/lib/python3.4/site-packages
&lt;span class="gp"&gt;$&lt;/span&gt; sudo chmod o+rX -R /usr/lib64/python3.4/site-packages
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;/!\ Yum command line needs python 2.7.&lt;/p&gt;</content><category term="RedHat"></category><category term="Python"></category></entry><entry><title>Flask</title><link href="http://didier.bernaudeau.net/Flask.html" rel="alternate"></link><published>2017-07-17T22:18:00+02:00</published><updated>2017-07-17T22:18:00+02:00</updated><author><name>Didier BERNAUDEAU</name></author><id>tag:didier.bernaudeau.net,2017-07-17:/Flask.html</id><summary type="html">&lt;p&gt;Flask is a light and simple framework for bulding RESTfull API with Python. This post is based on the official &lt;a href="http://flask-restful.readthedocs.io/en/0.3.5/quickstart.html"&gt;quickstart guide&lt;/a&gt; and describes how to create an API with Flask.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;Flask is a light and simple framework for bulding RESTfull API with Python. This post is based on the official &lt;a href="http://flask-restful.readthedocs.io/en/0.3.5/quickstart.html"&gt;quickstart guide&lt;/a&gt; and describes how to create an API with Flask.&lt;/p&gt;

&lt;h1&gt;Create the application&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Create a virtualenv to isolate our package dependencies locally&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; virtualenv &lt;span class="nb"&gt;test&lt;/span&gt;
&lt;span class="gp"&gt;$&lt;/span&gt; &lt;span class="nb"&gt;source&lt;/span&gt; test/bin/activate
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Install Flask framework into the virtualenv&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; pip install Flask Flask-RESTful
&lt;span class="gp"&gt;$&lt;/span&gt; pip freeze &amp;gt; requirements.txt
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Copy this example in "api.py"&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;flask&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Flask&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;flask_restful&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;reqparse&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;abort&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Api&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Resource&lt;/span&gt;

&lt;span class="n"&gt;app&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Flask&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="vm"&gt;__name__&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;api&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Api&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;app&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;TODOS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="s1"&gt;'todo1'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;'task'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'build an API'&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt;
    &lt;span class="s1"&gt;'todo2'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;'task'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'?????'&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt;
    &lt;span class="s1"&gt;'todo3'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;'task'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'profit!'&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;


&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;abort_if_todo_doesnt_exist&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;todo_id&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;todo_id&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;TODOS&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;abort&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;404&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;message&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"Todo {} doesn't exist"&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;todo_id&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

&lt;span class="n"&gt;parser&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;reqparse&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;RequestParser&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;parser&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_argument&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'task'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;


&lt;span class="c1"&gt;# Todo&lt;/span&gt;
&lt;span class="c1"&gt;# shows a single todo item and lets you delete a todo item&lt;/span&gt;
&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Todo&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Resource&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;todo_id&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;abort_if_todo_doesnt_exist&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;todo_id&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;TODOS&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;todo_id&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;delete&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;todo_id&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;abort_if_todo_doesnt_exist&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;todo_id&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;del&lt;/span&gt; &lt;span class="n"&gt;TODOS&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;todo_id&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s1"&gt;''&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;204&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;put&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;todo_id&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;args&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;parser&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;parse_args&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="n"&gt;task&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;'task'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'task'&lt;/span&gt;&lt;span class="p"&gt;]}&lt;/span&gt;
        &lt;span class="n"&gt;TODOS&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;todo_id&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;task&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;task&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;201&lt;/span&gt;


&lt;span class="c1"&gt;# TodoList&lt;/span&gt;
&lt;span class="c1"&gt;# shows a list of all todos, and lets you POST to add new tasks&lt;/span&gt;
&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;TodoList&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Resource&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;TODOS&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;post&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;args&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;parser&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;parse_args&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="n"&gt;todo_id&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;max&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;TODOS&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;keys&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;lstrip&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'todo'&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
        &lt;span class="n"&gt;todo_id&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'todo&lt;/span&gt;&lt;span class="si"&gt;%i&lt;/span&gt;&lt;span class="s1"&gt;'&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;todo_id&lt;/span&gt;
        &lt;span class="n"&gt;TODOS&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;todo_id&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;'task'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'task'&lt;/span&gt;&lt;span class="p"&gt;]}&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;TODOS&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;todo_id&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="mi"&gt;201&lt;/span&gt;

&lt;span class="c1"&gt;##&lt;/span&gt;
&lt;span class="c1"&gt;## Actually setup the Api resource routing here&lt;/span&gt;
&lt;span class="c1"&gt;##&lt;/span&gt;
&lt;span class="n"&gt;api&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_resource&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;TodoList&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'/todos'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;api&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_resource&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Todo&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'/todos/&amp;lt;todo_id&amp;gt;'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;


&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s1"&gt;'__main__'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;app&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;debug&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Run&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; python api.py
&lt;span class="go"&gt; * Running on http://127.0.0.1:5000/&lt;/span&gt;
&lt;span class="go"&gt; * Restarting with reloader&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Testing&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Get the list&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; curl http://localhost:5000/todos
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Add a new task&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; curl http://localhost:5000/todos -d &lt;span class="s2"&gt;"task=something new"&lt;/span&gt; -X POST -v
&lt;/pre&gt;&lt;/div&gt;</content><category term="Python"></category></entry><entry><title>DRF (Django Rest Framework)</title><link href="http://didier.bernaudeau.net/DRF_DjangoRestFramework.html" rel="alternate"></link><published>2017-07-16T20:35:00+02:00</published><updated>2017-07-17T21:31:00+02:00</updated><author><name>Didier BERNAUDEAU</name></author><id>tag:didier.bernaudeau.net,2017-07-16:/DRF_DjangoRestFramework.html</id><summary type="html">&lt;p&gt;DRF (Django Rest Framework) is an extension for Django to quickly develop a REST API. This post contains only some personals notes to create a first REST API with DRF. This post is based on the official &lt;a href="http://www.django-rest-framework.org/tutorial/quickstart/"&gt;quickstart guide&lt;/a&gt;.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;DRF (Django Rest Framework) is an extension for Django to quickly develop a REST API. This post contains only some personals notes to create a first REST API with DRF. This post is based on the official &lt;a href="http://www.django-rest-framework.org/tutorial/quickstart/"&gt;quickstart guide&lt;/a&gt;.&lt;/p&gt;

&lt;h1&gt;Configure Python on Gentoo Linux&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Add sqlite support&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; nano /etc/portage/package.use
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;dev-lang/python:3.4             sqlite
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Emerge Python with the new flag&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; emerge --oneshot dev-lang/python:3.4
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Install virtualenv tool&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; emerge dev-python/virtualenv
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Create the REST API&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Create the project directory&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; mkdir tutorial
&lt;span class="gp"&gt;$&lt;/span&gt; &lt;span class="nb"&gt;cd&lt;/span&gt; tutorial
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Create a virtualenv to isolate our package dependencies locally&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; virtualenv env
&lt;span class="gp"&gt;$&lt;/span&gt; &lt;span class="nb"&gt;source&lt;/span&gt; env/bin/activate
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Install Django and Django REST framework into the virtualenv&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; pip install django
&lt;span class="gp"&gt;$&lt;/span&gt; pip install djangorestframework
&lt;span class="gp"&gt;$&lt;/span&gt; pip freeze &amp;gt; requirements.txt
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Set up a new project with a single application&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; django-admin.py startproject tutorial .
&lt;span class="gp"&gt;$&lt;/span&gt; &lt;span class="nb"&gt;cd&lt;/span&gt; tutorial
&lt;span class="gp"&gt;$&lt;/span&gt; django-admin.py startapp quickstart
&lt;span class="gp"&gt;$&lt;/span&gt; &lt;span class="nb"&gt;cd&lt;/span&gt; ..
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Now sync your database for the first time:&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; python manage.py migrate
&lt;span class="gp"&gt;$&lt;/span&gt; python manage.py createsuperuser
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Create Serializers&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; nano tutorial/quickstart/serializers.py
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.contrib.auth.models&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;User&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Group&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;rest_framework&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;serializers&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;UserSerializer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;serializers&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;HyperlinkedModelSerializer&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Meta&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;model&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;User&lt;/span&gt;
        &lt;span class="n"&gt;fields&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'url'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'username'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'email'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'groups'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;GroupSerializer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;serializers&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;HyperlinkedModelSerializer&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Meta&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;model&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Group&lt;/span&gt;
        &lt;span class="n"&gt;fields&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'url'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'name'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Create Views&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; nano tutorial/quickstart/views.py
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.contrib.auth.models&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;User&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Group&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;rest_framework&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;viewsets&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;tutorial.quickstart.serializers&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;UserSerializer&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;GroupSerializer&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;UserViewSet&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;viewsets&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ModelViewSet&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="sd"&gt;"""&lt;/span&gt;
&lt;span class="sd"&gt;    API endpoint that allows users to be viewed or edited.&lt;/span&gt;
&lt;span class="sd"&gt;    """&lt;/span&gt;
    &lt;span class="n"&gt;queryset&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;User&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;all&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;order_by&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'-date_joined'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;serializer_class&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;UserSerializer&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;GroupViewSet&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;viewsets&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ModelViewSet&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="sd"&gt;"""&lt;/span&gt;
&lt;span class="sd"&gt;    API endpoint that allows groups to be viewed or edited.&lt;/span&gt;
&lt;span class="sd"&gt;    """&lt;/span&gt;
    &lt;span class="n"&gt;queryset&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Group&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;all&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;serializer_class&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;GroupSerializer&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Create URLs&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; nano tutorial/urls.py
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.conf.urls&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;include&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;rest_framework&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;routers&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;tutorial.quickstart&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;views&lt;/span&gt;

&lt;span class="n"&gt;router&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;routers&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DefaultRouter&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;router&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;register&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s1"&gt;'users'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;views&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;UserViewSet&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;router&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;register&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s1"&gt;'groups'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;views&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GroupViewSet&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# Wire up our API using automatic URL routing.&lt;/span&gt;
&lt;span class="c1"&gt;# Additionally, we include login URLs for the browsable API.&lt;/span&gt;
&lt;span class="n"&gt;urlpatterns&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
    &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s1"&gt;'^'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;include&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;router&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;urls&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;
    &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s1"&gt;'^api-auth/'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;include&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'rest_framework.urls'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;namespace&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'rest_framework'&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Settings&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; nano tutorial/settings.py
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;INSTALLED_APPS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="o"&gt;...&lt;/span&gt;
    &lt;span class="s1"&gt;'rest_framework'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;REST_FRAMEWORK&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="s1"&gt;'DEFAULT_PERMISSION_CLASSES'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
        &lt;span class="s1"&gt;'rest_framework.permissions.IsAdminUser'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="p"&gt;],&lt;/span&gt;
    &lt;span class="s1"&gt;'PAGE_SIZE'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Run server&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; python manage.py runserver
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Test with curl&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; curl -H &lt;span class="s1"&gt;'Accept: application/json; indent=4'&lt;/span&gt; -u user:******** http://127.0.0.1:8000/users/
&lt;/pre&gt;&lt;/div&gt;</content><category term="Python"></category></entry><entry><title>How to install Raspbian on a Raspberry Pi</title><link href="http://didier.bernaudeau.net/HowToInstallRaspbianOnRaspberryPi.html" rel="alternate"></link><published>2017-06-24T22:19:00+02:00</published><updated>2017-06-26T21:59:00+02:00</updated><author><name>Didier BERNAUDEAU</name></author><id>tag:didier.bernaudeau.net,2017-06-24:/HowToInstallRaspbianOnRaspberryPi.html</id><summary type="html">&lt;p&gt;Raspbian is the main operating system for a Raspberry Pi. This post is a guideline to install and configure Raspbian Stretch Lite (based on Debian 9 without desktop environment).&lt;/p&gt;
</summary><content type="html">&lt;p&gt;Raspbian is the main operating system for a Raspberry Pi. This post is a guideline to install and configure Raspbian Stretch Lite (based on Debian 9 without desktop environment).&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Note regarding SD Card:&lt;/strong&gt;
Most of the time you won’t see or have any incidences because SD corruption is not really simple to detect. Sometime it works and sometimes Pi is crashing/blocking and you don’t know why. So, it's better to protect your SD cards from unproper shutdown and also prevent SD card premature end of life.
So, this tutorial suggests some optimization to reduce write access to the SD card.&lt;/p&gt;
&lt;h1&gt;Getting started&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Download the last version of Raspbian (Stretch / Release date 2017-09-07)&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; wget https://downloads.raspberrypi.org/raspbian_lite_latest
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Uncompress file&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; unzip &lt;span class="m"&gt;2017&lt;/span&gt;-09-07-raspbian-stretch-lite.zip
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Copy files on the SD card&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; dd &lt;span class="nv"&gt;bs&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;4M &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;2017&lt;/span&gt;-09-07-raspbian-stretch-lite.img &lt;span class="nv"&gt;of&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;/dev/mmcblk0 &lt;span class="nv"&gt;status&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;progress
&lt;span class="gp"&gt;#&lt;/span&gt; sync
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Enable SSH server&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; mkdir /mnt/tmp
&lt;span class="gp"&gt;#&lt;/span&gt; mount /dev/mmcblk0p1 /mnt/tmp
&lt;span class="gp"&gt;#&lt;/span&gt; touch /mnt/tmp/ssh
&lt;span class="gp"&gt;#&lt;/span&gt; umount /mnt/tmp
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Insert the SD card in the Raspberry Pi&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Plug in ethernet cable and power supply&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Connect to your Raspberry by using SSH &lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; ssh pi@raspberrypi.domain.net
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;*&lt;em&gt;/!*&lt;/em&gt; the default password is "raspberry".&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Change default password&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; passwd
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Update the system&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo apt-get update &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; sudo apt-get upgrade
&lt;span class="gp"&gt;$&lt;/span&gt; sudo apt autoremove
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Basic system configuration&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Open the configuration menu&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo raspi-config
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Change keyboard layout&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;4 Localisation Options
I3 Change keyboard layout
Type: Generic 105-key
Country: French
Layout: French - French (Azerty)
Key to function as AltGr: The default for the keyboard layout
Compose key: no compose key
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Change hostname&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;2 Network Option
N1 Hostname
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Define Time Zone&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;4 Localisation Options
I2 Change Timezone
Geographic area: Europe
Time zone: Paris
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Change wifi country&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;4 Localisation Options
I4 Change Wifi country
Country: FR France
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Expand Filesystem&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;7 Advanced Options
A1 Expand Filesystem
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Then select "finish" and reboot your Raspberry.&lt;/p&gt;
&lt;h1&gt;Time synchronization with systemd&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Configure TimeSync&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /etc/systemd/timesyncd.conf
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;NTP=g8way.domain.net
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Restart TimeSync daemon&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl restart systemd-timesyncd.service
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Check&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl status systemd-timesyncd.service
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;●&lt;/span&gt; &lt;span class="nt"&gt;systemd-timesyncd&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;service&lt;/span&gt; &lt;span class="nt"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;Network&lt;/span&gt; &lt;span class="nt"&gt;Time&lt;/span&gt; &lt;span class="nt"&gt;Synchronization&lt;/span&gt;
   &lt;span class="nt"&gt;Loaded&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;loaded&lt;/span&gt; &lt;span class="o"&gt;(/&lt;/span&gt;&lt;span class="nt"&gt;lib&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;systemd&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;system&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;systemd-timesyncd&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;service&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="nt"&gt;enabled&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="nt"&gt;vendor&lt;/span&gt; &lt;span class="nt"&gt;preset&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;enabled&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
  &lt;span class="nt"&gt;Drop-In&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;lib&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;systemd&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;system&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;systemd-timesyncd&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;service&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;d&lt;/span&gt;
           &lt;span class="err"&gt;└─&lt;/span&gt;&lt;span class="nt"&gt;disable-with-time-daemon&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;conf&lt;/span&gt;
   &lt;span class="nt"&gt;Active&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;active&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;running&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="nt"&gt;since&lt;/span&gt; &lt;span class="nt"&gt;Thu&lt;/span&gt; &lt;span class="nt"&gt;2017-09-07&lt;/span&gt; &lt;span class="nt"&gt;18&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;15&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;46&lt;/span&gt; &lt;span class="nt"&gt;CEST&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="nt"&gt;2&lt;/span&gt; &lt;span class="nt"&gt;months&lt;/span&gt; &lt;span class="nt"&gt;2&lt;/span&gt; &lt;span class="nt"&gt;days&lt;/span&gt; &lt;span class="nt"&gt;ago&lt;/span&gt;
     &lt;span class="nt"&gt;Docs&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;man&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;systemd-timesyncd&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;service&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;8&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
 &lt;span class="nt"&gt;Main&lt;/span&gt; &lt;span class="nt"&gt;PID&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;539&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;systemd-timesyn&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
   &lt;span class="nt"&gt;Status&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;"Synchronized to time server 10.XXX.3.254:123 (g8way.domain.net)."&lt;/span&gt;
   &lt;span class="nt"&gt;CGroup&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;system&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;slice&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;systemd-timesyncd&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;service&lt;/span&gt;
           &lt;span class="err"&gt;└─&lt;/span&gt;&lt;span class="nt"&gt;539&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;lib&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;systemd&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;systemd-timesyncd&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; timedatectl
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;      Local time: Thu 2017-11-09 17:19:20 CET
  Universal time: Thu 2017-11-09 16:19:20 UTC
        RTC time: n/a
       Time zone: Europe/Paris (CET, +0100)
 Network time on: yes
NTP synchronized: yes
 RTC in local TZ: no
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Disable swap&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Disable swapping &lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo swapoff /var/swap
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Disable the control swapping daemon&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl stop dphys-swapfile
&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl disable dphys-swapfile
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Uninstall the control swapping tool&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo apt-get remove --purge dphys-swapfile
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Remove swap file&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo rm /var/swap
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Configure kernel option (add noswap)&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /boot/cmdline.txt
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;dwc_otg.lpm_enable=0 console=serial0,115200 console=tty1 root=PARTUUID=749d10b0-02 rootfstype=ext4 elevator=deadline fsck.repair=yes rootwait noswap
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Configure the WiFi&lt;/h1&gt;
&lt;h2&gt;Through Raspi-config&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;N2 Wi-fi
SSID: **********
Passphrase: **********
&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;Through file system&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo wpa_passphrase SSID
&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /etc/wpa_supplicant/wpa_supplicant.conf
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;network={
        ssid="SSID"
        #psk="MySecret"
        psk=4baa71a05efba1dfa9af4aa162f5a67b7c9d9aae5c3bac92e5ed540b0c3f0332
}
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Install additional packages&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Install PyGPIO&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo apt-get install RPi.GPIO
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Install &lt;a href="http://didier.bernaudeau.net/WiringPi.html"&gt;WiringPI&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo apt-get install Wiringpi
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Install Java&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo apt-get install openjdk-8-jre
&lt;/pre&gt;&lt;/div&gt;</content><category term="Raspbian"></category><category term="Raspberry Pi"></category></entry><entry><title>Create your first presentation with RevealJS</title><link href="http://didier.bernaudeau.net/Create_your_first_presentation_with_RevealJS.html" rel="alternate"></link><published>2017-05-22T20:10:00+02:00</published><updated>2018-02-26T09:32:00+01:00</updated><author><name>Didier BERNAUDEAU</name></author><id>tag:didier.bernaudeau.net,2017-05-22:/Create_your_first_presentation_with_RevealJS.html</id><summary type="html">&lt;p&gt;RevealJS is a powerful framework for creating a modern and beautiful presentation in HTML5/JS/CSS. This post descirbes how to install RevealJS then how to make your first presentation.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;RevealJS is a powerful framework for creating a modern and beautiful presentation in HTML5/JS/CSS. This post descirbes how to install RevealJS then how to make your first presentation.&lt;/p&gt;

&lt;h1&gt;Install needed software&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Install nodeJS&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; emerge nodejs
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Install RevealJS&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; npm i node-reveal -g
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Create a presentation&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Init a new presentation&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; reveal -i &amp;lt;project_name&amp;gt;
&lt;span class="gp"&gt;$&lt;/span&gt; &lt;span class="nb"&gt;cd&lt;/span&gt; &amp;lt;project_name&amp;gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Edit index.html file to add content&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Start server in watch mode&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; reveal -w
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Then, open your browser :&lt;ul&gt;
&lt;li&gt;Multiplex presentation: &lt;a href="http://localhost:3000/?role=master#/"&gt;http://localhost:3000/?role=master#/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Export presentation: &lt;a href="http://localhost:3000/?print-pdf#/"&gt;http://localhost:3000/?print-pdf#/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;Customize your presentation&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;First slide&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;style&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
      &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;FirstSlides&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
          &lt;span class="k"&gt;width&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;1280&lt;/span&gt;&lt;span class="kt"&gt;px&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
          &lt;span class="k"&gt;height&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;720&lt;/span&gt;&lt;span class="kt"&gt;px&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="p"&gt;}&lt;/span&gt;
      &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;Title&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;position&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="kc"&gt;absolute&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;right&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="kt"&gt;%&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;width&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="kt"&gt;%&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;top&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="kt"&gt;%&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;background-color&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nb"&gt;rgba&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;46&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;89&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;82&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="k"&gt;text-align&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="kc"&gt;right&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;style&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
...
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;section&lt;/span&gt; &lt;span class="na"&gt;data-state&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"header1"&lt;/span&gt; &lt;span class="na"&gt;data-background&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"img/background.jpg"&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
          &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"FirstSlides"&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
            &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"Title"&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
              &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;h1&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Title&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;h1&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
              &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;h4&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Month Day&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;span&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"ordinal"&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;th&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;span&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;, 2017&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;h4&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
              &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;p&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;small&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;By NAME&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;small&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;p&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
            &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
          &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;section&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Slide configuration&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;      Reveal.initialize({
        history: true,
        slideNumber: true,
        width: 1280,
        height: 720,
      }
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Two column layout&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;section&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
  &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt; &lt;span class="na"&gt;style&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"text-align: left; float: left; width:50%;"&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="c"&gt;&amp;lt;!-- if necessary, change text-align --&amp;gt;&lt;/span&gt;
  &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;

  &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt; &lt;span class="na"&gt;style&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"text-align: right; float: right; width:50%;"&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="c"&gt;&amp;lt;!-- if necessary, change text-align --&amp;gt;&lt;/span&gt;
  &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;section&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Insert image&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;  &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;img&lt;/span&gt; &lt;span class="na"&gt;src&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"img.png"&lt;/span&gt; &lt;span class="na"&gt;style&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"width:50%; border:0px;"&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Speaker notes&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;aside&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"notes"&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
  notes...
&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;aside&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Fragment event&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;p&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"fragment fade-in"&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Text&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;p&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Troubleshooting&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; reveal -i project_name

&lt;span class="go"&gt;fs.js:968&lt;/span&gt;
&lt;span class="go"&gt;  binding.stat(pathModule.toNamespacedPath(path));&lt;/span&gt;
&lt;span class="go"&gt;          ^&lt;/span&gt;

&lt;span class="go"&gt;Error: ENOENT: no such file or directory, stat '/usr/local/share/.config/yarn/global/node_modules/node-reveal/reveal.js'&lt;/span&gt;
&lt;span class="go"&gt;    at Object.fs.statSync (fs.js:968:11)&lt;/span&gt;
&lt;span class="go"&gt;    at Object.statSync (/usr/local/share/.config/yarn/global/node_modules/graceful-fs/polyfills.js:297:22)&lt;/span&gt;
&lt;span class="go"&gt;    at copySync (/usr/local/share/.config/yarn/global/node_modules/fs-extra/lib/copy-sync/copy-sync.js:31:86)&lt;/span&gt;
&lt;span class="go"&gt;    at init (/usr/local/share/.config/yarn/global/node_modules/node-reveal/src/handler.js:42:3)&lt;/span&gt;
&lt;span class="go"&gt;    at module.exports (/usr/local/share/.config/yarn/global/node_modules/node-reveal/src/handler.js:65:3)&lt;/span&gt;
&lt;span class="go"&gt;    at Object.&amp;lt;anonymous&amp;gt; (/usr/local/share/.config/yarn/global/node_modules/node-reveal/index.js:30:1)&lt;/span&gt;
&lt;span class="go"&gt;    at Module._compile (module.js:660:30)&lt;/span&gt;
&lt;span class="go"&gt;    at Object.Module._extensions..js (module.js:671:10)&lt;/span&gt;
&lt;span class="go"&gt;    at Module.load (module.js:573:32)&lt;/span&gt;
&lt;span class="go"&gt;    at tryModuleLoad (module.js:513:12)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;!--Source:
https://www.npmjs.com/package/node-reveal
http://htmlcheats.com/reveal-js/reveal-js-tutorial-reveal-js-for-beginners/
http://www.bortzmeyer.org/reveal-js.html
http://lab.hakim.se/reveal-js/#/
--&gt;</content><category term="Development"></category><category term="JavaScript"></category></entry><entry><title>Update GCC on Gentoo Linux</title><link href="http://didier.bernaudeau.net/Update_GCC_on_Gentoo_Linux.html" rel="alternate"></link><published>2017-05-21T10:37:00+02:00</published><updated>2017-05-21T10:37:00+02:00</updated><author><name>Didier BERNAUDEAU</name></author><id>tag:didier.bernaudeau.net,2017-05-21:/Update_GCC_on_Gentoo_Linux.html</id><summary type="html">&lt;p&gt;GCC, the GNU Compiler Collection, is an essential tool on Gentoo Linux to compile, build then install packages. This post is a quick reminder to update GGC, a sensitive operation on Gentoo.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;GCC, the GNU Compiler Collection, is an essential tool on Gentoo Linux to compile, build then install packages. This post is a quick reminder to update GGC, a sensitive operation on Gentoo.&lt;/p&gt;

&lt;h1&gt;Update GCC&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Install the last version&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; emerge -u sys-devel/gcc
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Print installed version of GCC&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; gcc-config --list-profiles
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[1] x86_64-pc-linux-gnu-4.9.4 *
[2] x86_64-pc-linux-gnu-5.4.0
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Switch compiler version &lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; gcc-config &lt;span class="m"&gt;2&lt;/span&gt;
&lt;span class="gp"&gt;#&lt;/span&gt; env-update &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="nb"&gt;source&lt;/span&gt; /etc/profile
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Common compilation errors&lt;/h1&gt;
&lt;p&gt;After GCC update, the ABI uses for binary applications and libraries is changed. You will risk getting linker errors or malfunctioning programs unless you rebuild all libraries that use C++ code.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;cmis_repo_content.cxx:(.text+0x4bb7): undefined reference to `libcmis::Repository::getId[abi:cxx11]() const'
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;or&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;/usr/include/xapian/version.h:32:2: warning: #warning The Xapian library was built with g++ 4.9.4 [-Wcpp]
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Rebuild&lt;/h1&gt;
&lt;p&gt;Some people swear that they need to rebuild every single package on their system when a new GCC version is made available. Of course, that doesn't make sense, since there are many applications that are not using GCC for their build and install process anyhow, so they would never be affected by such changes.&lt;/p&gt;
&lt;p&gt;Below, some packages for which rebuild is requires :&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; emerge --oneshot -pv media-gfx/exiv2 dev-libs/re2 dev-libs/boost dev-util/cppunit dev-cpp/libcmis dev-libs/liborcus dev-libs/xapian dev-libs/tinyxml app-text/qpdf sys-devel/llvm dev-libs/leveldb
&lt;/pre&gt;&lt;/div&gt;</content><category term="Gentoo"></category></entry><entry><title>How to install Docker on Gentoo</title><link href="http://didier.bernaudeau.net/How_to_install_Docker_on_Gentoo.html" rel="alternate"></link><published>2017-03-31T06:50:00+02:00</published><updated>2018-02-20T16:57:00+01:00</updated><author><name>Didier BERNAUDEAU</name></author><id>tag:didier.bernaudeau.net,2017-03-31:/How_to_install_Docker_on_Gentoo.html</id><summary type="html">&lt;p&gt;This post describes the linux kernel configuration for container support and the way to install Docker on Gentoo Linux.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;This post describes the linux kernel configuration for container support and the way to install Docker on Gentoo Linux.&lt;/p&gt;

&lt;h1&gt;Kernel configuration&lt;/h1&gt;
&lt;p&gt;This configuration is based on Gentoo Source 4.12.12.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt; | General setup  ---&amp;gt;
 |      |
*|      | [*] POSIX Message Queues
 |      | 
*|      | -*- Control Group support  ---&amp;gt;
 |      |      |
*|      |      | [*]   Memory controller
 |      |      | [*]     Swap controller
 |      |      | [*]       Swap controller enabled by default
 |      |      | [*]   IO controller
 |      |      | 
*|      |      | [*]   CPU controller  ---&amp;gt;
 |      |      |        | [*]   Group scheduling for SCHED_OTHER
 |      |      |        | [*]     CPU bandwidth provisioning for FAIR_GROUP_SCHED
 |      |      |        | [*]   Group scheduling for SCHED_RR/FIFO
 |      |      | 
 |      |      | [*]   PIDs controller
*|      |      | [*]   Freezer cgroup subsystem
 |      |      | [*]   HugeTLB controller
*|      |      | [*]   Cpuset support
 |      |      | [*]     Include legacy /proc/&amp;lt;pid&amp;gt;/cpuset file
*|      |      | [*]   Device controller for cgroups
*|      |      | [*]   Simple CPU accounting cgroup subsystem
 |      |      | [*]   Perf controller
 |      | 
*|      | -*- Namespaces support
*|      | [*]   UTS namespace
*|      | [*]   IPC namespace
 |      | [*]   User namespace
*|      | [*]   PID Namespaces
*|      | [*]   Network namespace
 |
 | [*] Networking support  ---&amp;gt;
 |      | Networking options  ---&amp;gt;
 |      |      |
*|      |      | &amp;lt;*&amp;gt; 802.1d Ethernet Bridging
 |      |      |
 |      |      | [*] Network packet filtering framework (Netfilter)  ---&amp;gt;
 |      |      |        | 
 |      |      |        | [*]   Advanced netfilter configuration
*|      |      |        | [*]     Bridged IP/ARP packets filtering
 |      |      |        | 
 |      |      |        | Core Netfilter Configuration  ---&amp;gt;
 |      |      |        |        | &amp;lt;*&amp;gt; Netfilter connection tracking support 
 |      |      |        |        | *** Xtables matches ***
*|      |      |        |        | &amp;lt;*&amp;gt;   "addrtype" address type match support
*|      |      |        |        | &amp;lt;*&amp;gt;   "conntrack" connection tracking match support
*|      |      |        |        | &amp;lt;*&amp;gt;   "ipvs" match support
 |      |      |        | 
 |      |      |        | &amp;lt;*&amp;gt;   IP virtual server support  ---&amp;gt;
 |      |      |        | 
 |      |      |        | IP: Netfilter Configuration  ---&amp;gt;
 |      |      |        |         | &amp;lt;*&amp;gt; IPv4 connection tracking support (required for NAT)
*|      |      |        |         | -*- IPv4 NAT
 |      |      |        |         | -*-   IPv4 masquerade support
 |      |      |        |         | &amp;lt;*&amp;gt; IP tables support (required for filtering/masq/NAT)
*|      |      |        |         | &amp;lt;*&amp;gt;   Packet filtering
*|      |      |        |         | &amp;lt;*&amp;gt;   iptables NAT support
*|      |      |        |         | &amp;lt;*&amp;gt;     MASQUERADE target support
 |      |      |        |         | &amp;lt;*&amp;gt;     NETMAP target support
 |      |      |        |         | &amp;lt;*&amp;gt;     REDIRECT target support
 |      |      |
 |      |      | [*] QoS and/or fair queueing  ---&amp;gt; 
 |      |      |        | &amp;lt;*&amp;gt;   Control Group Classifier
 |      |      |
 |      |      | [*] Network priority cgroup
 |      |      | -*- Network classid cgroup
 |
 | Device Drivers  ---&amp;gt;
 |      |
 |      | [*] Multiple devices driver support (RAID and LVM)  ---&amp;gt;
 |      |      | &amp;lt;*&amp;gt;   Device mapper support
 |      |      | &amp;lt;*&amp;gt;     Thin provisioning target
 |      |
 |      | [*] Network device support  ---&amp;gt;
 |      |      | [*]   Network core driver support
*|      |      | &amp;lt;*&amp;gt;     Virtual ethernet pair device
 |      |
 |
 | File systems  ---&amp;gt;
 |      | &amp;lt;*&amp;gt; Overlay filesystem support 
 |      | Pseudo filesystems  ---&amp;gt;
 |      |      | [*] HugeTLB file system support
 |
 | Security options  ---&amp;gt;
 |      | [*] Enable access key retention support
 |      | [*]   Enable register of persistent per-UID keyrings
 |      | &amp;lt;*&amp;gt;   ENCRYPTED KEYS
 |      | [*]   Diffie-Hellman operations on retained keys
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;* mandatory option&lt;/p&gt;
&lt;h1&gt;Docker installation&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Emerge docker&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; emerge app-emulation/docker
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Check kernel configuration&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; &lt;span class="nb"&gt;exec&lt;/span&gt; /usr/share/docker/contrib/check-config.sh
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Start docker daemon&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; systemctl start docker.service
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;test&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; docker run --rm hello-world
&lt;span class="gp"&gt;#&lt;/span&gt; docker run -it ubuntu bash
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Docker Compose version 1.18&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Allow installation of testing package&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; nano /etc/portage/package.accept_keywords 
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;=dev-python/texttable-0.9.1             ~amd64
=dev-python/docker-py-2.7.0             ~amd64
=dev-python/cached-property-1.3.1       ~amd64
=app-emulation/docker-compose-1.18.0    ~amd64
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; emerge app-emulation/docker-compose
&lt;/pre&gt;&lt;/div&gt;
&lt;!-- * Messages for package app-emulation/docker-17.03.1:

 *   CONFIG_BLK_DEV_THROTTLING:  is not set when it should be.
 *   CONFIG_CFQ_GROUP_IOSCHED:   is not set when it should be.
 *   CONFIG_IP_VS_PROTO_TCP:     is not set when it should be.
 *   CONFIG_IP_VS_PROTO_UDP:     is not set when it should be.
 *   CONFIG_IP_VS_NFCT:  is not set when it should be.
 *   CONFIG_IP_VS_RR:    is not set when it should be.
 *   CONFIG_VXLAN:       is not set when it should be.
 *   CONFIG_IPVLAN:      is not set when it should be.
 *   CONFIG_MACVLAN:     is not set when it should be.
 *   CONFIG_DUMMY:       is not set when it should be.--&gt;</content><category term="Container"></category><category term="Docker"></category><category term="Gentoo"></category></entry><entry><title>Spring Tool Suite</title><link href="http://didier.bernaudeau.net/Spring_Tool_Suite.html" rel="alternate"></link><published>2017-03-26T12:12:00+02:00</published><updated>2017-03-26T12:37:00+02:00</updated><author><name>Didier BERNAUDEAU</name></author><id>tag:didier.bernaudeau.net,2017-03-26:/Spring_Tool_Suite.html</id><summary type="html">&lt;p&gt;STS (Spring Tool Suite) is an IDE (Integrated Development Environment) provided by Pivotal. STS is an Eclipse-based that is customized to develop application based on Spring framework. This tutorial describes how to install Spring Tool Suite and additional framework provided by Pivotal.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;STS (Spring Tool Suite) is an IDE (Integrated Development Environment) provided by Pivotal. STS is an Eclipse-based that is customized to develop application based on Spring framework. This tutorial describes how to install Spring Tool Suite and additional framework provided by Pivotal.&lt;/p&gt;

&lt;h1&gt;Spring Tool Suite&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Install maven&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; emerge dev-java/maven-bin
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Download Spring Tool Suite&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; wget http://download.springsource.com/release/STS/3.8.3.RELEASE/dist/e4.6/spring-tool-suite-3.8.3.RELEASE-e4.6.2-linux-gtk-x86_64.tar.gz
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Install Spring Tool Suite&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; tar xvzf spring-tool-suite-3.8.3.RELEASE-e4.6.2-linux-gtk-x86_64.tar.gz
&lt;span class="gp"&gt;$&lt;/span&gt; mv sts-bundle spring-tool-suite
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;warning:&lt;/strong&gt; the user must have write access in this directory. So, you can't install this software in "opt" directory for all users.&lt;/p&gt;
&lt;h1&gt;Spring ROO&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Download Spring ROO&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; wget http://spring-roo-repository.springsource.org.s3.amazonaws.com/release/ROO/spring-roo-1.3.2.RELEASE.zip
&lt;span class="gp"&gt;$&lt;/span&gt; unzip spring-roo-1.3.2.RELEASE.zip -d /mnt/data/spring-tool-suite/
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Open STS and click on "Extensions" bottom tab and search "Spring Roo".&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Select "Spring Roo (current production release)" and "Spring IDE - (Roo extension)"and follow the instructions&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p align="center"&gt;&lt;img class="img-responsive" src="images/2017-01-24_Spring_Roo_00.png"/&gt;&lt;/p&gt;
&lt;p align="center"&gt;&lt;img class="img-responsive" src="images/2017-01-24_Spring_Roo_01.png"/&gt;&lt;/p&gt;
&lt;p align="center"&gt;&lt;img class="img-responsive" src="images/2017-01-24_Spring_Roo_02.png"/&gt;&lt;/p&gt;
&lt;p align="center"&gt;&lt;img class="img-responsive" src="images/2017-01-24_Spring_Roo_03.png"/&gt;&lt;/p&gt;
&lt;p align="center"&gt;&lt;img class="img-responsive" src="images/2017-01-24_Spring_Roo_04.png"/&gt;&lt;/p&gt;
&lt;p align="center"&gt;&lt;img class="img-responsive" src="images/2017-01-24_Spring_Roo_05.png"/&gt;&lt;/p&gt;
&lt;p align="center"&gt;&lt;img class="img-responsive" src="images/2017-01-24_Spring_Roo_06.png"/&gt;&lt;/p&gt;
&lt;p align="center"&gt;&lt;img class="img-responsive" src="images/2017-01-24_Spring_Roo_07.png"/&gt;&lt;/p&gt;</content><category term="Java"></category><category term="Spring"></category></entry><entry><title>Debian Stretch</title><link href="http://didier.bernaudeau.net/Debian_Stretch.html" rel="alternate"></link><published>2017-02-02T12:24:00+01:00</published><updated>2017-10-15T22:45:00+02:00</updated><author><name>Didier BERNAUDEAU</name></author><id>tag:didier.bernaudeau.net,2017-02-02:/Debian_Stretch.html</id><summary type="html">&lt;p&gt;Stretch is the 9th version of Debian Linux and succeed to Debian Jessie. The 3rd version has been released on December 9th 2017. This tutorials is a guideline to install and secure Debian Stretch 9.3.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;Stretch is the 9th version of Debian Linux and succeed to Debian Jessie. The 3rd version has been released on December 9th 2017. This tutorials is a guideline to install and secure Debian Stretch 9.3.&lt;/p&gt;

&lt;h1&gt;Getting debian&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; curl -O https://cdimage.debian.org/debian-cd/current/amd64/iso-cd/debian-9.3.0-amd64-netinst.iso
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Create a boot media&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; dd &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;debian-9.3.0-amd64-netinst.iso &lt;span class="nv"&gt;of&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;/dev/sdb &lt;span class="nv"&gt;bs&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;4k
&lt;span class="gp"&gt;#&lt;/span&gt; sync
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Installation&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Follow the instruction on the screen&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Install sudo&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; apt-get install -y sudo
&lt;span class="gp"&gt;#&lt;/span&gt; adduser UserName sudo
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Update system&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; sudo apt-get update &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; sudo apt-get upgrade
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Disable IPv6&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Edit kernel configuration file&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /etc/sysctl.conf
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;net.ipv6.conf.all.disable_ipv6 = 1
net.ipv6.conf.default.disable_ipv6=1
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Apply the new configuration&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo sysctl -p
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Install Useful tools&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Apt with HTTPS&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo apt-get install -y apt-transport-https
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Apt additional tools (such as add-apt-repository)&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="go"&gt;sudo apt-get install software-properties-common&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Curl&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo apt-get install -y curl
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Temperature&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo apt-get install -y lm-sensors
&lt;span class="gp"&gt;$&lt;/span&gt; sudo sensors-detect
&lt;span class="gp"&gt;$&lt;/span&gt; sensors
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;System monitring&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo apt-get install -y htop
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;What still needs to be done&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Install a Firewall IPv4/v6&lt;/li&gt;
&lt;li&gt;Install SeLinux&lt;/li&gt;
&lt;li&gt;Secure Boot&lt;/li&gt;
&lt;/ul&gt;</content><category term="Debian Stretch"></category></entry><entry><title>OVMF: UEFI support for Virtual Machine</title><link href="http://didier.bernaudeau.net/OVMF_UEFI_support_for_Virtual_Machine.html" rel="alternate"></link><published>2017-01-29T19:30:00+01:00</published><updated>2017-01-31T13:54:00+01:00</updated><author><name>Didier BERNAUDEAU</name></author><id>tag:didier.bernaudeau.net,2017-01-29:/OVMF_UEFI_support_for_Virtual_Machine.html</id><summary type="html">&lt;p&gt;OVMF (Open Virtual Machine Firmware) is the UEFI reference implementation. This firmware is based on EDK2 (EFI Development Kit) and it comes from the Intel's project "TianoCore".&lt;/p&gt;
&lt;p&gt;By default, virtual machine uses a legacy BIOS implementation (For instance, QEMU uses SeaBIOS). With OVMF, virtual machine could enjoy the new features such as GUID partition tables and Secure Boot (for testing purposes only).&lt;/p&gt;
&lt;p&gt;At this point, running a UEFI virtual machine with QEMU is still a fairly obscure use-case for which it can be difficult to find good examples. So, this post describes how to install OVMF on Gentoo Linux then, how to start an UEFI virtual machine with QEMU/KVM.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;OVMF (Open Virtual Machine Firmware) is the UEFI reference implementation. This firmware is based on EDK2 (EFI Development Kit) and it comes from the Intel's project "TianoCore".&lt;/p&gt;
&lt;p&gt;By default, virtual machine uses a legacy BIOS implementation (For instance, QEMU uses SeaBIOS). With OVMF, virtual machine could enjoy the new features such as GUID partition tables and Secure Boot (for testing purposes only).&lt;/p&gt;
&lt;p&gt;At this point, running a UEFI virtual machine with QEMU is still a fairly obscure use-case for which it can be difficult to find good examples. So, this post describes how to install OVMF on Gentoo Linux then, how to start an UEFI virtual machine with QEMU/KVM.&lt;/p&gt;

&lt;h1&gt;OVMF&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Install required packages&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; emerge git nasm
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Get the latest source for EDKII&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; mkdir ~/src
&lt;span class="gp"&gt;$&lt;/span&gt; &lt;span class="nb"&gt;cd&lt;/span&gt; ~/src
&lt;span class="gp"&gt;$&lt;/span&gt; git clone git://github.com/tianocore/edk2.git
&lt;span class="gp"&gt;$&lt;/span&gt; &lt;span class="nb"&gt;cd&lt;/span&gt; edk2
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Choosing which version of OVMF to build&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; nano ~/src/edk2/Conf/target.txt
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;ACTIVE_PLATFORM       = OvmfPkg/OvmfPkgX64.dsc
TARGET_ARCH           = X64
TOOL_CHAIN_TAG        = GCC49
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;build&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="go"&gt;cd ~/src/edk2/OvmfPkg/&lt;/span&gt;
&lt;span class="go"&gt;./build.sh&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;hr&gt;
&lt;p&gt;The build output files are in "~/src/edk2/Build/OvmfX64/DEBUG_GCC49/FV/" :&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;OVMF.fd : contains executable firmware code and the variable store&lt;/li&gt;
&lt;li&gt;OVMF_CODE.fd: contains the executable firmware code&lt;/li&gt;
&lt;li&gt;OVMF_VARS.fd: contains the variable store&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;At this point, you have 2 options:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Use a writable copy of OVMF.fd for each virtual machine&lt;/li&gt;
&lt;li&gt;Use OVMF_CODE.fd in read only for all virtual machines and a writable copy of OVMF_VARS.fd for each virtual machine.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;Warning:&lt;/strong&gt; the variable store should be private to the virtual machine. For this reason, each virtual machine needs a private, writable copy of OVMF.fd or OVMF_VARS.fd.&lt;/p&gt;
&lt;hr&gt;
&lt;h1&gt;QEMU / KVM&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Copy OVMF files&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; mkdir VirtualMachine/OVMF
&lt;span class="gp"&gt;$&lt;/span&gt; cp ~/src/edk2/Build/OvmfX64/DEBUG_GCC49/FV/OVMF* VirtualMachine/OVMF/
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;create disk image&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; qemu-img create -f qcow2 OVMF.qcow2 10G
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Start virtual machine (Option 1)&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; qemu-system-x86_64 -m 1G -enable-kvm -vga virtio &lt;span class="se"&gt;\&lt;/span&gt;
    -drive &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;pflash,format&lt;span class="o"&gt;=&lt;/span&gt;raw,readonly,file&lt;span class="o"&gt;=&lt;/span&gt;OVMF/OVMF_CODE.fd &lt;span class="se"&gt;\&lt;/span&gt;
    -drive &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;pflash,format&lt;span class="o"&gt;=&lt;/span&gt;raw,file&lt;span class="o"&gt;=&lt;/span&gt;OVMF/OVMF_VARS.fd &lt;span class="se"&gt;\&lt;/span&gt;
    -drive &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;virtio,file&lt;span class="o"&gt;=&lt;/span&gt;OVMF.qcow2 &lt;span class="se"&gt;\&lt;/span&gt;
    -cdrom iso/archlinux-2016.10.01-dual.iso
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Start virtual machine (Option 2)&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; qemu-system-x86_64 -m 1G -enable-kvm -vga virtio &lt;span class="se"&gt;\&lt;/span&gt;
    -drive &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;pflash,format&lt;span class="o"&gt;=&lt;/span&gt;raw,file&lt;span class="o"&gt;=&lt;/span&gt;OVMF/OVMF.fd &lt;span class="se"&gt;\&lt;/span&gt;
    -drive &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;virtio,file&lt;span class="o"&gt;=&lt;/span&gt;OVMF.qcow2 &lt;span class="se"&gt;\&lt;/span&gt;
    -cdrom iso/archlinux-2016.10.01-dual.iso
&lt;/pre&gt;&lt;/div&gt;
&lt;p align="center"&gt;&lt;img class="img-responsive" src="images/2017-01-29_OVMF_UEFI_support_for_Virtual_Machine_01.png" width="60%"/&gt;&lt;/p&gt;
&lt;p align="center"&gt;&lt;img class="img-responsive" src="images/2017-01-29_OVMF_UEFI_support_for_Virtual_Machine_02.png" width="60%"/&gt;&lt;/p&gt;
&lt;p align="center"&gt;&lt;img class="img-responsive" src="images/2017-01-29_OVMF_UEFI_support_for_Virtual_Machine_03.png" width="80%"/&gt;&lt;/p&gt;
&lt;h1&gt;LibVirt&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Copy OVMF files&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; mkdir /opt/OVMF
&lt;span class="gp"&gt;#&lt;/span&gt; cp src/edk2/Build/OvmfX64/DEBUG_GCC49/FV/OVMF* /opt/OVMF
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Configure LibVirt&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; nano /etc/libvirt/qemu.conf
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;nvram = [ "/opt/OVMF/OVMF_CODE.fd:/opt/OVMF/OVMF_VARS.fd" ]
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Restart LibVirt and create a new virtual machine&lt;/li&gt;
&lt;/ul&gt;
&lt;p align="center"&gt;&lt;img class="img-responsive" src="images/2017-01-29_OVMF_UEFI_support_for_Virtual_Machine_04.png" width="60%"/&gt;&lt;/p&gt;
&lt;h1&gt;What still needs to be done&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Secure Boot support&lt;/li&gt;
&lt;li&gt;Install OVMF with Portage (When OVMF package will be available)&lt;/li&gt;
&lt;/ul&gt;
&lt;!--
# Link
* [How to build OVMF](https://github.com/tianocore/tianocore.github.io/wiki/How%20to%20build%20OVMF)
* [Howto: QEMU w/ Ubuntu Xenial host + UEFI guest](http://blog.system76.com/post/139138591598/howto-qemu-w-ubuntu-xenial-host-uefi-guest)
* [Using UEFI with QEMU](https://fedoraproject.org/wiki/Using_UEFI_with_QEMU)
* [libvirt - UEFI Support](https://wiki.archlinux.org/index.php/Libvirt#UEFI_Support)
--&gt;&lt;/hr&gt;&lt;/hr&gt;</content><category term="Virtualization"></category><category term="Gentoo"></category></entry><entry><title>Nexus Repository OSS</title><link href="http://didier.bernaudeau.net/Nexus_Repository_OSS.html" rel="alternate"></link><published>2017-01-26T10:35:00+01:00</published><updated>2017-01-26T10:35:00+01:00</updated><author><name>Didier BERNAUDEAU</name></author><id>tag:didier.bernaudeau.net,2017-01-26:/Nexus_Repository_OSS.html</id><summary type="html">&lt;p&gt;Nexus Repository OSS is an artifact repository manager provided by Sonatype. This post describes how to install Nexus on Debian Linux. For this tutorial, I have chosen the version 2 because the version 3 doesn't support Maven yet.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;Nexus Repository OSS is an artifact repository manager provided by Sonatype. This post describes how to install Nexus on Debian Linux. For this tutorial, I have chosen the version 2 because the version 3 doesn't support Maven yet.&lt;/p&gt;

&lt;h1&gt;Debian&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Install Debian Stretch RC1&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Install sudo&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; apt-get install -y sudo
&lt;span class="gp"&gt;#&lt;/span&gt; adduser UserName sudo
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Update system&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; sudo apt-get update &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; sudo apt-get upgrade
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Prerequisites&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Install Java Runtime Environment&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo apt-get install -y openjdk-8-jre
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Nexus Repository&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Create system user and group&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo useradd --shell /usr/sbin/nologin --system --no-create-home nexus
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Download Nexus&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; wget http://www.sonatype.org/downloads/nexus-latest-bundle.tar.gz
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Install Nexus&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo tar xvzf nexus-latest-bundle.tar.gz -C /opt/
&lt;span class="gp"&gt;$&lt;/span&gt; sudo ln -s /opt/nexus-2.14.2-01 /opt/nexus
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Change the user and group ownership of Nexus' folders&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo chown -R nexus:nexus /opt/nexus
&lt;span class="gp"&gt;$&lt;/span&gt; sudo chown -R nexus:nexus /opt/nexus-2.14.2-01
&lt;span class="gp"&gt;$&lt;/span&gt; sudo chown -R nexus:nexus /opt/sonatype-work
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Create startup script for Systemd&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /etc/systemd/system/nexus.service
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;[Unit]&lt;/span&gt;
&lt;span class="na"&gt;Description&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;Sonatype Nexus Repository OSS&lt;/span&gt;

&lt;span class="k"&gt;[Service]&lt;/span&gt;
&lt;span class="na"&gt;Type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;forking&lt;/span&gt;
&lt;span class="na"&gt;User&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;nexus&lt;/span&gt;
&lt;span class="na"&gt;Group&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;nexus&lt;/span&gt;
&lt;span class="na"&gt;ExecStart&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;/opt/nexus/bin/nexus start&lt;/span&gt;
&lt;span class="na"&gt;ExecReload&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;/opt/nexus/bin/nexus restart&lt;/span&gt;
&lt;span class="na"&gt;ExecStop&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;/opt/nexus/bin/nexus stop&lt;/span&gt;

&lt;span class="k"&gt;[Install]&lt;/span&gt;
&lt;span class="na"&gt;WantedBy&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;default.target&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Start the service&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl &lt;span class="nb"&gt;enable&lt;/span&gt; nexus
&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl start nexus
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Open &lt;a href="http://nexus.intra.net:8081/nexus"&gt;http://nexus.intra.net:8081/nexus&lt;/a&gt; in your browser to configure Nexus&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Log in with administrator credential : username = admin and password = admin123&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Warning:&lt;/strong&gt; Change the default password.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Create a "Local Repository"&lt;/li&gt;
&lt;/ul&gt;
&lt;p align="center"&gt;&lt;img class="img-responsive" src="images/2017-01-26_Nexus_Repository_OSS_01.png"/&gt;&lt;/p&gt;
&lt;!--

# User right management

  * Privileges
  * Roles : set of privileges and/or roles
  * Users : set of roles
      ==&gt; cf. schéma

# Maven

This section describe how to configure Maven on Gentoo Linux to use the Nexus repository.

* Install maven


wzxhzdk:10


* Edit repository

/usr/share/maven-bin-3.3/conf/settings.xml
/home/didier/.m2/settings.xml
/home/didier/.m2/repository

--&gt;
&lt;h1&gt;What still needs to be done&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Maven client&lt;/li&gt;
&lt;li&gt;Right management&lt;/li&gt;
&lt;li&gt;Enable HTTPS on Jetty (Especially for Secure Cookies)
  &lt;!--   http://www.sonatype.org/nexus/2014/09/09/five-steps-to-securing-your-use-of-nexus/ --&gt;&lt;/li&gt;
&lt;li&gt;Enable standard port for HTTPS (TCP/443 with nginx RP)&lt;/li&gt;
&lt;/ul&gt;</content><category term="Development tool"></category><category term="Debian"></category></entry><entry><title>Spring Roo</title><link href="http://didier.bernaudeau.net/Spring_Roo.html" rel="alternate"></link><published>2017-01-24T17:55:00+01:00</published><updated>2017-01-25T16:23:00+01:00</updated><author><name>Didier BERNAUDEAU</name></author><id>tag:didier.bernaudeau.net,2017-01-24:/Spring_Roo.html</id><summary type="html">&lt;p&gt;Spring ROO (Real Object Oriented) is an another framework provided by Pivotal for AOP (Aspect-Oriented Programming). This framework is based on AspectJ and suitable for DDD (Domain Driven Design). This tutorial describes how to create a first application with Spring ROO.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;Spring ROO (Real Object Oriented) is an another framework provided by Pivotal for AOP (Aspect-Oriented Programming). This framework is based on AspectJ and suitable for DDD (Domain Driven Design). This tutorial describes how to create a first application with Spring ROO.&lt;/p&gt;

&lt;h1&gt;Develop an application : BurgerShop&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Create a project : File &amp;gt; New &amp;gt; Spring ROO Project&lt;/li&gt;
&lt;/ul&gt;
&lt;p align="center"&gt;&lt;img class="img-responsive" src="images/2017-01-24_Spring_Roo_Project.png"/&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Define the domain objects&lt;/li&gt;
&lt;/ul&gt;
&lt;p align="center"&gt;&lt;img class="img-responsive" src="images/2017-01-24_Spring_Roo_domain.png"/&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Define the database&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="go"&gt;roo &amp;gt; jpa setup --provider HIBERNATE --database HYPERSONIC_IN_MEMORY&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Create the domain objects&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="go"&gt;roo &amp;gt; entity jpa --class ~.domain.Topping --testAutomatically&lt;/span&gt;
&lt;span class="go"&gt;roo &amp;gt; field string --fieldName name --notNull --sizeMin 2&lt;/span&gt;

&lt;span class="go"&gt;roo &amp;gt; entity jpa --class ~.domain.Base --testAutomatically&lt;/span&gt;
&lt;span class="go"&gt;roo &amp;gt; field string --fieldName name --notNull --sizeMin 2&lt;/span&gt;

&lt;span class="go"&gt;roo &amp;gt; entity jpa --class ~.domain.Burger --testAutomatically&lt;/span&gt;
&lt;span class="go"&gt;roo &amp;gt; field string --fieldName name --notNull --sizeMin 2&lt;/span&gt;
&lt;span class="go"&gt;roo &amp;gt; field number --fieldName price --type java.lang.Float&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Create relations between objects&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="go"&gt;roo &amp;gt; field set --fieldName toppings --type ~.domain.Topping&lt;/span&gt;
&lt;span class="go"&gt;roo &amp;gt; field reference --fieldName base --type ~.domain.Base&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Create the last domain object: "Burger Order"&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="go"&gt;roo &amp;gt; entity jpa --class ~.domain.BurgerOrder --testAutomatically &lt;/span&gt;
&lt;span class="go"&gt;roo &amp;gt; field string --fieldName name --notNull --sizeMin 2&lt;/span&gt;
&lt;span class="go"&gt;roo &amp;gt; field string --fieldName address --sizeMax 30&lt;/span&gt;
&lt;span class="go"&gt;roo &amp;gt; field number --fieldName total --type java.lang.Float &lt;/span&gt;
&lt;span class="go"&gt;roo &amp;gt; field date --fieldName deliveryDate --type java.util.Date&lt;/span&gt;
&lt;span class="go"&gt;roo &amp;gt; field set --fieldName burgers --type ~.domain.Burger&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Perform test&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="go"&gt;roo &amp;gt; test integration&lt;/span&gt;
&lt;span class="go"&gt;roo &amp;gt; perform tests&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Create automatically the web components&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="go"&gt;roo&amp;gt; web mvc setup&lt;/span&gt;
&lt;span class="go"&gt;roo&amp;gt; web mvc all --package ~.web&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Deploy the application&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Drag and drop the project on the "Pivotal tc Server Developer Edition" in the "Servers" view.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Right clic on the project and select « Run As &amp;gt; Run on Server »&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Open &lt;a href="http://localhost:8080/burgershop"&gt;http://localhost:8080/burgershop&lt;/a&gt; in your browser.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p align="center"&gt;&lt;img class="img-responsive" src="images/2017-01-24_Spring_Roo_BurgerShop.png"/&gt;&lt;/p&gt;
&lt;h1&gt;What still needs to be done&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Add security (user profile, authentication, ...) with Spring Security&lt;/li&gt;
&lt;li&gt;Improve BurgerShop application with calculated field, better form, ...&lt;/li&gt;
&lt;/ul&gt;
&lt;!--
http://docs.spring.io/spring-roo/docs/2.0.x/reference/html/#getting-started-install-roo
http://jeremy-jeanne.developpez.com/tutoriels/spring/spring-roo/
Add project Git :http://www.5balloons.info/adding-a-new-spring-maven-project-from-eclipse-to-git-repobitbucket/
https://spring.io/guides
--&gt;</content><category term="Framework"></category><category term="Java"></category><category term="Spring"></category></entry><entry><title>Jenkins</title><link href="http://didier.bernaudeau.net/Jenkins.html" rel="alternate"></link><published>2017-01-21T21:08:00+01:00</published><updated>2017-01-21T21:08:00+01:00</updated><author><name>Didier BERNAUDEAU</name></author><id>tag:didier.bernaudeau.net,2017-01-21:/Jenkins.html</id><summary type="html">&lt;p&gt;Jenkins is the main tool for continuous integration and continuous delivery. Indeed, this tool is in the center of a development pipeline because it is able to interact with a variety of tools (Git repository, source code analysis, ...). Jenkins, a fork of Hudson, is a open source software written in Java.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;Jenkins is the main tool for continuous integration and continuous delivery. Indeed, this tool is in the center of a development pipeline because it is able to interact with a variety of tools (Git repository, source code analysis, ...). Jenkins, a fork of Hudson, is a open source software written in Java.&lt;/p&gt;

&lt;h1&gt;Debian Stretch&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Install Debian&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;Hostname&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;jenkins&lt;/span&gt;
&lt;span class="n"&gt;Domain&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;intra&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;net&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Install sudo&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; apt-get install -y sudo
&lt;span class="gp"&gt;#&lt;/span&gt; adduser UserName sudo
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Update system&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; sudo apt-get update &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; sudo apt-get upgrade
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Jenkins&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Add the key of jenkins' repository&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; wget -q -O - https://pkg.jenkins.io/debian/jenkins.io.key &lt;span class="p"&gt;|&lt;/span&gt; sudo apt-key add -
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Add the repository&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /etc/apt/sources.list
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;deb&lt;/span&gt; &lt;span class="s"&gt;https://pkg.jenkins.io/debian&lt;/span&gt; &lt;span class="kp"&gt;binary/&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Install apt module&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="go"&gt;sudo apt-get install apt-transport-https&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Update the local package index&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo apt-get update
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Install Jenkins&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo apt-get install jenkins
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Create startup script for Jenkins&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /etc/systemd/system/jenkins.service
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;[Unit]&lt;/span&gt;
&lt;span class="na"&gt;Description&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;Jenkins&lt;/span&gt;

&lt;span class="k"&gt;[Service]&lt;/span&gt;
&lt;span class="na"&gt;User&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;jenkins&lt;/span&gt;
&lt;span class="na"&gt;Group&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;jenkins&lt;/span&gt;
&lt;span class="na"&gt;WorkingDirectory&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;/var/lib/jenkins&lt;/span&gt;
&lt;span class="na"&gt;ExecStart&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;/usr/bin/java -jar /usr/share/jenkins/jenkins.war&lt;/span&gt;
&lt;span class="na"&gt;Restart&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;always&lt;/span&gt;

&lt;span class="k"&gt;[Install]&lt;/span&gt;
&lt;span class="na"&gt;WantedBy&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;multi-user.target&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Start the service&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl &lt;span class="nb"&gt;enable&lt;/span&gt; jenkins
&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl start jenkins
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Open &lt;a href="http://jenkins.intra.net:8080"&gt;http://jenkins.intra.net:8080&lt;/a&gt; in your browser to configure Jenkins&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Get password&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo cat /var/lib/jenkins/secrets/initialAdminPassword
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;What still needs to be done&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Reverse Proxy with authentication&lt;/li&gt;
&lt;li&gt;Link to git repository (without technical account)&lt;/li&gt;
&lt;/ul&gt;</content><category term="Development tool"></category><category term="Debian"></category></entry><entry><title>Gogs (Go Git Service)</title><link href="http://didier.bernaudeau.net/Gogs_Go_Git_Service.html" rel="alternate"></link><published>2017-01-18T17:23:00+01:00</published><updated>2017-01-23T14:36:00+01:00</updated><author><name>Didier BERNAUDEAU</name></author><id>tag:didier.bernaudeau.net,2017-01-18:/Gogs_Go_Git_Service.html</id><summary type="html">&lt;p&gt;Gogs (Go Git Service) is a source code repository manager for Git, the famed VCS (Version Control System) or SCM (Source Control Management). It's a lightweight software written in Go that can run anywhere (Linux, Mac, ARM, ...). On top of that, Gogs is fully open source unlike GitLab! Thus, this post describes how to host your own private GitHub with &lt;a href="https://gogs.io"&gt;Gogs&lt;/a&gt;.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;Gogs (Go Git Service) is a source code repository manager for Git, the famed VCS (Version Control System) or SCM (Source Control Management). It's a lightweight software written in Go that can run anywhere (Linux, Mac, ARM, ...). On top of that, Gogs is fully open source unlike GitLab! Thus, this post describes how to host your own private GitHub with &lt;a href="https://gogs.io"&gt;Gogs&lt;/a&gt;.&lt;/p&gt;

&lt;p align="center"&gt;
&lt;img class="img-responsive" src="images/2017-01-18_Gogs_Go_Git_Service.jpg"&gt;
&lt;/img&gt;&lt;/p&gt;
&lt;h1&gt;Debian Stretch&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Install Debian&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;Hostname&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;gogs&lt;/span&gt;
&lt;span class="n"&gt;Domain&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;intra&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;net&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Install sudo&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; apt-get install -y sudo
&lt;span class="gp"&gt;#&lt;/span&gt; adduser UserName sudo
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Update system&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; sudo apt-get update &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; sudo apt-get upgrade
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;PostgreSQL&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Install PostgreSQL&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo apt-get install -y postgresql postgresql-client libpq-dev
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Open the PostgreSQL interactive terminal&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo -u postgres psql
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Create user and database for Gogs&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;postgres=#&lt;/span&gt; &lt;span class="k"&gt;CREATE&lt;/span&gt; &lt;span class="k"&gt;USER&lt;/span&gt; &lt;span class="n"&gt;gogs&lt;/span&gt; &lt;span class="n"&gt;CREATEDB&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="gp"&gt;postgres=#&lt;/span&gt; &lt;span class="kp"&gt;\password&lt;/span&gt; &lt;span class="ss"&gt;gogs&lt;/span&gt;
&lt;span class="gp"&gt;postgres=#&lt;/span&gt; &lt;span class="k"&gt;CREATE&lt;/span&gt; &lt;span class="k"&gt;DATABASE&lt;/span&gt; &lt;span class="n"&gt;gogs&lt;/span&gt; &lt;span class="k"&gt;OWNER&lt;/span&gt; &lt;span class="n"&gt;gogs&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="gp"&gt;postgres=#&lt;/span&gt; &lt;span class="kp"&gt;\q&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Nginx&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Install Nginx&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo apt-get install -y nginx
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Create self-signed certificate&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo mkdir /etc/nginx/tls
&lt;span class="gp"&gt;$&lt;/span&gt; sudo openssl req -new -x509 -newkey ec -pkeyopt ec_paramgen_curve:prime256v1 -sha256 -days &lt;span class="m"&gt;365&lt;/span&gt; -nodes -out /etc/nginx/tls/gogs.crt -keyout /etc/nginx/tls/gogs.key
&lt;span class="gp"&gt;$&lt;/span&gt; sudo chmod -R &lt;span class="m"&gt;600&lt;/span&gt; /etc/nginx/tls
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;Warning:&lt;/strong&gt; a self signed certificate is for testing purposes only. Don't do that on production environment where a certificate issued by a trusted certificate authority is needed.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Set Nginx as the reverse proxy for Gogs.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /etc/nginx/sites-available/gogs
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;server&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="err"&gt;listen&lt;/span&gt; &lt;span class="err"&gt;80&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="err"&gt;server_name&lt;/span&gt; &lt;span class="err"&gt;gogs.intra.net&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="err"&gt;return&lt;/span&gt; &lt;span class="err"&gt;302&lt;/span&gt; &lt;span class="n"&gt;https&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;//&lt;/span&gt;&lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;server_name&lt;/span&gt;&lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;request_uri&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="nt"&gt;server&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="err"&gt;listen&lt;/span&gt; &lt;span class="err"&gt;443&lt;/span&gt; &lt;span class="err"&gt;ssl&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="err"&gt;server_name&lt;/span&gt; &lt;span class="err"&gt;gogs.intra.net&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="err"&gt;ssl_certificate&lt;/span&gt; &lt;span class="err"&gt;/etc/nginx/tls/gogs.crt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="err"&gt;ssl_certificate_key&lt;/span&gt; &lt;span class="err"&gt;/etc/nginx/tls/gogs.key&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="err"&gt;location&lt;/span&gt; &lt;span class="err"&gt;/&lt;/span&gt; &lt;span class="err"&gt;{&lt;/span&gt;
        &lt;span class="err"&gt;proxy_set_header&lt;/span&gt; &lt;span class="err"&gt;X-Real-IP&lt;/span&gt; &lt;span class="err"&gt;$remote_addr&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="err"&gt;proxy_pass&lt;/span&gt; &lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;//&lt;/span&gt;&lt;span class="mf"&gt;127.0.0.1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;3000&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="err"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Activate the reverse proxy&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo ln -s /etc/nginx/sites-available/gogs /etc/nginx/sites-enabled/gogs
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Restart Nginx&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl restart nginx
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Git&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Install Git&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo apt-get install -y git
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Go&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Install Go&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo apt-get install -y golang-1.7-go
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Create a folder for Go Apps (such as Gogs)&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo mkdir /opt/GoApps
&lt;span class="gp"&gt;$&lt;/span&gt; &lt;span class="nb"&gt;cd&lt;/span&gt; /opt/GoApps
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Create user to run Go Apps&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo adduser --disabled-login --gecos &lt;span class="s1"&gt;'Go Apps User'&lt;/span&gt; go
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Set the environment variables&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; &lt;span class="nb"&gt;export&lt;/span&gt; &lt;span class="nv"&gt;GOROOT&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;/usr/lib/go-1.7
&lt;span class="gp"&gt;$&lt;/span&gt; &lt;span class="nb"&gt;export&lt;/span&gt; &lt;span class="nv"&gt;GOPATH&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;/opt/GoApps
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Gogs&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Download Gogs&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo --preserve-env /usr/lib/go-1.7/bin/go get -u github.com/gogits/gogs
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Build Gogs binary&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; &lt;span class="nb"&gt;cd&lt;/span&gt; /opt/GoApps/src/github.com/gogits/gogs
&lt;span class="gp"&gt;$&lt;/span&gt; sudo --preserve-env /usr/lib/go-1.7/bin/go build
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Create directory for source code repositories&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo mkdir /var/gogs-repositories
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;Warning:&lt;/strong&gt; in production environment, don't forget to add this repository in your backup system.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Change owner&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo chown go:go -R /opt/GoApps
&lt;span class="gp"&gt;$&lt;/span&gt; sudo chown go:go -R /var/gogs-repositories
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Create startup script for Gogs&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /etc/systemd/system/gogs.service
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;[Unit]&lt;/span&gt;
&lt;span class="na"&gt;Description&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;Gogs (Go Git Service)&lt;/span&gt;
&lt;span class="na"&gt;After&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;syslog.target&lt;/span&gt;
&lt;span class="na"&gt;After&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;network.target&lt;/span&gt;
&lt;span class="na"&gt;After&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;postgresql.service&lt;/span&gt;
&lt;span class="na"&gt;After&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;nginx.service&lt;/span&gt;

&lt;span class="k"&gt;[Service]&lt;/span&gt;
&lt;span class="na"&gt;Type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;simple&lt;/span&gt;
&lt;span class="na"&gt;User&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;go&lt;/span&gt;
&lt;span class="na"&gt;Group&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;go&lt;/span&gt;
&lt;span class="na"&gt;WorkingDirectory&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;/opt/GoApps/src/github.com/gogits/gogs&lt;/span&gt;
&lt;span class="na"&gt;ExecStart&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;/opt/GoApps/src/github.com/gogits/gogs/gogs web&lt;/span&gt;
&lt;span class="na"&gt;Restart&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;always&lt;/span&gt;
&lt;span class="na"&gt;Environment&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;USER=go HOME=/home/go&lt;/span&gt;

&lt;span class="k"&gt;[Install]&lt;/span&gt;
&lt;span class="na"&gt;WantedBy&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;multi-user.target&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Start the service&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl &lt;span class="nb"&gt;enable&lt;/span&gt; gogs
&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl start gogs
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Open &lt;a href="http://gogs.intra.net:3000"&gt;http://gogs.intra.net:3000&lt;/a&gt;  in your browser to configure Gogs&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Database type = PostgreSQL
Host = 127.0.0.1:5432
User = gogs
Password = ************
Database Name = gogs
Repository Root Path = /var/gogs-repositories
Run User = go
Domain = gogs.intra.net
Port SSH = empty
Application URL = https://gogs.intra.net
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Disable the access to non-TLS version of Gogs&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /opt/GoApps/src/github.com/gogits/gogs/custom/conf/app.ini
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;[server]&lt;/span&gt;
&lt;span class="na"&gt;DOMAIN&lt;/span&gt;       &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;gogs.intra.net&lt;/span&gt;
&lt;span class="na"&gt;HTTP_ADDR&lt;/span&gt;    &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;127.0.0.1&lt;/span&gt;
&lt;span class="na"&gt;HTTP_PORT&lt;/span&gt;    &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;3000&lt;/span&gt;
&lt;span class="na"&gt;ROOT_URL&lt;/span&gt;     &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;http://gogs.intra.net:3000/&lt;/span&gt;
&lt;span class="na"&gt;DISABLE_SSH&lt;/span&gt;  &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;true&lt;/span&gt;
&lt;span class="na"&gt;OFFLINE_MODE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;false&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Restart Gogs&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo systemctl restart gogs
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Create the first account (which will be the administrator)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Create an Organization for your entity&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Create teams and define the access right (read, write or admin) on Organization's repositories&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Add members in the teams&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Create collaborative repository&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;What still needs to be done&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Change log repository (As is: /opt/GoApps/src/github.com/gogits/gogs/log)&lt;/li&gt;
&lt;li&gt;Reverse proxy authentication by certificate&lt;/li&gt;
&lt;/ul&gt;</content><category term="Development tool"></category><category term="SCM"></category><category term="Debian"></category><category term="Go"></category><category term="Git"></category></entry><entry><title>How to install Java SE on Debian</title><link href="http://didier.bernaudeau.net/How_to_install_Java_SE_on_debian.html" rel="alternate"></link><published>2017-01-12T15:42:00+01:00</published><updated>2017-01-13T17:47:00+01:00</updated><author><name>Didier BERNAUDEAU</name></author><id>tag:didier.bernaudeau.net,2017-01-12:/How_to_install_Java_SE_on_debian.html</id><summary type="html">&lt;p&gt;Lately, install Java SE on Linux has become a nightmare because most of Linux distributions, such as Debian, have chosen to remove this package from official repositories due to license reasons.
However, Java SE is needed for some applications which are not compatible with Open JRE / JDK. So, this post describes step by step how to install Java SE (JRE and JDK) provided by Oracle on Debian.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;Lately, install Java SE on Linux has become a nightmare because most of Linux distributions, such as Debian, have chosen to remove this package from official repositories due to license reasons.
However, Java SE is needed for some applications which are not compatible with Open JRE / JDK. So, this post describes step by step how to install Java SE (JRE and JDK) provided by Oracle on Debian.&lt;/p&gt;

&lt;h1&gt;Java Package&lt;/h1&gt;
&lt;p&gt;Java-package is a tool that provides the ability to build a Debian package from a Java binary.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Add a "contrib" component in sources.list&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; nano /etc/apt/sources.list
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;deb&lt;/span&gt; &lt;span class="s"&gt;http://*********.debian.org/debian/&lt;/span&gt; &lt;span class="kp"&gt;jessie&lt;/span&gt; &lt;span class="kp"&gt;main&lt;/span&gt; &lt;span class="kp"&gt;contrib&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Update the list of available packages&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; apt-get update
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Install the java-package package&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; apt-get install java-package
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Install packages needed by Java 8&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; apt-get install libxslt1-dev
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Java Runtime Environment&lt;/h1&gt;
&lt;p&gt;JRE (Java Runtime Environment) contains the JVM (Java Virtual Machine) to execute java programs and other java tools such as keytool.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Download Java 8 Standard Edition Runtime Environment&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; wget --header &lt;span class="s2"&gt;"Cookie: oraclelicense=accept-securebackup-cookie"&lt;/span&gt; http://download.oracle.com/otn-pub/java/jdk/8u112-b15/jre-8u112-linux-x64.tar.gz
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Create a Debian package&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; fakeroot make-jpkg jre-8u112-linux-x64.tar.gz
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Install the binary package&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; dpkg -i oracle-java8-jre_8u112_amd64.deb
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Java Development Kit&lt;/h1&gt;
&lt;p&gt;The JDK (Java Development Kit) includes JRE and tools for developers to create and compile java programs (javac, JavaDoc, Java Debugger, ...).&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Download Java 8 Standard Edition Development Kit&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; wget --header &lt;span class="s2"&gt;"Cookie: oraclelicense=accept-securebackup-cookie"&lt;/span&gt; http://download.oracle.com/otn-pub/java/jdk/8u112-b15/jdk-8u112-linux-x64.tar.gz
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Create a Debian package&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; fakeroot make-jpkg jdk-8u112-linux-x64.tar.gz
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Install the binary package created:&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; dpkg -i oracle-java8-jdk_8u112_amd64.deb
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Select Java SE&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Select the JVM of your choice&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; update-alternatives --config java
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;There are 3 choices for the alternative java (providing /usr/bin/java).

  Selection    Path                                            Priority   Status
------------------------------------------------------------
  0            /usr/lib/jvm/java-7-openjdk-amd64/jre/bin/java   1071      auto mode
  1            /usr/lib/jvm/java-7-openjdk-amd64/jre/bin/java   1071      manual mode
* 2            /usr/lib/jvm/jdk-8-oracle-x64/jre/bin/java       318       manual mode
  3            /usr/lib/jvm/jre-8-oracle-x64/bin/java           317       manual mode

Press enter to keep the current choice[*], or type selection number: 3
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Verify the selected JVM&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; java -version
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;java version "1.8.0_112"
Java(TM) SE Runtime Environment (build 1.8.0_112-b15)
Java HotSpot(TM) 64-Bit Server VM (build 25.112-b15, mixed mode)
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Select the Java compiler of your choice&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="go"&gt;update-alternatives --config javac&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;There are 2 choices for the alternative javac (providing /usr/bin/javac).

  Selection    Path                                         Priority   Status
------------------------------------------------------------
  0            /usr/lib/jvm/java-7-openjdk-amd64/bin/javac   1071      auto mode
  1            /usr/lib/jvm/java-7-openjdk-amd64/bin/javac   1071      manual mode
* 2            /usr/lib/jvm/jdk-8-oracle-x64/bin/javac       318       manual mode

Press enter to keep the current choice[*], or type selection number: 2
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Verify the selected Java compiler&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; javac -version
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;javac 1.8.0_112
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Links&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://wiki.debian.org/JavaPackage"&gt;JavaPackage&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><category term="Debian"></category><category term="Java"></category></entry><entry><title>How to install Docker</title><link href="http://didier.bernaudeau.net/How_to_install_docker.html" rel="alternate"></link><published>2016-11-10T23:34:00+01:00</published><updated>2016-11-10T23:34:00+01:00</updated><author><name>Didier BERNAUDEAU</name></author><id>tag:didier.bernaudeau.net,2016-11-10:/How_to_install_docker.html</id><summary type="html">&lt;p&gt;Docker is the most famous application container engine. This post describes the best way to install docker on Debian Linux.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;Docker is the most famous application container engine. This post describes the best way to install docker on Debian Linux.&lt;/p&gt;

&lt;h1&gt;Add Docker's repository&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Install dependencies&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; apt-get install apt-transport-https ca-certificates
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Install public key of Docker's repository&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; apt-key adv --keyserver hkp://p80.pool.sks-keyservers.net:80 --recv-keys 58118E89F3A912897C070ADBF76221572C52609D
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Add Docker repository&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; nano /etc/apt/sources.list.d/docker.list
&lt;span class="go"&gt;deb https://apt.dockerproject.org/repo debian-jessie main&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Update repository&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; apt-get update
&lt;span class="gp"&gt;#&lt;/span&gt; apt-cache policy docker-engine
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Install Docker&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Install&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; apt-get install docker-engine
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Start Docker&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; service docker start
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Test Docker with OWASP ZAP&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Pull the latest zap docker image from owasp's docker image repository (hosted by docker hub).&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; docker pull owasp/zap2docker-stable
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;List installed images&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; docker images
&lt;span class="go"&gt;REPOSITORY                TAG                 IMAGE ID            CREATED             SIZE&lt;/span&gt;
&lt;span class="go"&gt;owasp/zap2docker-stable   latest              a774bdc65502        5 months ago        1.557 GB&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Run docker image&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; docker run -p &lt;span class="m"&gt;8090&lt;/span&gt;:8090 -i owasp/zap2docker-stable zap.sh -daemon -port &lt;span class="m"&gt;8090&lt;/span&gt; -host &lt;span class="m"&gt;0&lt;/span&gt;.0.0.0
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Get Container ID&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; docker ps

&lt;span class="go"&gt;CONTAINER ID        IMAGE                     COMMAND                  CREATED             STATUS              PORTS                    NAMES&lt;/span&gt;
&lt;span class="go"&gt;5ff0ca31a9a1        owasp/zap2docker-stable   "zap.sh -daemon -port"   54 seconds ago      Up 53 seconds       0.0.0.0:8090-&amp;gt;8090/tcp   zen_knuth&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Get information&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; docker inspect &amp;lt;CONTAINER ID&amp;gt;
&lt;/pre&gt;&lt;/div&gt;</content><category term="Container"></category><category term="Debian"></category></entry><entry><title>How to install OVS (Open Virtual Swtich)</title><link href="http://didier.bernaudeau.net/How_to_install_OVS.html" rel="alternate"></link><published>2016-09-05T22:26:00+02:00</published><updated>2017-01-30T10:42:00+01:00</updated><author><name>Didier BERNAUDEAU</name></author><id>tag:didier.bernaudeau.net,2016-09-05:/How_to_install_OVS.html</id><summary type="html">&lt;p&gt;Open vSwitch is a virtual switch with advanced functionnality such as isolation (vlan), monitoring and automated control. This tutorial describes how to install Open vSwitch in kernel space and how to configure LibVirt to use a virtual switch with KVM guest.&lt;/p&gt;
&lt;p&gt;However, there is a lot of functionality available with Open Virtual Switch that this article does not touch. You can setup VLAN tagging, QoS rules, create re-routing rules, block IP address, block ports, and much more. Feel free to reference online documentation and man pages if you are interested in adding complex functionality to the controller.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;Open vSwitch is a virtual switch with advanced functionnality such as isolation (vlan), monitoring and automated control. This tutorial describes how to install Open vSwitch in kernel space and how to configure LibVirt to use a virtual switch with KVM guest.&lt;/p&gt;
&lt;p&gt;However, there is a lot of functionality available with Open Virtual Switch that this article does not touch. You can setup VLAN tagging, QoS rules, create re-routing rules, block IP address, block ports, and much more. Feel free to reference online documentation and man pages if you are interested in adding complex functionality to the controller.&lt;/p&gt;

&lt;h1&gt;Open Virtual Switch&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Configure the kernel&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;|[*] Networking support  ---&amp;gt;
|     | Networking options  ---&amp;gt;
|     |    | [*] Network packet filtering framework (Netfilter)  ---&amp;gt;
|     |    |         | IPv6: Netfilter Configuration  ---&amp;gt;
|     |    |         |      | &amp;lt;*&amp;gt; IP6 tables support (required for filtering)
|     |    |         |      | &amp;lt;*&amp;gt;   "frag" Fragmentation header match support
|     |    |
|     |    | &amp;lt;*&amp;gt;   Open vSwitch
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Enable the version 2.6.1&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; nano /etc/portage/package.keywords
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;=net-misc/openvswitch-2.6.1             ~amd64
=dev-python/ovs-2.6.1                   ~amd64
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Define compilation option&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; nano /etc/portage/package.use
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;net-misc/openvswitch    -module
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Install packages&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; emerge openvswitch
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Create database&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; emerge --config &lt;span class="o"&gt;=&lt;/span&gt;net-misc/openvswitch-2.6.1
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; The file of this database is "/var/lib/openvswitch/conf.db".&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Create missing directory&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; mkdir /var/run/openvswitch/
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Configure Network Manager (if used) : Disconnect "cable interface" and disabled "automatically connect".&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Start OpenSwitch&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; systemctl start ovsdb-server
&lt;span class="gp"&gt;#&lt;/span&gt; systemctl start ovs-vswitchd
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Create a virtual switch&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; ovs-vsctl add-br vbr0
&lt;span class="gp"&gt;#&lt;/span&gt; ovs-vsctl set-controller vbr0 ptcp:
&lt;span class="gp"&gt;#&lt;/span&gt; ovs-vsctl add-port vbr0 enp0s25
&lt;span class="gp"&gt;#&lt;/span&gt; ovs-vsctl &lt;span class="nb"&gt;set&lt;/span&gt; bridge vbr0 &lt;span class="nv"&gt;stp_enable&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;true&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Prints a brief overview of the switch database configuration&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; ovs-vsctl show
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;209fb6b8-d25b-4c1d-874c-0c75bccfca15
    Bridge "vbr0"
        Controller "ptcp:"
        Port "enp0s25"
            Interface "enp0s25"
        Port "vbr0"
            Interface "vbr0"
                type: internal
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;LibVirt&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Create an XML file to define a libvirt virtual network&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; nano virtual_switch.xml
&lt;span class="go"&gt;&amp;lt;network&amp;gt;&lt;/span&gt;
&lt;span class="go"&gt;  &amp;lt;name&amp;gt;VirtualSwitch&amp;lt;/name&amp;gt;&lt;/span&gt;
&lt;span class="go"&gt;  &amp;lt;forward mode='bridge'/&amp;gt;&lt;/span&gt;
&lt;span class="go"&gt;  &amp;lt;bridge name='vbr0'/&amp;gt;&lt;/span&gt;
&lt;span class="go"&gt;  &amp;lt;virtualport type='openvswitch'/&amp;gt;&lt;/span&gt;
&lt;span class="go"&gt;&amp;lt;/network&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Create network in LibVirt&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; virsh net-define virtual_switch.xml
&lt;span class="gp"&gt;#&lt;/span&gt; virsh net-start VirtualSwitch
&lt;span class="gp"&gt;#&lt;/span&gt; virsh net-list --all
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Restart LibVirt&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; systemctl restart libvirtd.service
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Now, the virtual switch is available for the guest VM.&lt;/p&gt;
&lt;!--

# Addendum: Local Switch

* Create a virtual switch


wzxhzdk:15


* Prints a brief overview of the switch database configuration


wzxhzdk:16


* Create an XML file to define a libvirt virtual network


wzxhzdk:17


* Create network in LibVirt


wzxhzdk:18


--&gt;</content><category term="virtualization"></category><category term="Gentoo"></category></entry><entry><title>How to install Canon Selphy CP400</title><link href="http://didier.bernaudeau.net/How_to_install_canon_selphy_cp400.html" rel="alternate"></link><published>2016-09-05T22:26:00+02:00</published><updated>2016-09-16T22:56:00+02:00</updated><author><name>Didier BERNAUDEAU</name></author><id>tag:didier.bernaudeau.net,2016-09-05:/How_to_install_canon_selphy_cp400.html</id><summary type="html">&lt;p&gt;This tutorial describe how to install a portable photo printer (Canon Selphy CP400). This device is normaly use for direct printing with Canon compact digital camera. But, this uncommon printer is pretty well supported by cups with gutenprint driver.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;This tutorial describe how to install a portable photo printer (Canon Selphy CP400). This device is normaly use for direct printing with Canon compact digital camera. But, this uncommon printer is pretty well supported by cups with gutenprint driver.&lt;/p&gt;

&lt;p align="center"&gt;
&lt;img class="img-responsive" src="images/2016-09-10_How_to_install_canon_selphy_cp400_Printer.jpg"&gt;
&lt;/img&gt;&lt;/p&gt;
&lt;h1&gt;Kernel configuration&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Add support for USB printer.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; make menuconfig

&lt;span class="go"&gt;  Device Drivers  ---&amp;gt;&lt;/span&gt;
&lt;span class="go"&gt;    [*] USB support  ---&amp;gt;&lt;/span&gt;
&lt;span class="go"&gt;      &amp;lt;*&amp;gt;     USB Printer support&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Install Cups and GutenPrint&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Define compilation option&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; nano /etc/portage/package.use

&lt;span class="go"&gt;net-print/gutenprint            gimp gtk&lt;/span&gt;
&lt;span class="go"&gt;net-print/cups                  -usb&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Install&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; emerge -pv cups gutenprint
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Start Cups&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; systemctl start cups.service
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Add printer&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Open administration page : &lt;a href="http://localhost:631/admin"&gt;http://localhost:631/admin&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p align="center"&gt;
&lt;img class="img-responsive" src="images/2016-09-10_How_to_install_canon_selphy_cp400_01.png"&gt;
&lt;br/&gt;&lt;br/&gt;
&lt;img class="img-responsive" src="images/2016-09-10_How_to_install_canon_selphy_cp400_02.png"&gt;
&lt;br/&gt;&lt;br/&gt;
&lt;img class="img-responsive" src="images/2016-09-10_How_to_install_canon_selphy_cp400_03.png"&gt;
&lt;br/&gt;&lt;br/&gt;
&lt;img class="img-responsive" src="images/2016-09-10_How_to_install_canon_selphy_cp400_04.png"&gt;
&lt;/img&gt;&lt;/img&gt;&lt;/img&gt;&lt;/img&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Configure Cups client&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; nano /etc/cups/client.conf
&lt;span class="go"&gt;ServerName localhost&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Test printing&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Scale an image with Gimp (ratio : 100x148mm)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Define print options (with Gimp) :&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Page setup : check orientation&lt;/li&gt;
&lt;li&gt;Image setting : increase size until maximum&lt;/li&gt;
&lt;li&gt;Advanced : borderless = yes&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;</content><category term="hardware"></category><category term="cups"></category><category term="Gentoo"></category></entry><entry><title>How to create your PKI with EJBCA</title><link href="http://didier.bernaudeau.net/How_To_create_your_pki_with_EJBCA.html" rel="alternate"></link><published>2016-07-06T18:18:00+02:00</published><updated>2016-07-06T18:18:00+02:00</updated><author><name>Didier BERNAUDEAU</name></author><id>tag:didier.bernaudeau.net,2016-07-06:/How_To_create_your_pki_with_EJBCA.html</id><summary type="html">&lt;p&gt;This post describe step by step how to install EJBCA on Linux Debian with Wildfly 10. Then, create your Certificate Authority to issue certificate.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;This post describe step by step how to install EJBCA on Linux Debian with Wildfly 10. Then, create your Certificate Authority to issue certificate.&lt;/p&gt;

&lt;h1&gt;Install Debian&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Define the hostname : pki.intra.net&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;change time zone for UTC&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; dpkg-reconfigure tzdata
&lt;span class="go"&gt;Geographic area : none of the above&lt;/span&gt;
&lt;span class="go"&gt;Time zone : UTC&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Install NTP&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; apt-get install ntp
&lt;span class="gp"&gt;#&lt;/span&gt; nano /etc/ntp.conf
&lt;span class="go"&gt;server 0.fr.pool.ntp.org&lt;/span&gt;
&lt;span class="go"&gt;server 1.fr.pool.ntp.org&lt;/span&gt;
&lt;span class="go"&gt;server 2.fr.pool.ntp.org&lt;/span&gt;
&lt;span class="go"&gt;server 3.fr.pool.ntp.org&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Print date &amp;amp; time&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; timedatectl
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Install MariaDB&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Install MariaDB server&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; apt-get install mariadb-server
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Start and enable MariaDB&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; systemctl start mysql.service
&lt;span class="gp"&gt;#&lt;/span&gt; systemctl &lt;span class="nb"&gt;enable&lt;/span&gt; mysql.service
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Create database&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; mysql -u root -p
&lt;span class="go"&gt;MariaDB&amp;gt; CREATE DATABASE ejbca CHARACTER SET utf8 COLLATE utf8_general_ci;&lt;/span&gt;
&lt;span class="go"&gt;MariaDB&amp;gt; GRANT ALL PRIVILEGES ON ejbca.* TO 'ejbca'@'localhost' IDENTIFIED BY 'ejbca';&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Install Java&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Download JDK from Oracle&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; wget --header &lt;span class="s2"&gt;"Cookie: oraclelicense=accept-securebackup-cookie"&lt;/span&gt; http://download.oracle.com/otn-pub/java/jdk/8u92-b14/jdk-8u92-linux-x64.tar.gz
&lt;span class="gp"&gt;#&lt;/span&gt; tar -zxf jdk-8u92-linux-x64.tar.gz -C /opt/
&lt;span class="gp"&gt;#&lt;/span&gt; ln -s /opt/jdk1.8.0_92 /opt/jdk
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Make a new JDK alternatives&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; update-alternatives --install /usr/bin/java java /opt/jdk/bin/java &lt;span class="m"&gt;100&lt;/span&gt;
&lt;span class="gp"&gt;#&lt;/span&gt; update-alternatives --install /usr/bin/javac javac /opt/jdk/bin/javac &lt;span class="m"&gt;100&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Update the default JDK&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; update-alternatives --config java
&lt;span class="gp"&gt;#&lt;/span&gt; update-alternatives --config javac
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Verification&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; java -version
&lt;span class="go"&gt;java version "1.8.0_92"&lt;/span&gt;
&lt;span class="go"&gt;Java(TM) SE Runtime Environment (build 1.8.0_92-b14)&lt;/span&gt;
&lt;span class="go"&gt;Java HotSpot(TM) 64-Bit Server VM (build 25.92-b14, mixed mode)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Install JCE (A priori inutile)&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; wget --header &lt;span class="s2"&gt;"Cookie: oraclelicense=accept-securebackup-cookie"&lt;/span&gt; http://download.oracle.com/otn-pub/java/jce/8/jce_policy-8.zip
&lt;span class="gp"&gt;#&lt;/span&gt; unzip jce_policy-8.zip
&lt;span class="gp"&gt;#&lt;/span&gt; mv /opt/jdk/jre/lib/security/local_policy.jar /opt/jdk/jre/lib/security/local_policy.jar.backup
&lt;span class="gp"&gt;#&lt;/span&gt; mv /opt/jdk/jre/lib/security/US_export_policy.jar /opt/jdk/jre/lib/security/US_export_policy.jar.backup
&lt;span class="gp"&gt;#&lt;/span&gt; cp UnlimitedJCEPolicyJDK8/local_policy.jar /opt/jdk/jre/lib/security/
&lt;span class="gp"&gt;#&lt;/span&gt; cp UnlimitedJCEPolicyJDK8/US_export_policy.jar /opt/jdk/jre/lib/security/
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Install Wildfly&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Create a wildfly user&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; groupadd -r wildfly
&lt;span class="gp"&gt;#&lt;/span&gt; useradd -r -g wildfly -d /opt/wildfly -s /sbin/nologin wildfly
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Download Wildfly from http://wildfly.org/downloads/&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; wget http://download.jboss.org/wildfly/10.0.0.Final/wildfly-10.0.0.Final.zip
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Decompress archive&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; unzip wildfly-10.0.0.Final.zip -d /opt
&lt;span class="gp"&gt;#&lt;/span&gt; ln -s /opt/wildfly-10.0.0.Final /opt/wildfly
&lt;span class="gp"&gt;#&lt;/span&gt; chown -Rf wildfly:wildfly /opt/wildfly
&lt;span class="gp"&gt;#&lt;/span&gt; chown -Rf wildfly:wildfly /opt/wildfly-10.0.0.Final
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Copy script for systemd&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; mkdir /etc/wildfly
&lt;span class="gp"&gt;#&lt;/span&gt; cp /opt/wildfly/docs/contrib/scripts/systemd/wildfly.conf /etc/wildfly/
&lt;span class="gp"&gt;#&lt;/span&gt; cp /opt/wildfly/docs/contrib/scripts/systemd/wildfly.service /etc/systemd/system/
&lt;span class="gp"&gt;#&lt;/span&gt; cp /opt/wildfly/docs/contrib/scripts/systemd/launch.sh /opt/wildfly/bin/
&lt;span class="gp"&gt;#&lt;/span&gt; chmod +x /opt/wildfly/bin/launch.sh
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Edit configuration file (if required)&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; nano /opt/wildfly/standalone/configuration/standalone.xml
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Start and enable Wildfly&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; systemctl start wildfly.service
&lt;span class="gp"&gt;#&lt;/span&gt; systemctl &lt;span class="nb"&gt;enable&lt;/span&gt; wildfly.service
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Add user&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; /opt/wildfly/bin/add-user.sh
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Browse to http://pki.intra.net:8080 (website) or http://pki.intra.net:9990 (admin console)&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;Configure WildFly for EJBCA (Part 1/2)&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Download and install database driver for Java application&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; wget https://downloads.mariadb.com/enterprise/80e4-qqsb/connectors/java/connector-java-1.4.6/mariadb-java-client-1.4.6.jar
&lt;span class="gp"&gt;#&lt;/span&gt; cp mariadb-java-client-1.4.6.jar /opt/wildfly/standalone/deployments/mariadb-java-client.jar
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Increase allowed memory usage&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; nano /opt/wildfly/bin/standalone.conf
&lt;span class="go"&gt;JAVA_OPTS="-Xms256m -Xmx512m -XX:MetaspaceSize=256M -XX:MaxMetaspaceSize=256m -Djava.net.preferIPv4Stack=true"&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Add datasource&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; /opt/wildfly/bin/jboss-cli.sh -c
&lt;span class="go"&gt;[standalone@localhost:9990 /] data-source add --name=ejbcads --driver-name="mariadb-java-client.jar" --connection-url="jdbc:mysql://127.0.0.1:3306/ejbca" --jndi-name="java:/EjbcaDS" --use-ccm=true --driver-class="org.mariadb.jdbc.Driver" --user-name="ejbca" --password="ejbca" --validate-on-match=true --background-validation=false --prepared-statements-cache-size=50 --share-prepared-statements=true --min-pool-size=5 --max-pool-size=150 --pool-prefill=true --transaction-isolation=TRANSACTION_READ_COMMITTED --check-valid-connection-sql="select 1;"&lt;/span&gt;
&lt;span class="go"&gt;[standalone@localhost:9990 /] :reload&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Configure WildFly Remoting&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="go"&gt;[standalone@localhost:9990 /] /subsystem=remoting/http-connector=http-remoting-connector:remove&lt;/span&gt;
&lt;span class="go"&gt;[standalone@localhost:9990 /] /subsystem=remoting/http-connector=http-remoting-connector:add(connector-ref="remoting",security-realm="ApplicationRealm")&lt;/span&gt;
&lt;span class="go"&gt;[standalone@localhost:9990 /] /socket-binding-group=standard-sockets/socket-binding=remoting:add(port="4447")&lt;/span&gt;
&lt;span class="go"&gt;[standalone@localhost:9990 /] /subsystem=undertow/server=default-server/http-listener=remoting:add(socket-binding=remoting)&lt;/span&gt;
&lt;span class="go"&gt;[standalone@localhost:9990 /] :reload&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Configure logging&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;/!\ DEBUG enabled for this example.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="go"&gt;[standalone@localhost:9990 /] /subsystem=logging/logger=org.ejbca:add&lt;/span&gt;
&lt;span class="go"&gt;[standalone@localhost:9990 /] /subsystem=logging/logger=org.ejbca:write-attribute(name=level, value=DEBUG)&lt;/span&gt;
&lt;span class="go"&gt;[standalone@localhost:9990 /] /subsystem=logging/logger=org.cesecore:add&lt;/span&gt;
&lt;span class="go"&gt;[standalone@localhost:9990 /] /subsystem=logging/logger=org.cesecore:write-attribute(name=level, value=DEBUG)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Remove existing TLS and HTTP configuration&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="go"&gt;[standalone@localhost:9990 /] /subsystem=undertow/server=default-server/http-listener=default:remove&lt;/span&gt;
&lt;span class="go"&gt;[standalone@localhost:9990 /] /socket-binding-group=standard-sockets/socket-binding=http:remove&lt;/span&gt;
&lt;span class="go"&gt;[standalone@localhost:9990 /] :reload&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Check running&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="go"&gt;[standalone@localhost:9990 /] :read-attribute(name=server-state)&lt;/span&gt;
&lt;span class="go"&gt;{&lt;/span&gt;
&lt;span class="go"&gt;    "outcome" =&amp;gt; "success",&lt;/span&gt;
&lt;span class="go"&gt;    "result" =&amp;gt; "running"&lt;/span&gt;
&lt;span class="go"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Check datasource connection&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="go"&gt;[standalone@localhost:9990 /] /subsystem=datasources/data-source=ejbcads:test-connection-in-pool&lt;/span&gt;
&lt;span class="go"&gt;{&lt;/span&gt;
&lt;span class="go"&gt;    "outcome" =&amp;gt; "success",&lt;/span&gt;
&lt;span class="go"&gt;    "result" =&amp;gt; [true]&lt;/span&gt;
&lt;span class="go"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Install EJBCA&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;install dependencies&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; apt-get install ant ant-optional unzip
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Download EJBCA (version 6.3.1.1)&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; wget http://downloads.sourceforge.net/project/ejbca/ejbca6/ejbcare th_6_3_1_1/ejbca_ce_6_3_1_1.zip
&lt;span class="gp"&gt;#&lt;/span&gt; unzip ejbca_ce_6_3_1_1.zip -d /opt/
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Edit configuration file&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; cp /opt/ejbca_ce_6_3_1_1/conf/ejbca.properties.sample /opt/ejbca_ce_6_3_1_1/conf/ejbca.properties
&lt;span class="gp"&gt;#&lt;/span&gt; nano /opt/ejbca_ce_6_3_1_1/conf/ejbca.properties

&lt;span class="go"&gt;appserver.home=/opt/wildfly&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; cp /opt/ejbca_ce_6_3_1_1/conf/web.properties.sample /opt/ejbca_ce_6_3_1_1/conf/web.properties
&lt;span class="gp"&gt;#&lt;/span&gt; nano /opt/ejbca_ce_6_3_1_1/conf/web.properties

&lt;span class="go"&gt;httpsserver.hostname=pki.intra.net&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; cp /opt/ejbca_ce_6_3_1_1/conf/database.properties.sample /opt/ejbca_ce_6_3_1_1/conf/database.properties
&lt;span class="gp"&gt;#&lt;/span&gt; nano /opt/ejbca_ce_6_3_1_1/conf/database.properties

&lt;span class="go"&gt;database.name=mysql&lt;/span&gt;
&lt;span class="go"&gt;database.url=jdbc:mysql://127.0.0.1:3306/ejbca?characterEncoding=UTF-8&lt;/span&gt;
&lt;span class="go"&gt;database.driver=org.mariadb.jdbc.Driver&lt;/span&gt;
&lt;span class="go"&gt;database.username=ejbca&lt;/span&gt;
&lt;span class="go"&gt;database.password=ejbca&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Build and deploy EJBCA&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; &lt;span class="nb"&gt;cd&lt;/span&gt; /opt/ejbca_ce_6_3_1_1/
&lt;span class="gp"&gt;#&lt;/span&gt; ant clean deployear
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Install&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; ant runinstall
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Deploy TLS keystores to WildFly&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; ant deploy-keystore
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Configure WildFly for EJBCA (Part 2/2)&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Configure TLS&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; /opt/wildfly/bin/jboss-cli.sh -c
&lt;span class="go"&gt;[standalone@localhost:9990 /] /interface=http:add(inet-address="0.0.0.0")&lt;/span&gt;
&lt;span class="go"&gt;[standalone@localhost:9990 /] /interface=httpspub:add(inet-address="0.0.0.0")&lt;/span&gt;
&lt;span class="go"&gt;[standalone@localhost:9990 /] /interface=httpspriv:add(inet-address="0.0.0.0")&lt;/span&gt;
&lt;span class="go"&gt;[standalone@localhost:9990 /] /socket-binding-group=standard-sockets/socket-binding=http:add(port="8080",interface="http")&lt;/span&gt;
&lt;span class="go"&gt;[standalone@localhost:9990 /] /subsystem=undertow/server=default-server/http-listener=http:add(socket-binding=http)&lt;/span&gt;
&lt;span class="go"&gt;[standalone@localhost:9990 /] /subsystem=undertow/server=default-server/http-listener=http:write-attribute(name=redirect-socket, value="httpspriv")&lt;/span&gt;
&lt;span class="go"&gt;[standalone@localhost:9990 /] :reload&lt;/span&gt;
&lt;span class="go"&gt;[standalone@localhost:9990 /] :read-attribute(name=server-state)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Configure identities and socket bindings:&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="go"&gt;[standalone@localhost:9990 /] /core-service=management/security-realm=SSLRealm:add()&lt;/span&gt;
&lt;span class="gp"&gt;[standalone@localhost:9990 /] /core-service=management/security-realm=SSLRealm/server-identity=ssl:add(keystore-path="$&lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;jboss.server.config.dir&lt;span class="o"&gt;}&lt;/span&gt;/keystore/keystore.jks&lt;span class="s2"&gt;", keystore-password="&lt;/span&gt;serverpwd&lt;span class="s2"&gt;", alias="&lt;/span&gt;prod-ica1&lt;span class="s2"&gt;")&lt;/span&gt;
&lt;span class="gp"&gt;[standalone@localhost:9990 /] /core-service=management/security-realm=SSLRealm/authentication=truststore:add(keystore-path="$&lt;/span&gt;&lt;span class="s2"&gt;{jboss.server.config.dir}/keystore/truststore.jks"&lt;/span&gt;, keystore-password&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"changeit"&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="go"&gt;[standalone@localhost:9990 /] /socket-binding-group=standard-sockets/socket-binding=httpspriv:add(port="8443",interface="httpspriv")&lt;/span&gt;
&lt;span class="go"&gt;[standalone@localhost:9990 /] /socket-binding-group=standard-sockets/socket-binding=httpspub:add(port="8442", interface="httpspub")&lt;/span&gt;
&lt;span class="go"&gt;[standalone@localhost:9990 /] :reload&lt;/span&gt;
&lt;span class="go"&gt;[standalone@localhost:9990 /] :read-attribute(name=server-state)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Wait then continous&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="go"&gt;[standalone@localhost:9990 /] /subsystem=undertow/server=default-server/https-listener=httpspriv:add(socket-binding=httpspriv, security-realm="SSLRealm", verify-client=REQUIRED)&lt;/span&gt;
&lt;span class="go"&gt;[standalone@localhost:9990 /] /subsystem=undertow/server=default-server/https-listener=httpspub:add(socket-binding=httpspub, security-realm="SSLRealm")&lt;/span&gt;
&lt;span class="go"&gt;[standalone@localhost:9990 /] :reload&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Finalize Wildfly configurations&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="go"&gt;[standalone@localhost:9990 /] /system-property=org.apache.tomcat.util.buf.UDecoder.ALLOW_ENCODED_SLASH:add(value=true)&lt;/span&gt;
&lt;span class="go"&gt;[standalone@localhost:9990 /] /system-property=org.apache.catalina.connector.CoyoteAdapter.ALLOW_BACKSLASH:add(value=true)&lt;/span&gt;
&lt;span class="go"&gt;[standalone@localhost:9990 /] /system-property=org.apache.catalina.connector.URI_ENCODING:add(value="UTF-8")&lt;/span&gt;
&lt;span class="go"&gt;[standalone@localhost:9990 /] /system-property=org.apache.catalina.connector.USE_BODY_ENCODING_FOR_QUERY_STRING:add(value=true)&lt;/span&gt;
&lt;span class="go"&gt;[standalone@localhost:9990 /] /subsystem=webservices:write-attribute(name=wsdl-host, value=jbossws.undefined.host)&lt;/span&gt;
&lt;span class="go"&gt;[standalone@localhost:9990 /] /subsystem=webservices:write-attribute(name=modify-wsdl-address, value=true)&lt;/span&gt;
&lt;span class="go"&gt;[standalone@localhost:9990 /] :reload&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;open https://pki.intra.net:8443/ejbca/adminweb/&lt;/p&gt;
&lt;!-- https://www.ejbca.org/docs/installation.html#WildFly 10 --&gt;
&lt;h2&gt;Error (To be solved)&lt;/h2&gt;
&lt;p&gt;tail -f /opt/wildfly/standalone/log/server.log -n 10000 | grep ERROR&lt;/p&gt;
&lt;p&gt;ERROR [org.jboss.msc.service.fail] (MSC service thread 1-1) MSC000001: Failed to start service jboss.server.controller.management.security_realm.SSLRealm.trust-manager: org.jboss.msc.service.StartException in service jboss.server.controller.management.security_realm.SSLRealm.trust-manager: WFLYDM0018: Unable to start service&lt;/p&gt;</content><category term="Certificate"></category><category term="Debian"></category></entry><entry><title>How to migrate from OpenRC to SystemD</title><link href="http://didier.bernaudeau.net/How_to_migrate_from_OpenRC_to_SystemD.html" rel="alternate"></link><published>2016-01-01T19:20:00+01:00</published><updated>2016-02-25T12:26:00+01:00</updated><author><name>Didier Bernaudeau</name></author><id>tag:didier.bernaudeau.net,2016-01-01:/How_to_migrate_from_OpenRC_to_SystemD.html</id><summary type="html">&lt;p&gt;SystemD is an initialization system for Linux created in 2010. Now, most of Linux distribution (Debian, Arch, ...) use SystemD instead of original initialization system (sysvinit, upstart, ...).&lt;/p&gt;
&lt;p&gt;However, the default initialization system used by Gentoo Linux is OpenRC which is slower than SystemD. This article describes how to replace OpenRC by SystemD on Gentoo Linux.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;SystemD is an initialization system for Linux created in 2010. Now, most of Linux distribution (Debian, Arch, ...) use SystemD instead of original initialization system (sysvinit, upstart, ...).&lt;/p&gt;
&lt;p&gt;However, the default initialization system used by Gentoo Linux is OpenRC which is slower than SystemD. This article describes how to replace OpenRC by SystemD on Gentoo Linux.&lt;/p&gt;

&lt;div class="section" id="kernel-configuration"&gt;
&lt;h2&gt;Kernel configuration&lt;/h2&gt;
&lt;pre class="code ini literal-block"&gt;
&lt;span class="na"&gt;| Gentoo Linux ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |     Support for init systems, system and service managers ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |      | [ ] OpenRC, runit and other script based systems and managers&lt;/span&gt;
&lt;span class="na"&gt;|      |      | [*] systemd&lt;/span&gt;
&lt;span class="na"&gt;|&lt;/span&gt;
&lt;span class="na"&gt;| General setup  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      | [*] Configure standard kernel features (expert users)  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |      | [*] Enable eventpoll support&lt;/span&gt;
&lt;span class="na"&gt;|      |      | [*] Enable signalfd() system call&lt;/span&gt;
&lt;span class="na"&gt;|      |      | [*] Enable timerfd() system call&lt;/span&gt;
&lt;span class="na"&gt;|&lt;/span&gt;
&lt;span class="na"&gt;| Processor type and features  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      | (root&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;/dev/sda6 init=/usr/lib/systemd/systemd) Built-in kernel command string&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;Another options are mandatory or recommended but they are already enabled. More informations on &lt;a class="reference external" href="https://wiki.gentoo.org/wiki/Systemd"&gt;wiki.gentoo.org/wiki/Systemd&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="systemd-installation"&gt;
&lt;h2&gt;Systemd installation&lt;/h2&gt;
&lt;p&gt;Select profil for systemd (default/linux/amd64/13.0/desktop/kde/systemd)&lt;/p&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;#&lt;/span&gt; eselect profile list
&lt;span class="gp"&gt;#&lt;/span&gt; eselect profile &lt;span class="nb"&gt;set&lt;/span&gt; &lt;span class="m"&gt;7&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;Update system&lt;/p&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;#&lt;/span&gt; emerge -DN @world
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="systemd-configuration"&gt;
&lt;h2&gt;Systemd configuration&lt;/h2&gt;
&lt;p&gt;Define hostname&lt;/p&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;#&lt;/span&gt; nano /etc/hostname
&lt;span class="go"&gt;lenovo&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;Define keyboard layout&lt;/p&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;#&lt;/span&gt; localectl list-keymaps
&lt;span class="gp"&gt;#&lt;/span&gt; localectl set-keymap fr-latin9
&lt;/pre&gt;
&lt;p&gt;Define time zone&lt;/p&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;#&lt;/span&gt; timedatectl list-timezones
&lt;span class="gp"&gt;#&lt;/span&gt; timedatectl set-timezone Europe/Paris
&lt;/pre&gt;
&lt;p&gt;Define NTP client&lt;/p&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;#&lt;/span&gt; nano /etc/systemd/timesyncd.conf
&lt;/pre&gt;
&lt;pre class="code ini literal-block"&gt;
&lt;span class="na"&gt;NTP&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;0.fr.pool.ntp.org 1.fr.pool.ntp.org 2.fr.pool.ntp.org 3.fr.pool.ntp.org&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;Start NTP client&lt;/p&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;#&lt;/span&gt; systemctl &lt;span class="nb"&gt;enable&lt;/span&gt; systemd-timesyncd
&lt;span class="gp"&gt;#&lt;/span&gt; systemctl start systemd-timesyncd
&lt;span class="gp"&gt;#&lt;/span&gt; timedatectl set-ntp &lt;span class="nb"&gt;true&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;Check NTP client&lt;/p&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;#&lt;/span&gt; timedatectl status
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="enable-services"&gt;
&lt;h2&gt;Enable services&lt;/h2&gt;
&lt;p&gt;KDM (KDE Display Manager)&lt;/p&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;#&lt;/span&gt; systemctl &lt;span class="nb"&gt;enable&lt;/span&gt; kdm.service
&lt;/pre&gt;
&lt;p&gt;NetworkManager&lt;/p&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;#&lt;/span&gt; systemctl &lt;span class="nb"&gt;enable&lt;/span&gt; NetworkManager.service
&lt;/pre&gt;
&lt;p&gt;NFS (Network File System)&lt;/p&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;#&lt;/span&gt; systemctl &lt;span class="nb"&gt;enable&lt;/span&gt; nfs-client.target
&lt;/pre&gt;
&lt;p&gt;AutoFS&lt;/p&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;#&lt;/span&gt; systemctl &lt;span class="nb"&gt;enable&lt;/span&gt; autofs.service
&lt;/pre&gt;
&lt;p&gt;libVirtd&lt;/p&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;#&lt;/span&gt; systemctl stop libvirtd
&lt;/pre&gt;
&lt;/div&gt;
</content><category term="Gentoo"></category></entry><entry><title>How to install Chromium with Flash support (Deprecated)</title><link href="http://didier.bernaudeau.net/How_to_install_Chromium_with_Flash_support.html" rel="alternate"></link><published>2015-10-23T23:24:00+02:00</published><updated>2017-01-14T12:55:00+01:00</updated><author><name>Didier Bernaudeau</name></author><id>tag:didier.bernaudeau.net,2015-10-23:/How_to_install_Chromium_with_Flash_support.html</id><summary type="html">&lt;p&gt;In 2012, Adobe has stopped to upgrade Flash Player for Linux. So, the last version of Flash Player plugin is 11.2 that will be maintained until 2017. To continue to take the advantage of Flash content, we must find an alternative solution.&lt;/p&gt;
&lt;p&gt;This tutorial describes how to install Chromium and the Flash Pepper Plugin (PPAPI) on Gentoo Linux and how to configure Chromium for graphic hardware acceleration.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;In 2012, Adobe has stopped to upgrade Flash Player for Linux. So, the last version of Flash Player plugin is 11.2 that will be maintained until 2017. To continue to take the advantage of Flash content, we must find an alternative solution.&lt;/p&gt;
&lt;p&gt;This tutorial describes how to install Chromium and the Flash Pepper Plugin (PPAPI) on Gentoo Linux and how to configure Chromium for graphic hardware acceleration.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; This tutorial is &lt;strong&gt;deprecated&lt;/strong&gt; because Google Chrome doesn't support Flash anymore. Even so, Adobe releases Flash Player 24 for Linux in December 2016. Now, all you have to do is to emerge the package "www-plugins/adobe-flash".&lt;/p&gt;
&lt;div class="section" id="chromium"&gt;
&lt;h2&gt;Chromium&lt;/h2&gt;
&lt;p&gt;Define local USE flags&lt;/p&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;#&lt;/span&gt; nano /etc/portage/package.use
&lt;span class="gp"&gt;&amp;gt;&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;media-libs/libvpx-1.4.0       postproc
&lt;/pre&gt;
&lt;p&gt;Install Chromium&lt;/p&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;#&lt;/span&gt; emerge chromium
&lt;/pre&gt;
&lt;p&gt;To configure Chromium, open &lt;a class="reference external" href="chrome://flags"&gt;chrome://flags&lt;/a&gt; :&lt;/p&gt;
&lt;blockquote&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Override software rendering list : enable&lt;/li&gt;
&lt;li&gt;GPU rasterization : enable&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;To check if Chromium uses hardware acceleration, open &lt;a class="reference external" href="chrome://gpu"&gt;chrome://gpu&lt;/a&gt; and look under "Graphics Feature status". All (or at least most of) the features should say "hardware accelerated".&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="flash-player"&gt;
&lt;h2&gt;Flash Player&lt;/h2&gt;
&lt;p&gt;To get Chrome and its plugins, download the RPM package for Linux 64bits on &lt;a class="reference external" href="https://www.google.fr/chrome/"&gt;Google&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Extract files from RPM package&lt;/p&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;$&lt;/span&gt; rpmunpack google-chrome-stable_current_x86_64.rpm
&lt;/pre&gt;
&lt;p&gt;Print the Flash Player version&lt;/p&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;$&lt;/span&gt; cat google-chrome-stable_current_x86_64/opt/google/chrome/PepperFlash/manifest.json
&lt;/pre&gt;
&lt;p&gt;Copy the Flash Player file&lt;/p&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;#&lt;/span&gt; cp google-chrome-stable_current_x86_64/opt/google/chrome/PepperFlash/libpepflashplayer.so /usr/lib/chromium-browser/
&lt;/pre&gt;
&lt;p&gt;Add Flash Player to Chromium&lt;/p&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;#&lt;/span&gt; nano /etc/chromium/default
&lt;span class="go"&gt;CHROMIUM_FLAGS="--ppapi-flash-path=/usr/lib/chromium-browser/libpepflashplayer.so --ppapi-flash-version=20.0.0.228"&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;To get information about flash plugin, open &lt;a class="reference external" href="chrome://flash"&gt;chrome://flash&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
</content><category term="Gentoo"></category></entry><entry><title>How to install PulseAudio on Gentoo Linux</title><link href="http://didier.bernaudeau.net/How_to_install_PulseAudio.html" rel="alternate"></link><published>2015-10-19T17:24:00+02:00</published><updated>2018-01-21T18:05:00+01:00</updated><author><name>Didier BERNAUDEAU</name></author><id>tag:didier.bernaudeau.net,2015-10-19:/How_to_install_PulseAudio.html</id><summary type="html">&lt;p&gt;A sound server is software that manages the use of and access to audio devices. There are many sound server (JACK Audio Connection Kit, Enlightened Sound Daemon, ...) but PulseAudio is now an integral part of all relevant modern Linux distributions. This tutorials describes how to install PulseAudio on Gentoo Linux.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;A sound server is software that manages the use of and access to audio devices. There are many sound server (JACK Audio Connection Kit, Enlightened Sound Daemon, ...) but PulseAudio is now an integral part of all relevant modern Linux distributions. This tutorials describes how to install PulseAudio on Gentoo Linux.&lt;/p&gt;

&lt;h1&gt;PulseAudio Architecture&lt;/h1&gt;
&lt;p align="center"&gt;&lt;img class="img-responsive" src="images/2015-10-19_How_to_install_PulseAudio.png" width="25%"/&gt;&lt;/p&gt;
&lt;h1&gt;Install PulseAudio&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Define local USE flags&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; nano /etc/portage/package.use
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;media-sound/pulseaudio          -tcpd -webrtc-aec
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Install PulseAudio&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; emerge --oneshot pulseaudio
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Configure capture device&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;List all capture devices&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; arecord -l
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;****&lt;/span&gt; &lt;span class="n"&gt;List&lt;/span&gt; &lt;span class="n"&gt;of&lt;/span&gt; &lt;span class="n"&gt;CAPTURE&lt;/span&gt; &lt;span class="n"&gt;Hardware&lt;/span&gt; &lt;span class="n"&gt;Devices&lt;/span&gt; &lt;span class="o"&gt;****&lt;/span&gt;
&lt;span class="n"&gt;card&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;PCH&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;HDA&lt;/span&gt; &lt;span class="n"&gt;Intel&lt;/span&gt; &lt;span class="n"&gt;PCH&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;device&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;ALC3232&lt;/span&gt; &lt;span class="n"&gt;Analog&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ALC3232&lt;/span&gt; &lt;span class="n"&gt;Analog&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
  &lt;span class="nl"&gt;Subdevices&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
  &lt;span class="n"&gt;Subdevice&lt;/span&gt; &lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;subdevice&lt;/span&gt; &lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The card number is "1" and device number is "0". So, In hw:CARD,DEVICE notation, the capture device is hw:1,0.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Define the capture device to load audio drivers statically&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; nano /etc/pulse/default.pa
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;load-module module-alsa-source device=hw:1,0
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Restart pulse (by non-root user)&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; pulseaudio -k &lt;span class="p"&gt;;&lt;/span&gt; pulseaudio -D
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Compile application to support PulseAudio&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Define global USE flags&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; nano etc/portage/make.conf
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;USE="pulseaudio"
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Install packages&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; emerge ffmpeg vlc kmix chromium
&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;Configure Chromium for Hangout&lt;/h2&gt;
&lt;p align="center"&gt;&lt;img class="img-responsive" src="images/2015-10-19_How_to_install_PulseAudio_2.png" width="50%"/&gt;&lt;/p&gt;</content><category term="Gentoo"></category></entry><entry><title>HowTo install a virtualization plateform with KVM</title><link href="http://didier.bernaudeau.net/howto_install_a_virtualization_plateform_with_KVM.html" rel="alternate"></link><published>2015-09-15T19:08:00+02:00</published><updated>2017-06-20T22:07:00+02:00</updated><author><name>Didier Bernaudeau</name></author><id>tag:didier.bernaudeau.net,2015-09-15:/howto_install_a_virtualization_plateform_with_KVM.html</id><summary type="html">&lt;p&gt;This tutorial describes how to install a virtualization plateform with KVM (Kernel-based Virtual Machine) on Gentoo Linux. This plateform is based on Kernel modules, QEMU (Quick Emulator), VirtIO and VHostNet.&lt;/p&gt;
&lt;p&gt;Then, LibVirt provides a convenient way to manage virtual machines on this plateform. LibVirt include an API library, a daemon (libvirtd), command line tools (virsh and virt-install) and a graphic tool (virt-manager). All these softwares are sponsorted by Red Hat.&lt;/p&gt;
&lt;p&gt;Obviouly, this virtualization plateform uses Intel Virtualization Technologyy like VT-x (Virtualization Technology eXecution) and VT-d (Virtualization Technology for Directed I/O). KVM can also support VT-c (Intel® Virtualization Technology for Connectivity) but my laptop does not have this technology.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;This tutorial describes how to install a virtualization plateform with KVM (Kernel-based Virtual Machine) on Gentoo Linux. This plateform is based on Kernel modules, QEMU (Quick Emulator), VirtIO and VHostNet.&lt;/p&gt;
&lt;p&gt;Then, LibVirt provides a convenient way to manage virtual machines on this plateform. LibVirt include an API library, a daemon (libvirtd), command line tools (virsh and virt-install) and a graphic tool (virt-manager). All these softwares are sponsorted by Red Hat.&lt;/p&gt;
&lt;p&gt;Obviouly, this virtualization plateform uses Intel Virtualization Technologyy like VT-x (Virtualization Technology eXecution) and VT-d (Virtualization Technology for Directed I/O). KVM can also support VT-c (Intel® Virtualization Technology for Connectivity) but my laptop does not have this technology.&lt;/p&gt;

&lt;div class="section" id="kernel-configuration"&gt;
&lt;h2&gt;Kernel configuration&lt;/h2&gt;
&lt;p&gt;This is the configuration for Gentoo kernel 4.9.16.&lt;/p&gt;
&lt;p&gt;Enable KVM&lt;/p&gt;
&lt;pre class="code ini literal-block"&gt;
&lt;span class="na"&gt;| [*] Virtualization  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      | --- Virtualization&lt;/span&gt;
&lt;span class="na"&gt;|      | &amp;lt;*&amp;gt;   Kernel-based Virtual Machine (KVM) support&lt;/span&gt;
&lt;span class="na"&gt;|      | &amp;lt;*&amp;gt;     KVM for Intel processors support&lt;/span&gt;
&lt;span class="na"&gt;|      | &amp;lt; &amp;gt;     KVM for AMD processors support (NEW)&lt;/span&gt;
&lt;span class="na"&gt;|      | [ ]     Audit KVM MMU (NEW)&lt;/span&gt;
&lt;span class="na"&gt;|      | [ ]     KVM legacy PCI device assignment support&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;Enable VirtIO driver&lt;/p&gt;
&lt;pre class="code ini literal-block"&gt;
&lt;span class="na"&gt;|     Device Drivers  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |&lt;/span&gt;
&lt;span class="na"&gt;|      | [*] Network device support  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |        | &amp;lt;*&amp;gt;     Virtio network driver&lt;/span&gt;
&lt;span class="na"&gt;|      |&lt;/span&gt;
&lt;span class="na"&gt;|      |     Virtio drivers  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |        | &amp;lt;*&amp;gt; PCI driver for virtio devices&lt;/span&gt;
&lt;span class="na"&gt;|      |        | [*]   Support for legacy virtio draft 0.9.X and older devices (NEW)&lt;/span&gt;
&lt;span class="na"&gt;|      |        | &amp;lt;*&amp;gt; Virtio balloon driver&lt;/span&gt;
&lt;span class="na"&gt;|      |        | &amp;lt;*&amp;gt; Virtio input driver&lt;/span&gt;
&lt;span class="na"&gt;|      |        | &amp;lt;*&amp;gt; Platform bus driver for memory mapped virtio devices&lt;/span&gt;
&lt;span class="na"&gt;|      |        | [*]   Memory mapped virtio devices parameter parsing&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;Enable VHostNet&lt;/p&gt;
&lt;pre class="code ini literal-block"&gt;
&lt;span class="na"&gt;| [*] Virtualization  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      | --- Virtualization&lt;/span&gt;
&lt;span class="na"&gt;|      | &amp;lt;*&amp;gt;   Host kernel accelerator for virtio net (NEW)&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;Enable virtual network (Local bridge with NAT)&lt;/p&gt;
&lt;pre class="code ini literal-block"&gt;
&lt;span class="na"&gt;| [*] Networking support  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      | --- Networking support&lt;/span&gt;
&lt;span class="na"&gt;|      |       Networking options  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |&lt;/span&gt;
&lt;span class="na"&gt;|      |        | [*] Network packet filtering framework (Netfilter)  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |        |       | [*]   Advanced netfilter configuration&lt;/span&gt;
&lt;span class="na"&gt;|      |        |       |       Core Netfilter Configuration  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |        |       |       | &amp;lt;*&amp;gt;   ctmark target and match support&lt;/span&gt;
&lt;span class="na"&gt;|      |        |       |       | &amp;lt;*&amp;gt;   CHECKSUM target support&lt;/span&gt;
&lt;span class="na"&gt;|      |        |       | &amp;lt;*&amp;gt;   Ethernet Bridge tables (ebtables) support  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |        |       |       | &amp;lt;*&amp;gt;   ebt: nat table support&lt;/span&gt;
&lt;span class="na"&gt;|      |        |       |       | &amp;lt;*&amp;gt;   ebt: mark target support&lt;/span&gt;
&lt;span class="na"&gt;|      |        |&lt;/span&gt;
&lt;span class="na"&gt;|      |        | [*] QoS and/or fair queueing  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |        |       | &amp;lt;*&amp;gt;   Hierarchical Token Bucket (HTB)&lt;/span&gt;
&lt;span class="na"&gt;|      |        |       | &amp;lt;*&amp;gt;   Stochastic Fairness Queueing (SFQ)&lt;/span&gt;
&lt;span class="na"&gt;|      |        |       | &amp;lt;*&amp;gt;   Ingress Qdisc&lt;/span&gt;
&lt;span class="na"&gt;|      |        |       | &amp;lt;*&amp;gt;   Netfilter mark (FW)&lt;/span&gt;
&lt;span class="na"&gt;|      |        |       | &amp;lt;*&amp;gt;   Universal 32bit comparisons w/ hashing (U32)&lt;/span&gt;
&lt;span class="na"&gt;|      |        |       | [*]   Actions&lt;/span&gt;
&lt;span class="na"&gt;|      |        |       | &amp;lt;*&amp;gt;     Traffic Policing&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="installation"&gt;
&lt;h2&gt;Installation&lt;/h2&gt;
&lt;p&gt;Define compilation option&lt;/p&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;#&lt;/span&gt; nano /etc/portage/package.use
&lt;/pre&gt;
&lt;pre class="code ini literal-block"&gt;
&lt;span class="na"&gt;app-emulation/libvirt           qemu virt-network&lt;/span&gt;
&lt;span class="na"&gt;app-emulation/libvirt-glib      python&lt;/span&gt;
&lt;span class="na"&gt;app-emulation/qemu              qemu_softmmu_targets_x86_64 spice usbredir&lt;/span&gt;
&lt;span class="na"&gt;app-emulation/virt-manager      gtk sasl&lt;/span&gt;
&lt;span class="na"&gt;net-dns/dnsmasq                 script&lt;/span&gt;
&lt;span class="na"&gt;net-firewall/iptables           conntrack ipv6&lt;/span&gt;
&lt;span class="na"&gt;media-libs/mesa                 gles2&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;Start installation&lt;/p&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;#&lt;/span&gt; emerge libvirt virt-manager
&lt;/pre&gt;
&lt;p&gt;Disable authentication for LibVirtd (Only for socket access)&lt;/p&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;#&lt;/span&gt; nano /etc/libvirt/libvirtd.conf
&lt;/pre&gt;
&lt;pre class="code ini literal-block"&gt;
&lt;span class="na"&gt;auth_unix_ro&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;"none"&lt;/span&gt;
&lt;span class="na"&gt;auth_unix_rw&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;"none"&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;Change the default repository for disk images&lt;/p&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;#&lt;/span&gt; rmdir /var/lib/libvirt/images
&lt;span class="gp"&gt;#&lt;/span&gt; ln -s /mnt/data/VirtualMachine /var/lib/libvirt/images
&lt;/pre&gt;
&lt;p&gt;Add user in KVM group&lt;/p&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;#&lt;/span&gt; gpasswd -a &amp;lt;username&amp;gt; libvirt kvm
&lt;/pre&gt;
&lt;p&gt;Start libvirtd&lt;/p&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;#&lt;/span&gt; systemctl start libvirtd
&lt;span class="gp"&gt;#&lt;/span&gt; systemctl start virtlogd.socket
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="connection-to-libvirtd"&gt;
&lt;h2&gt;Connection to LibVirtd&lt;/h2&gt;
&lt;p&gt;Start virt-manager&lt;/p&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;$&lt;/span&gt; virt-manager
&lt;/pre&gt;
&lt;p&gt;Open the menu "file &amp;gt; Add connection"&lt;/p&gt;
&lt;img alt="Virt-Manager - Add connection" class="img-responsive align-center" src="http://didier.bernaudeau.net/images/2015-09-15_howto_install_a_virtualization_plateform_with_KVM_01.png" style="width: 50%;"/&gt;
&lt;/div&gt;
&lt;div class="section" id="network-configuration"&gt;
&lt;h2&gt;Network Configuration&lt;/h2&gt;
&lt;p&gt;After starting LibVirtd, network configuration is as follows:&lt;/p&gt;
&lt;img alt="Network Configuration" class="img-responsive align-center" src="http://didier.bernaudeau.net/images/2015-09-15_howto_install_a_virtualization_plateform_with_KVM_00.png" style="width: 50%;"/&gt;
&lt;/div&gt;
&lt;div class="section" id="create-a-virtual-machine"&gt;
&lt;h2&gt;Create a virtual machine&lt;/h2&gt;
&lt;p&gt;Open the menu "file &amp;gt; New Virtual Machine"&lt;/p&gt;
&lt;img alt="Virt-Manager - Step1" class="img-responsive align-center" src="http://didier.bernaudeau.net/images/2015-09-15_howto_install_a_virtualization_plateform_with_KVM_02.png" style="width: 50%;"/&gt;
&lt;img alt="Virt-Manager - Step2" class="img-responsive align-center" src="http://didier.bernaudeau.net/images/2015-09-15_howto_install_a_virtualization_plateform_with_KVM_03.png" style="width: 70%;"/&gt;
&lt;img alt="Virt-Manager - Step3" class="img-responsive align-center" src="http://didier.bernaudeau.net/images/2015-09-15_howto_install_a_virtualization_plateform_with_KVM_04.png" style="width: 50%;"/&gt;
&lt;img alt="Virt-Manager - Step4" class="img-responsive align-center" src="http://didier.bernaudeau.net/images/2015-09-15_howto_install_a_virtualization_plateform_with_KVM_05.png" style="width: 50%;"/&gt;
&lt;img alt="Virt-Manager - Step5" class="img-responsive align-center" src="http://didier.bernaudeau.net/images/2015-09-15_howto_install_a_virtualization_plateform_with_KVM_06.png" style="width: 50%;"/&gt;
&lt;p&gt;Select "VirtIO" device model for Network Interface&lt;/p&gt;
&lt;img alt="Virt-Manager - NIC device model" class="img-responsive align-center" src="http://didier.bernaudeau.net/images/2015-09-15_howto_install_a_virtualization_plateform_with_KVM_07.png" style="width: 70%;"/&gt;
&lt;!-- vhost=on --&gt;
&lt;/div&gt;
</content><category term="Gentoo"></category><category term="Virtualization"></category></entry><entry><title>How to create bootable USB flash drives with Rufus</title><link href="http://didier.bernaudeau.net/How_to_create_bootable_USB_flash_drives_with_Rufus.html" rel="alternate"></link><published>2015-07-12T12:32:00+02:00</published><updated>2015-07-15T21:45:00+02:00</updated><author><name>Didier Bernaudeau</name></author><id>tag:didier.bernaudeau.net,2015-07-12:/How_to_create_bootable_USB_flash_drives_with_Rufus.html</id><summary type="html">&lt;p&gt;This article describes how to create bootable USB flash drives from ISO image with Rufus. The advantages of this software is that it supports UEFI &amp;amp; GPT and can create installation media for Microsoft Windows 7/8. The  disadvantage is that it runs only on Microsoft Windows.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;This article describes how to create bootable USB flash drives from ISO image with Rufus. The advantages of this software is that it supports UEFI &amp;amp; GPT and can create installation media for Microsoft Windows 7/8. The  disadvantage is that it runs only on Microsoft Windows.&lt;/p&gt;

&lt;div class="section" id="install-rufus"&gt;
&lt;h2&gt;Install Rufus&lt;/h2&gt;
&lt;p&gt;Download the software on &lt;a class="reference external" href="https://rufus.akeo.ie/"&gt;rufus.akeo.ie&lt;/a&gt; then execute the application.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="create-installation-media"&gt;
&lt;h2&gt;Create installation media&lt;/h2&gt;
&lt;div class="section" id="example-for-microsoft-windows-8-1-with-mbr"&gt;
&lt;h3&gt;Example for Microsoft Windows 8.1 (with MBR)&lt;/h3&gt;
&lt;img alt="Rufus - Windows" class="img-responsive align-center" src="http://didier.bernaudeau.net/images/2015-07-12_How_to_create_bootable_USB_flash_drives_with_Rufus_01.png" style="width: 50%;"/&gt;
&lt;/div&gt;
&lt;div class="section" id="example-for-debian-8-with-mbr"&gt;
&lt;h3&gt;Example for Debian 8 (with MBR)&lt;/h3&gt;
&lt;img alt="Rufus - Windows" class="img-responsive align-center" src="http://didier.bernaudeau.net/images/2015-07-12_How_to_create_bootable_USB_flash_drives_with_Rufus_02.png" style="width: 50%;"/&gt;
&lt;img alt="Rufus - Windows" class="img-responsive align-center" src="http://didier.bernaudeau.net/images/2015-07-12_How_to_create_bootable_USB_flash_drives_with_Rufus_03.png" style="width: 50%;"/&gt;
&lt;p&gt;If you need additional firmware to install Debian :&lt;/p&gt;
&lt;blockquote&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Download the package "firmware-iwlwifi" (for Intel Wifi)&lt;/li&gt;
&lt;li&gt;Unpack the package&lt;/li&gt;
&lt;li&gt;Copy the file "&lt;tt class="docutils literal"&gt;*&lt;/tt&gt;.ucode" on another USB flash drive&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;/div&gt;
&lt;/div&gt;
</content><category term="Windows"></category><category term="Linux"></category></entry><entry><title>HowTo configure the Linux kernel for Lenovo ThinkPad X240</title><link href="http://didier.bernaudeau.net/HowTo-configure-the-Linux-kernel-for-Lenovo-ThinkPad-X240.html" rel="alternate"></link><published>2015-06-16T22:10:00+02:00</published><updated>2017-09-24T12:13:00+02:00</updated><author><name>Didier Bernaudeau</name></author><id>tag:didier.bernaudeau.net,2015-06-16:/HowTo-configure-the-Linux-kernel-for-Lenovo-ThinkPad-X240.html</id><summary type="html">&lt;p&gt;This article describes step by step how to configure the Linux Kernel for my Lenovo ThinkPad X240. This kernel must support Intel Haswell processor, all devices and UEFI bootloader without Grub.&lt;/p&gt;
&lt;p&gt;To get more information about the configuration of my laptop, you can read this article : &lt;a class="reference external" href="http://didier.bernaudeau.net/Laptop_Lenovo_ThinkPad_X240.html"&gt;Lenovo ThinkPad X240&lt;/a&gt;&lt;/p&gt;
</summary><content type="html">&lt;p&gt;This article describes step by step how to configure the Linux Kernel for my Lenovo ThinkPad X240. This kernel must support Intel Haswell processor, all devices and UEFI bootloader without Grub.&lt;/p&gt;
&lt;p&gt;To get more information about the configuration of my laptop, you can read this article : &lt;a class="reference external" href="http://didier.bernaudeau.net/Laptop_Lenovo_ThinkPad_X240.html"&gt;Lenovo ThinkPad X240&lt;/a&gt;&lt;/p&gt;

&lt;div class="section" id="kernel-installation"&gt;
&lt;h2&gt;Kernel installation&lt;/h2&gt;
&lt;p&gt;Download kernel Gentoo sources (4.12.12) :&lt;/p&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;#&lt;/span&gt; emerge sys-kernel/gentoo-sources
&lt;/pre&gt;
&lt;p&gt;Download firmware for Intel WiFi 7260 (version 16) :&lt;/p&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;#&lt;/span&gt; emerge sys-firmware/iwl7260-ucode
&lt;/pre&gt;
&lt;p&gt;or&lt;/p&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;#&lt;/span&gt; wget https://git.kernel.org/cgit/linux/kernel/git/iwlwifi/linux-firmware.git/plain/iwlwifi-7260-17.ucode
&lt;/pre&gt;
&lt;p&gt;Select kernel sources&lt;/p&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;#&lt;/span&gt; eselect kernel list
&lt;span class="gp"&gt;#&lt;/span&gt; eselect kernel &lt;span class="nb"&gt;set&lt;/span&gt; X
&lt;span class="gp"&gt;#&lt;/span&gt; &lt;span class="nb"&gt;cd&lt;/span&gt; /usr/src/linux
&lt;/pre&gt;
&lt;p&gt;Print configuration menu&lt;/p&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;#&lt;/span&gt; make menuconfig
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="kernel-minimal-configuration"&gt;
&lt;h2&gt;Kernel minimal configuration&lt;/h2&gt;
&lt;pre class="code ini literal-block"&gt;
&lt;span class="na"&gt;| Gentoo Linux ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |&lt;/span&gt;
&lt;span class="na"&gt;|      |     Support for init systems, system and service managers ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |      | [ ] OpenRC, runit and other script based systems and managers&lt;/span&gt;
&lt;span class="na"&gt;|      |      | [*] systemd&lt;/span&gt;
&lt;span class="na"&gt;|&lt;/span&gt;
&lt;span class="na"&gt;| General setup  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |&lt;/span&gt;
&lt;span class="na"&gt;|      |     Timers subsystem  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |      | [*] High Resolution Timer Support&lt;/span&gt;
&lt;span class="na"&gt;|      |&lt;/span&gt;
&lt;span class="na"&gt;| Processor type and features  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |&lt;/span&gt;
&lt;span class="na"&gt;|      | [*] Symmetric multi-processing support&lt;/span&gt;
&lt;span class="na"&gt;|      | [ ] Support for extended (non-PC) x86 platforms&lt;/span&gt;
&lt;span class="na"&gt;|      | [*] Intel Low Power Subsystem Support&lt;/span&gt;
&lt;span class="na"&gt;|      |     Processor family (Generic-x86-64)  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      | [ ] Old AMD GART IOMMU support&lt;/span&gt;
&lt;span class="na"&gt;|      | [ ] IBM Calgary IOMMU support&lt;/span&gt;
&lt;span class="na"&gt;|      | [ ] Enable Maximum number of SMP Processors and NUMA Nodes&lt;/span&gt;
&lt;span class="na"&gt;|      | [*] SMT (Hyperthreading) scheduler support&lt;/span&gt;
&lt;span class="na"&gt;|      | [*] Multi-core scheduler support&lt;/span&gt;
&lt;span class="na"&gt;|      | [*] Machine Check / overheating reporting&lt;/span&gt;
&lt;span class="na"&gt;|      | [*]   Intel MCE features (NEW)&lt;/span&gt;
&lt;span class="na"&gt;|      | [ ]   AMD MCE features&lt;/span&gt;
&lt;span class="na"&gt;|      | &amp;lt; &amp;gt; CPU microcode loading support&lt;/span&gt;
&lt;span class="na"&gt;|      | &amp;lt;*&amp;gt; /dev/cpu/*/msr - Model-specific register support&lt;/span&gt;
&lt;span class="na"&gt;|      | &amp;lt;*&amp;gt; /dev/cpu/*/cpuid - CPU information support&lt;/span&gt;
&lt;span class="na"&gt;|      | [ ] Numa Memory Allocation and Scheduler Support&lt;/span&gt;
&lt;span class="na"&gt;|      | [*] EFI runtime service support&lt;/span&gt;
&lt;span class="na"&gt;|      | [*]   EFI stub support&lt;/span&gt;
&lt;span class="na"&gt;|      | [*] Built-in kernel command line&lt;/span&gt;
&lt;span class="na"&gt;|      | (root&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;/dev/sda6 init=/usr/lib/systemd/systemd) Built-in kernel command string&lt;/span&gt;
&lt;span class="na"&gt;|&lt;/span&gt;
&lt;span class="na"&gt;| Power management and ACPI options  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |&lt;/span&gt;
&lt;span class="na"&gt;|      | [*] Suspend to RAM and standby&lt;/span&gt;
&lt;span class="na"&gt;|      | [*] Hibernation (aka 'suspend to disk')&lt;/span&gt;
&lt;span class="na"&gt;|      | (/dev/sda5) Default resume partition&lt;/span&gt;
&lt;span class="na"&gt;|      |&lt;/span&gt;
&lt;span class="na"&gt;|      | -*- Device power management core functionality&lt;/span&gt;
&lt;span class="na"&gt;|      | [ ]   Power Management Debug Support&lt;/span&gt;
&lt;span class="na"&gt;|      |&lt;/span&gt;
&lt;span class="na"&gt;|      | [*] ACPI (Advanced Configuration and Power Interface) Support  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |      | &amp;lt;*&amp;gt;   Processor&lt;/span&gt;
&lt;span class="na"&gt;|      |      | &amp;lt;*&amp;gt;   Processor Aggregator&lt;/span&gt;
&lt;span class="na"&gt;|      |&lt;/span&gt;
&lt;span class="na"&gt;|      |     CPU Frequency scaling  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |      | [*] CPU Frequency scaling&lt;/span&gt;
&lt;span class="na"&gt;|      |      | &amp;lt;*&amp;gt;   CPU frequency translation statistics&lt;/span&gt;
&lt;span class="na"&gt;|      |      | [*]     CPU frequency translation statistics details&lt;/span&gt;
&lt;span class="na"&gt;|      |      |       Default CPUFreq governor (conservative)  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |      | -*-   'performance' governor&lt;/span&gt;
&lt;span class="na"&gt;|      |      | &amp;lt;*&amp;gt;   'powersave' governor&lt;/span&gt;
&lt;span class="na"&gt;|      |      | &amp;lt;*&amp;gt;   'userspace' governor for userspace frequency scaling&lt;/span&gt;
&lt;span class="na"&gt;|      |      | &amp;lt;*&amp;gt;   'ondemand' cpufreq policy governor&lt;/span&gt;
&lt;span class="na"&gt;|      |      | -*-   'conservative' cpufreq governor&lt;/span&gt;
&lt;span class="na"&gt;|      |      |       *** CPU frequency scaling drivers ***&lt;/span&gt;
&lt;span class="na"&gt;|      |      | [*]   Intel P state control&lt;/span&gt;
&lt;span class="na"&gt;|      |      | &amp;lt; &amp;gt;   ACPI Processor P-States driver&lt;/span&gt;
&lt;span class="na"&gt;|      |&lt;/span&gt;
&lt;span class="na"&gt;|      |     CPU Idle  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |      | [*] CPU idle PM support&lt;/span&gt;
&lt;span class="na"&gt;|      |      | [ ]   Ladder governor (for periodic timer tick)&lt;/span&gt;
&lt;span class="na"&gt;|      |      | -*-   Menu governor (for tickless system)&lt;/span&gt;
&lt;span class="na"&gt;|      |&lt;/span&gt;
&lt;span class="na"&gt;|      | [*] Cpuidle Driver for Intel Processors&lt;/span&gt;
&lt;span class="na"&gt;|&lt;/span&gt;
&lt;span class="na"&gt;| [*] Networking support  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      | --- Networking support&lt;/span&gt;
&lt;span class="na"&gt;|      |       Networking options  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |        | [*] TCP/IP networking&lt;/span&gt;
&lt;span class="na"&gt;|      |        | &amp;lt;*&amp;gt;   The IPv6 protocol  ----&lt;/span&gt;
&lt;span class="na"&gt;|      |        | [ ]   NetLabel subsystem support&lt;/span&gt;
&lt;span class="na"&gt;|      |&lt;/span&gt;
&lt;span class="na"&gt;|      | [ ]   Amateur Radio support  ----&lt;/span&gt;
&lt;span class="na"&gt;|      |&lt;/span&gt;
&lt;span class="na"&gt;|      | -*-   Wireless  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |        | --- Wireless&lt;/span&gt;
&lt;span class="na"&gt;|      |        | &amp;lt;*&amp;gt;   cfg80211 - wireless configuration API&lt;/span&gt;
&lt;span class="na"&gt;|      |        | [*]     enable powersave by default&lt;/span&gt;
&lt;span class="na"&gt;|      |        | &amp;lt;*&amp;gt;   Generic IEEE 802.11 Networking Stack (mac80211)&lt;/span&gt;
&lt;span class="na"&gt;|      |        | [*]   Enable LED triggers&lt;/span&gt;
&lt;span class="na"&gt;|      |&lt;/span&gt;
&lt;span class="na"&gt;|      | &amp;lt;*&amp;gt;   RF switch subsystem support  ----&lt;/span&gt;
&lt;span class="na"&gt;|&lt;/span&gt;
&lt;span class="na"&gt;| Device Drivers  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |&lt;/span&gt;
&lt;span class="na"&gt;|      |     Generic Driver Options  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |      | [ ] Prevent firmware from being built&lt;/span&gt;
&lt;span class="na"&gt;|      |      | -*- Userspace firmware loading support&lt;/span&gt;
&lt;span class="na"&gt;|      |      | [*]   Include in-kernel firmware blobs in kernel binary&lt;/span&gt;
&lt;span class="na"&gt;|      |      | (iwlwifi-7260-17.ucode) External firmware blobs to build into the kernel binary&lt;/span&gt;
&lt;span class="na"&gt;|      |      | (/lib/firmware) Firmware blobs root directory&lt;/span&gt;
&lt;span class="na"&gt;|      |      | [*] Fallback user-helper invocation for firmware loading&lt;/span&gt;
&lt;span class="na"&gt;|      |      | [ ] Managed device resources verbose debug messages&lt;/span&gt;
&lt;span class="na"&gt;|      |&lt;/span&gt;
&lt;span class="na"&gt;|      | &amp;lt;*&amp;gt; Serial ATA and Parallel ATA drivers (libata)  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |      | [ ]   Verbose ATA error reporting&lt;/span&gt;
&lt;span class="na"&gt;|      |      | [*]   ATA ACPI Support&lt;/span&gt;
&lt;span class="na"&gt;|      |      | [ ]   SATA Port Multiplier support&lt;/span&gt;
&lt;span class="na"&gt;|      |      | &amp;lt;*&amp;gt;   AHCI SATA support&lt;/span&gt;
&lt;span class="na"&gt;|      |      | [ ]   ATA SFF support (for legacy IDE and PATA)&lt;/span&gt;
&lt;span class="na"&gt;|      |&lt;/span&gt;
&lt;span class="na"&gt;|      | [ ] Multiple devices driver support (RAID and LVM)  ----&lt;/span&gt;
&lt;span class="na"&gt;|      | [ ] Macintosh device drivers  ----&lt;/span&gt;
&lt;span class="na"&gt;|      |&lt;/span&gt;
&lt;span class="na"&gt;|      | [*] Network device support  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |      | --- Network device support&lt;/span&gt;
&lt;span class="na"&gt;|      |      | [*]   Ethernet driver support  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |      |        | --- Ethernet driver support&lt;/span&gt;
&lt;span class="na"&gt;|      |      |        | [*]   Intel devices&lt;/span&gt;
&lt;span class="na"&gt;|      |      |        | &amp;lt; &amp;gt;     Intel(R) PRO/100+ support&lt;/span&gt;
&lt;span class="na"&gt;|      |      |        | &amp;lt; &amp;gt;     Intel(R) PRO/1000 Gigabit Ethernet support&lt;/span&gt;
&lt;span class="na"&gt;|      |      |        | &amp;lt;*&amp;gt;     Intel(R) PRO/1000 PCI-Express Gigabit Ethernet support&lt;/span&gt;
&lt;span class="na"&gt;|      |      |        | [ ]     Intel (82586/82593/82596) devices&lt;/span&gt;
&lt;span class="na"&gt;|      |      |&lt;/span&gt;
&lt;span class="na"&gt;|      |      | &amp;lt; &amp;gt;   FDDI driver support&lt;/span&gt;
&lt;span class="na"&gt;|      |      | &amp;lt; &amp;gt;   PHY Device support and infrastructure  ----&lt;/span&gt;
&lt;span class="na"&gt;|      |      | &amp;lt; &amp;gt;   USB Network Adapters  ----&lt;/span&gt;
&lt;span class="na"&gt;|      |      |&lt;/span&gt;
&lt;span class="na"&gt;|      |      | [*]   Wireless LAN  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |      |        | --- Wireless LAN&lt;/span&gt;
&lt;span class="na"&gt;|      |      |        | &amp;lt;*&amp;gt;   Intel Wireless WiFi Next Gen AGN - Wireless-N/Advanced-N/Ultimate-N (iwlwifi)&lt;/span&gt;
&lt;span class="na"&gt;|      |      |        | &amp;lt; &amp;gt;     Intel Wireless WiFi DVM Firmware support&lt;/span&gt;
&lt;span class="na"&gt;|      |      |        | &amp;lt;*&amp;gt;     Intel Wireless WiFi MVM Firmware support&lt;/span&gt;
&lt;span class="na"&gt;|      |      |        | &amp;lt; &amp;gt;   Realtek rtlwifi family of devices  ----&lt;/span&gt;
&lt;span class="na"&gt;|      |&lt;/span&gt;
&lt;span class="na"&gt;|      |     Character devices  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |      | &amp;lt; &amp;gt; Hardware Random Number Generator Core support  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |&lt;/span&gt;
&lt;span class="na"&gt;|      |     I2C support  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |      | -*- I2C support&lt;/span&gt;
&lt;span class="na"&gt;|      |      | &amp;lt;*&amp;gt;   I2C device interface&lt;/span&gt;
&lt;span class="na"&gt;|      |      |       I2C Hardware Bus support  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |      |        | &amp;lt;*&amp;gt; Intel 82801 (ICH/PCH)&lt;/span&gt;
&lt;span class="na"&gt;|      |      |        | &amp;lt;*&amp;gt; SMBus Control Method Interface&lt;/span&gt;
&lt;span class="na"&gt;|      |&lt;/span&gt;
&lt;span class="na"&gt;|      | -*- Hardware Monitoring support  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |      | &amp;lt;*&amp;gt;   Intel Core/Core2/Atom temperature sensor&lt;/span&gt;
&lt;span class="na"&gt;|      |&lt;/span&gt;
&lt;span class="na"&gt;|      | -*- Generic Thermal sysfs driver  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |      |       Default Thermal governor (step_wise)  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |      | -*-   Step_wise thermal governor&lt;/span&gt;
&lt;span class="na"&gt;|      |      | &amp;lt;*&amp;gt;   Intel PowerClamp idle injection driver&lt;/span&gt;
&lt;span class="na"&gt;|      |      | &amp;lt;*&amp;gt;   X86 package temperature thermal driver&lt;/span&gt;
&lt;span class="na"&gt;|      |&lt;/span&gt;
&lt;span class="na"&gt;|      |     Multifunction device drivers  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |      | &amp;lt;*&amp;gt; Intel ICH LPC&lt;/span&gt;
&lt;span class="na"&gt;|      |      | &amp;lt;*&amp;gt; Realtek PCI-E card reader&lt;/span&gt;
&lt;span class="na"&gt;|      |&lt;/span&gt;
&lt;span class="na"&gt;|      | &amp;lt;*&amp;gt; Multimedia support  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |      | [*]   Cameras/video grabbers support&lt;/span&gt;
&lt;span class="na"&gt;|      |      | [*]   Media USB Adapters  ----&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |      |        | &amp;lt;*&amp;gt;   USB Video Class (UVC)&lt;/span&gt;
&lt;span class="na"&gt;|      |      |        | [*]     UVC input events device support (NEW)&lt;/span&gt;
&lt;span class="na"&gt;|      |      |        | &amp;lt; &amp;gt;   GSPCA based webcams  ----&lt;/span&gt;
&lt;span class="na"&gt;|      |&lt;/span&gt;
&lt;span class="na"&gt;|      |     Graphics support  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |      | &amp;lt;*&amp;gt; Direct Rendering Manager (XFree86 4.1.0 and higher DRI support)  ---&lt;/span&gt;
&lt;span class="na"&gt;|      |      | &amp;lt;*&amp;gt; Intel 8xx/9xx/G3x/G4x/HD Graphics&lt;/span&gt;
&lt;span class="na"&gt;|      |&lt;/span&gt;
&lt;span class="na"&gt;|      |     &amp;lt;*&amp;gt; Sound card support  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |      | &amp;lt;*&amp;gt;   Advanced Linux Sound Architecture  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |      |      | [*]   PCI sound devices  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |      |      |       HD-Audio  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |      |      |        | &amp;lt;*&amp;gt; HD Audio PCI&lt;/span&gt;
&lt;span class="na"&gt;|      |      |      |        | &amp;lt;*&amp;gt; Build Realtek HD-audio codec support&lt;/span&gt;
&lt;span class="na"&gt;|      |      |      |        | &amp;lt;*&amp;gt; Build HDMI/DisplayPort HD-audio codec support&lt;/span&gt;
&lt;span class="na"&gt;|      |      |      |&lt;/span&gt;
&lt;span class="na"&gt;|      |      |      | (2048) Pre-allocated buffer size for HD-audio driver&lt;/span&gt;
&lt;span class="na"&gt;|      |      |      |&lt;/span&gt;
&lt;span class="na"&gt;|      |      |      | [ ]   USB sound devices  ----&lt;/span&gt;
&lt;span class="na"&gt;|      |      |      | [ ]   PCMCIA sound devices  ----&lt;/span&gt;
&lt;span class="na"&gt;|      |&lt;/span&gt;
&lt;span class="na"&gt;|      | [*] USB support  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |      | &amp;lt;*&amp;gt;   Support for Host-side USB&lt;/span&gt;
&lt;span class="na"&gt;|      |      | &amp;lt; &amp;gt;     USB Monitor&lt;/span&gt;
&lt;span class="na"&gt;|      |      | &amp;lt;*&amp;gt;     xHCI HCD (USB 3.0) support&lt;/span&gt;
&lt;span class="na"&gt;|      |      | &amp;lt;*&amp;gt;     EHCI HCD (USB 2.0) support&lt;/span&gt;
&lt;span class="na"&gt;|      |      | &amp;lt; &amp;gt;     OHCI HCD (USB 1.1) support&lt;/span&gt;
&lt;span class="na"&gt;|      |      | &amp;lt; &amp;gt;     UHCI HCD (most Intel and VIA) support&lt;/span&gt;
&lt;span class="na"&gt;|      |      | &amp;lt; &amp;gt;     USB Printer support&lt;/span&gt;
&lt;span class="na"&gt;|      |&lt;/span&gt;
&lt;span class="na"&gt;|      | &amp;lt;*&amp;gt; MMC/SD/SDIO card support  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |      | &amp;lt;*&amp;gt;   Realtek PCI-E SD/MMC Card Interface Driver&lt;/span&gt;
&lt;span class="na"&gt;|      |&lt;/span&gt;
&lt;span class="na"&gt;|      | [*] X86 Platform Specific Device Drivers  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |      | &amp;lt;*&amp;gt;   ThinkPad ACPI Laptop Extras&lt;/span&gt;
&lt;span class="na"&gt;|      |      | [*]     Console audio control ALSA interface (NEW)&lt;/span&gt;
&lt;span class="na"&gt;|      |      | [ ]     Maintainer debug facilities (NEW)&lt;/span&gt;
&lt;span class="na"&gt;|      |      | [ ]     Verbose debug mode (NEW)&lt;/span&gt;
&lt;span class="na"&gt;|      |      | [ ]     Allow control of important LEDs (unsafe) (NEW)&lt;/span&gt;
&lt;span class="na"&gt;|      |      | [*]     Video output control support (NEW)&lt;/span&gt;
&lt;span class="na"&gt;|      |      | [*]     Support NVRAM polling for hot keys (NEW)&lt;/span&gt;
&lt;span class="na"&gt;|      |      | &amp;lt; &amp;gt;   Eee PC Hotkey Driver&lt;/span&gt;
&lt;span class="na"&gt;|      |&lt;/span&gt;
&lt;span class="na"&gt;|      | [*] IOMMU Hardware Support  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |      | --- IOMMU Hardware Support&lt;/span&gt;
&lt;span class="na"&gt;|      |      | [ ]   AMD IOMMU support&lt;/span&gt;
&lt;span class="na"&gt;|      |      | [*]   Support for Intel IOMMU using DMA Remapping Devices&lt;/span&gt;
&lt;span class="na"&gt;|      |      | [*]     Enable Intel DMA Remapping Devices by default&lt;/span&gt;
&lt;span class="na"&gt;|      |      | [*]   Support for Interrupt Remapping&lt;/span&gt;
&lt;span class="na"&gt;|      |&lt;/span&gt;
&lt;span class="na"&gt;|      | [*] Pulse-Width Modulation (PWM) Support  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |      | &amp;lt;*&amp;gt;   Intel LPSS PWM support&lt;/span&gt;
&lt;span class="na"&gt;|      |      | &amp;lt;*&amp;gt;     Intel LPSS PWM PCI driver&lt;/span&gt;
&lt;span class="na"&gt;|      |      | &amp;lt;*&amp;gt;     Intel LPSS PWM platform driver&lt;/span&gt;
&lt;span class="na"&gt;|      |&lt;/span&gt;
&lt;span class="na"&gt;|      | [*] Generic powercap sysfs driver  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |      | &amp;lt;*&amp;gt;   Intel RAPL Support&lt;/span&gt;
&lt;span class="na"&gt;|&lt;/span&gt;
&lt;span class="na"&gt;|    File systems  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |&lt;/span&gt;
&lt;span class="na"&gt;|      | &amp;lt;*&amp;gt; The Extended 4 (ext4) filesystem&lt;/span&gt;
&lt;span class="na"&gt;|      | &amp;lt;*&amp;gt; XFS filesystem support&lt;/span&gt;
&lt;span class="na"&gt;|      | &amp;lt;*&amp;gt; FUSE (Filesystem in Userspace) support&lt;/span&gt;
&lt;span class="na"&gt;|      |&lt;/span&gt;
&lt;span class="na"&gt;|      |     Pseudo filesystems  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |      | &amp;lt;*&amp;gt;   EFI Variable filesystem&lt;/span&gt;
&lt;span class="na"&gt;|      |&lt;/span&gt;
&lt;span class="na"&gt;|      | [ ] Miscellaneous filesystems  ----&lt;/span&gt;
&lt;span class="na"&gt;|      |&lt;/span&gt;
&lt;span class="na"&gt;|      | [*] Network File Systems  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |      | --- Network File Systems&lt;/span&gt;
&lt;span class="na"&gt;|      |      | &amp;lt;*&amp;gt;   NFS client support&lt;/span&gt;
&lt;span class="na"&gt;|      |      | &amp;lt; &amp;gt;     NFS client support for NFS version 2&lt;/span&gt;
&lt;span class="na"&gt;|      |      | &amp;lt; &amp;gt;     NFS client support for NFS version 3&lt;/span&gt;
&lt;span class="na"&gt;|      |      | &amp;lt;*&amp;gt;     NFS client support for NFS version 4&lt;/span&gt;
&lt;span class="na"&gt;|      |      | [ ]   Root file system on NFS&lt;/span&gt;
&lt;span class="na"&gt;|      |      | &amp;lt;*&amp;gt;   CIFS support (advanced network filesystem, SMBFS successor)&lt;/span&gt;
&lt;span class="na"&gt;|      |      | [ ]     Enable CIFS debugging routines&lt;/span&gt;
&lt;span class="na"&gt;|&lt;/span&gt;
&lt;span class="na"&gt;| -*- Cryptographic API  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |&lt;/span&gt;
&lt;span class="na"&gt;|      |       *** Digest ***&lt;/span&gt;
&lt;span class="na"&gt;|      | -*-   CRC32c CRC algorithm&lt;/span&gt;
&lt;span class="na"&gt;|      | &amp;lt;*&amp;gt;   CRC32c INTEL hardware acceleration&lt;/span&gt;
&lt;span class="na"&gt;|      | -*-   SHA1 digest algorithm&lt;/span&gt;
&lt;span class="na"&gt;|      | &amp;lt;*&amp;gt;   SHA1 digest algorithm (SSSE3/AVX/AVX2)&lt;/span&gt;
&lt;span class="na"&gt;|      | &amp;lt;*&amp;gt;   SHA256 digest algorithm (SSSE3/AVX/AVX2)&lt;/span&gt;
&lt;span class="na"&gt;|      | &amp;lt;*&amp;gt;   SHA512 digest algorithm (SSSE3/AVX/AVX2)&lt;/span&gt;
&lt;span class="na"&gt;|      |&lt;/span&gt;
&lt;span class="na"&gt;|      |       *** Ciphers ***&lt;/span&gt;
&lt;span class="na"&gt;|      | -*-   AES cipher algorithms&lt;/span&gt;
&lt;span class="na"&gt;|      | -*-   AES cipher algorithms (x86_64)&lt;/span&gt;
&lt;span class="na"&gt;|      | &amp;lt;*&amp;gt;   AES cipher algorithms (AES-NI)&lt;/span&gt;
&lt;span class="na"&gt;|      |&lt;/span&gt;
&lt;span class="na"&gt;|      | [ ]   Hardware crypto devices  ----&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="kernel-optional-configuration"&gt;
&lt;h2&gt;Kernel optional configuration&lt;/h2&gt;
&lt;div class="section" id="kerberos-cryptography-support"&gt;
&lt;h3&gt;Kerberos cryptography support&lt;/h3&gt;
&lt;pre class="code ini literal-block"&gt;
&lt;span class="na"&gt;| -*- Cryptographic API  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      | -*- Cryptographic API ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      | &amp;lt;*&amp;gt;   CBC support&lt;/span&gt;
&lt;span class="na"&gt;|      | &amp;lt;*&amp;gt;   CTS support&lt;/span&gt;
&lt;span class="na"&gt;|      | -*-   ECB support&lt;/span&gt;
&lt;span class="na"&gt;|      | -*-   HMAC support&lt;/span&gt;
&lt;span class="na"&gt;|      | -*-   ARC4 cipher algorithm&lt;/span&gt;
&lt;span class="na"&gt;|      | -*-   DES and Triple DES EDE cipher algorithms&lt;/span&gt;
&lt;span class="na"&gt;|      | &amp;lt;*&amp;gt;   Triple DES EDE cipher algorithm (x86-64)&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="virtualization-with-kvm"&gt;
&lt;h3&gt;Virtualization with KVM&lt;/h3&gt;
&lt;pre class="code ini literal-block"&gt;
&lt;span class="na"&gt;|     General setup  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      | -*- Control Group support  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |        | [*]   Memory Resource Controller for Control Groups&lt;/span&gt;
&lt;span class="na"&gt;|      |        | [*]     Memory Resource Controller Swap Extension&lt;/span&gt;
&lt;span class="na"&gt;|      |        | [*]       Memory Resource Controller Swap Extension enabled by default (NEW)&lt;/span&gt;
&lt;span class="na"&gt;|      |        | [*]     Memory Resource Controller Kernel Memory accounting&lt;/span&gt;
&lt;span class="na"&gt;|&lt;/span&gt;
&lt;span class="na"&gt;| [*] Virtualization  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      | --- Virtualization&lt;/span&gt;
&lt;span class="na"&gt;|      | &amp;lt;*&amp;gt;   Kernel-based Virtual Machine (KVM) support&lt;/span&gt;
&lt;span class="na"&gt;|      | &amp;lt;*&amp;gt;     KVM for Intel processors support&lt;/span&gt;
&lt;span class="na"&gt;|      | &amp;lt; &amp;gt;     KVM for AMD processors support (NEW)&lt;/span&gt;
&lt;span class="na"&gt;|      | [ ]     Audit KVM MMU (NEW)&lt;/span&gt;
&lt;span class="na"&gt;|      | [ ]     KVM legacy PCI device assignment support&lt;/span&gt;
&lt;span class="na"&gt;|      | &amp;lt; &amp;gt;   Host kernel accelerator for virtio net (NEW)&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;Configuration for bridge network&lt;/p&gt;
&lt;pre class="code ini literal-block"&gt;
&lt;span class="na"&gt;| [*] Networking support  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      | --- Networking support&lt;/span&gt;
&lt;span class="na"&gt;|      |       Networking options  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |        | &amp;lt;*&amp;gt; 802.1d Ethernet Bridging&lt;/span&gt;
&lt;span class="na"&gt;|      |        | [*] Network packet filtering framework (Netfilter)  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |        |        | &amp;lt;*&amp;gt;   Ethernet Bridge tables (ebtables) support  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |        |        |        | &amp;lt;*&amp;gt;   ebt: mark target support&lt;/span&gt;
&lt;span class="na"&gt;|&lt;/span&gt;
&lt;span class="na"&gt;| Device Drivers  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      | [*] Network device support  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |      | --- Network device support&lt;/span&gt;
&lt;span class="na"&gt;|      |      | &amp;lt;*&amp;gt;     MAC-VLAN support&lt;/span&gt;
&lt;span class="na"&gt;|      |      | &amp;lt;*&amp;gt;       MAC-VLAN based tap driver&lt;/span&gt;
&lt;span class="na"&gt;|      |      | &amp;lt;*&amp;gt;     Universal TUN/TAP device driver support&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;Configuration for virtual network&lt;/p&gt;
&lt;pre class="code ini literal-block"&gt;
&lt;span class="na"&gt;| [*] Networking support  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      | --- Networking support&lt;/span&gt;
&lt;span class="na"&gt;|      |       Networking options  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |&lt;/span&gt;
&lt;span class="na"&gt;|      |        | [*] Network packet filtering framework (Netfilter)  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |        |       | [*]   Advanced netfilter configuration&lt;/span&gt;
&lt;span class="na"&gt;|      |        |       |       Core Netfilter Configuration  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |        |       |       | &amp;lt;*&amp;gt;   ctmark target and match support&lt;/span&gt;
&lt;span class="na"&gt;|      |        |       |       | &amp;lt;*&amp;gt;   CHECKSUM target support&lt;/span&gt;
&lt;span class="na"&gt;|      |        |       | &amp;lt;*&amp;gt;   Ethernet Bridge tables (ebtables) support  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |        |       |       | &amp;lt;*&amp;gt;   ebt: nat table support&lt;/span&gt;
&lt;span class="na"&gt;|      |        |       |       | &amp;lt;*&amp;gt;   ebt: mark target support&lt;/span&gt;
&lt;span class="na"&gt;|      |        |&lt;/span&gt;
&lt;span class="na"&gt;|      |        | [*] QoS and/or fair queueing  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |        |       | &amp;lt;*&amp;gt;   Hierarchical Token Bucket (HTB)&lt;/span&gt;
&lt;span class="na"&gt;|      |        |       | &amp;lt;*&amp;gt;   Stochastic Fairness Queueing (SFQ)&lt;/span&gt;
&lt;span class="na"&gt;|      |        |       | &amp;lt;*&amp;gt;   Ingress Qdisc&lt;/span&gt;
&lt;span class="na"&gt;|      |        |       | &amp;lt;*&amp;gt;   Netfilter mark (FW)&lt;/span&gt;
&lt;span class="na"&gt;|      |        |       | &amp;lt;*&amp;gt;   Universal 32bit comparisons w/ hashing (U32)&lt;/span&gt;
&lt;span class="na"&gt;|      |        |       | [*]   Actions&lt;/span&gt;
&lt;span class="na"&gt;|      |        |       | &amp;lt;*&amp;gt;     Traffic Policing&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="chromimum"&gt;
&lt;h3&gt;Chromimum&lt;/h3&gt;
&lt;pre class="code ini literal-block"&gt;
&lt;span class="na"&gt;| General setup  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      | -*- Namespaces support  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |      | [*]   User namespace&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="usb-serial-converter-support"&gt;
&lt;h3&gt;USB Serial Converter support&lt;/h3&gt;
&lt;pre class="code ini literal-block"&gt;
&lt;span class="na"&gt;| Device Drivers  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      | [*] USB support  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |      | &amp;lt;*&amp;gt;   USB Serial Converter support  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      |      | &amp;lt;*&amp;gt;     &amp;lt;*&amp;gt;   USB Winchiphead CH341 Single Port Serial Driver&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="kernel-compilation"&gt;
&lt;h2&gt;Kernel compilation&lt;/h2&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;#&lt;/span&gt; make &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; make modules_install
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;Kernel installation&lt;/h2&gt;
&lt;p&gt;Mount ESP (EFI System Partition)&lt;/p&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;#&lt;/span&gt; mkdir /mnt/ESP
&lt;span class="gp"&gt;#&lt;/span&gt; mount /dev/sda2 /mnt/ESP
&lt;/pre&gt;
&lt;p&gt;Create directory&lt;/p&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;#&lt;/span&gt; mkdir /mnt/ESP/EFI/GentooLinux
&lt;/pre&gt;
&lt;p&gt;Copy kernel&lt;/p&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;#&lt;/span&gt; cp /usr/src/linux/arch/x86_64/boot/bzImage /mnt/ESP/EFI/GentooLinux/4.12.12.efi
&lt;/pre&gt;
&lt;p&gt;Unmount ESP (EFI System Partition)&lt;/p&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;#&lt;/span&gt; umount /mnt/ESP
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="update-uefi-bootloader"&gt;
&lt;h2&gt;Update UEFI bootloader&lt;/h2&gt;
&lt;p&gt;Install EFI boot manager&lt;/p&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;#&lt;/span&gt; emerge efibootmgr
&lt;/pre&gt;
&lt;p&gt;Add the new kernel&lt;/p&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;#&lt;/span&gt; efibootmgr -c -d /dev/sda -p &lt;span class="m"&gt;2&lt;/span&gt; -L &lt;span class="s2"&gt;"Gentoo Linux 4.12.12"&lt;/span&gt; -l &lt;span class="s2"&gt;"\EFI\GentooLinux\4.12.12.efi"&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;Print the menu&lt;/p&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;#&lt;/span&gt; efibootmgr -v
&lt;/pre&gt;
&lt;p&gt;Remove the previous kernel (after testing the new kernel)&lt;/p&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;#&lt;/span&gt; efibootmgr -b &lt;span class="m"&gt;15&lt;/span&gt; -B
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="references"&gt;
&lt;h2&gt;References&lt;/h2&gt;
&lt;blockquote&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="https://wiki.gentoo.org/wiki/EFI_stub_kernel"&gt;Wiki Gentoo - EFI stub kernel&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;/div&gt;
</content><category term="Gentoo"></category></entry><entry><title>HowTo support FAT64 on Gentoo</title><link href="http://didier.bernaudeau.net/HowTo-support-FAT64-on-Gentoo.html" rel="alternate"></link><published>2015-06-02T18:10:00+02:00</published><updated>2015-06-02T18:10:00+02:00</updated><author><name>Didier Bernaudeau</name></author><id>tag:didier.bernaudeau.net,2015-06-02:/HowTo-support-FAT64-on-Gentoo.html</id><summary type="html">&lt;p&gt;FAT64 or ExFAT (Extended File Allocation Table) is a file system introduced in 2009 by Microsoft. This is the successor to FAT32 that addresses the need to store larges files. With FAT64, the theoretical maximum file size is 64 ZB instead of 4GB for FAT32.&lt;/p&gt;
&lt;p&gt;This file systen is supported by Microsoft Windows (XP, Vista, Seven,...), MacOS, Linux and Android. For linux, FAT64 is not supported directly in the kernel but with FUSE (Filesystem in UserSpacE).&lt;/p&gt;
&lt;p&gt;This article describes step by step how to support FAT64 on Gentoo Linux.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;FAT64 or ExFAT (Extended File Allocation Table) is a file system introduced in 2009 by Microsoft. This is the successor to FAT32 that addresses the need to store larges files. With FAT64, the theoretical maximum file size is 64 ZB instead of 4GB for FAT32.&lt;/p&gt;
&lt;p&gt;This file systen is supported by Microsoft Windows (XP, Vista, Seven,...), MacOS, Linux and Android. For linux, FAT64 is not supported directly in the kernel but with FUSE (Filesystem in UserSpacE).&lt;/p&gt;
&lt;p&gt;This article describes step by step how to support FAT64 on Gentoo Linux.&lt;/p&gt;

&lt;div class="section" id="installation"&gt;
&lt;h2&gt;Installation&lt;/h2&gt;
&lt;p&gt;Kernel configuration :&lt;/p&gt;
&lt;pre class="code ini literal-block"&gt;
&lt;span class="na"&gt;|     File systems  ---&amp;gt;&lt;/span&gt;
&lt;span class="na"&gt;|      | &amp;lt;*&amp;gt; FUSE (Filesystem in Userspace) support&lt;/span&gt;
&lt;span class="na"&gt;|      | &amp;lt;*&amp;gt;   Character device in Userspace support&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;software installation :&lt;/p&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;#&lt;/span&gt; emerge sys-fs/fuse-exfat sys-fs/exfat-utils
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="usage"&gt;
&lt;h2&gt;Usage&lt;/h2&gt;
&lt;p&gt;Format the partition&lt;/p&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;#&lt;/span&gt; mkfs.exfat /dev/sdxy
&lt;/pre&gt;
&lt;p&gt;Check the partition&lt;/p&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;#&lt;/span&gt; fsck.exfat /dev/sdxy
&lt;/pre&gt;
&lt;p&gt;Mount the partition&lt;/p&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;#&lt;/span&gt; mount -t exfat /dev/sdxy /mnt/usb
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="references"&gt;
&lt;h2&gt;References&lt;/h2&gt;
&lt;blockquote&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="https://support.microsoft.com/en-us/kb/955704/"&gt;Microsoft - Description of the ExFAT file system driver&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;/div&gt;
</content><category term="Gentoo"></category></entry><entry><title>HowTo make a web site with Pelican hosted on GitHub Pages</title><link href="http://didier.bernaudeau.net/HowTo_make_a_web_site_with_Pelican_hosted_on_GitHub_Pages.html" rel="alternate"></link><published>2015-05-16T22:20:00+02:00</published><updated>2015-07-08T23:10:00+02:00</updated><author><name>Didier Bernaudeau</name></author><id>tag:didier.bernaudeau.net,2015-05-16:/HowTo_make_a_web_site_with_Pelican_hosted_on_GitHub_Pages.html</id><summary type="html">&lt;p&gt;Pelican is a static site generator writed in Python. This means that you edit the content on your computer with a simple text editor. Then, a generator makes all HTML pages for the web site, including indexes for articles, categories and tags. In the end, your web site can be hosted easily on a simple HTTP server like GitHub Pages or Amazon S3.&lt;/p&gt;
&lt;p&gt;Unlike other CMS (Content Management System) like Wordpress or Drupal, Pelican has no web administration interface. In most cases, the administration interface has many vulnerabilies used to deface the website.&lt;/p&gt;
&lt;p&gt;This article describes step by step how to make your web site with Pelican 3.5 on Gentoo Linux and how to host your web site on GitHub Pages.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;Pelican is a static site generator writed in Python. This means that you edit the content on your computer with a simple text editor. Then, a generator makes all HTML pages for the web site, including indexes for articles, categories and tags. In the end, your web site can be hosted easily on a simple HTTP server like GitHub Pages or Amazon S3.&lt;/p&gt;
&lt;p&gt;Unlike other CMS (Content Management System) like Wordpress or Drupal, Pelican has no web administration interface. In most cases, the administration interface has many vulnerabilies used to deface the website.&lt;/p&gt;
&lt;p&gt;This article describes step by step how to make your web site with Pelican 3.5 on Gentoo Linux and how to host your web site on GitHub Pages.&lt;/p&gt;

&lt;div class="section" id="install-pelican"&gt;
&lt;h2&gt;Install Pelican&lt;/h2&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;#&lt;/span&gt; emerge pelican
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="create-github-space"&gt;
&lt;h2&gt;Create GitHub space&lt;/h2&gt;
&lt;p&gt;On &lt;a class="reference external" href="https://github.com/"&gt;GitHub&lt;/a&gt;, create an account named "didier-bernaudeau" then a repository named "didier-bernaudeau.github.io". Obviously, remplace "didier-bernaudeau" by your username.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="dns-configuration"&gt;
&lt;h2&gt;DNS Configuration&lt;/h2&gt;
&lt;p&gt;Add a record in the DNS :&lt;/p&gt;
&lt;pre class="code ini literal-block"&gt;
&lt;span class="na"&gt;Type : CNAME&lt;/span&gt;
&lt;span class="na"&gt;Name : didier.bernaudeau.net&lt;/span&gt;
&lt;span class="na"&gt;Value : didier-bernaudeau.github.io.&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;Check configuration with "dig" tool :&lt;/p&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;#&lt;/span&gt; emerge bind-tools
&lt;/pre&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;$&lt;/span&gt; dig didier.bernaudeau.net +nostats +nocomments +nocmd
&lt;span class="go"&gt;
; &amp;lt;&amp;lt;&amp;gt;&amp;gt; DiG 9.10.1-P1 &amp;lt;&amp;lt;&amp;gt;&amp;gt; didier.bernaudeau.net +nostats +nocomments +nocmd
;; global options: +cmd
;didier.bernaudeau.net.         IN      A
didier.bernaudeau.net.  10800   IN      CNAME   didier-bernaudeau.github.io.
didier-bernaudeau.github.io. 3600 IN    CNAME   github.map.fastly.net.
github.map.fastly.net.  30      IN      A       185.31.17.133&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="create-local-directory"&gt;
&lt;h2&gt;Create local directory&lt;/h2&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;$&lt;/span&gt; git clone https://github.com/didier-bernaudeau/didier-bernaudeau.github.io.git/ MyWebSite
&lt;span class="gp"&gt;$&lt;/span&gt; &lt;span class="nb"&gt;cd&lt;/span&gt; MyWebSite
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="create-project"&gt;
&lt;h2&gt;Create project&lt;/h2&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;$&lt;/span&gt; pelican-quickstart
&lt;/pre&gt;
&lt;pre class="code ini literal-block"&gt;
&lt;span class="na"&gt;&amp;gt; Where do you want to create your new web site? [.]&lt;/span&gt;
&lt;span class="na"&gt;&amp;gt; What will be the title of this web site? D. Bernaudeau&lt;/span&gt;
&lt;span class="na"&gt;&amp;gt; Who will be the author of this web site? D. Bernaudeau&lt;/span&gt;
&lt;span class="na"&gt;&amp;gt; What will be the default language of this web site? [en]&lt;/span&gt;
&lt;span class="na"&gt;&amp;gt; Do you want to specify a URL prefix? e.g., http://example.com   (Y/n) Y&lt;/span&gt;
&lt;span class="na"&gt;&amp;gt; What is your URL prefix? (see above example; no trailing slash) http://didier.bernaudeau.net&lt;/span&gt;
&lt;span class="na"&gt;&amp;gt; Do you want to enable article pagination? (Y/n) n&lt;/span&gt;
&lt;span class="na"&gt;&amp;gt; Do you want to generate a Fabfile/Makefile to automate generation and publishing? (Y/n) Y&lt;/span&gt;
&lt;span class="na"&gt;&amp;gt; Do you want an auto-reload &amp;amp; simpleHTTP script to assist with theme and site development? (Y/n) n&lt;/span&gt;
&lt;span class="na"&gt;&amp;gt; Do you want to upload your website using FTP? (y/N) N&lt;/span&gt;
&lt;span class="na"&gt;&amp;gt; Do you want to upload your website using SSH? (y/N) N&lt;/span&gt;
&lt;span class="na"&gt;&amp;gt; Do you want to upload your website using Dropbox? (y/N) N&lt;/span&gt;
&lt;span class="na"&gt;&amp;gt; Do you want to upload your website using S3? (y/N) N&lt;/span&gt;
&lt;span class="na"&gt;&amp;gt; Do you want to upload your website using Rackspace Cloud Files? (y/N) N&lt;/span&gt;
&lt;span class="na"&gt;&amp;gt; Do you want to upload your website using GitHub Pages? (y/N) y&lt;/span&gt;
&lt;span class="na"&gt;&amp;gt; Is this your personal page (username.github.io)? (y/N) y&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="download-the-theme"&gt;
&lt;h2&gt;Download the theme&lt;/h2&gt;
&lt;p&gt;For my web site, I selected the theme "Bootstrap3" and the style sheet "Bootswatch".&lt;/p&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;$&lt;/span&gt; &lt;span class="nb"&gt;cd&lt;/span&gt; MyWebSite
&lt;span class="gp"&gt;$&lt;/span&gt; git clone https://github.com/DandyDev/pelican-bootstrap3.git/ theme
&lt;span class="gp"&gt;$&lt;/span&gt; &lt;span class="nb"&gt;cd&lt;/span&gt; theme/static/css/
&lt;span class="gp"&gt;$&lt;/span&gt; wget https://bootswatch.com/bower_components/bootstrap/dist/css/bootstrap.min.css
&lt;span class="gp"&gt;$&lt;/span&gt; wget https://bootswatch.com/bower_components/bootstrap/dist/css/bootstrap.css
&lt;/pre&gt;
&lt;p&gt;Moreover, I have edited the theme to change the font size of "blockquote" section (bootstrap.flatly.min.css).&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="download-plugins"&gt;
&lt;h2&gt;Download plugins&lt;/h2&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;$&lt;/span&gt; &lt;span class="nb"&gt;cd&lt;/span&gt; MyWebSite
&lt;span class="gp"&gt;$&lt;/span&gt; git clone --recursive https://github.com/getpelican/pelican-plugins plugins
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="install-bootstrapify"&gt;
&lt;h2&gt;Install Bootstrapify&lt;/h2&gt;
&lt;p&gt;Bootstrapify is a pelican plugin that modify article and page html to use bootstrap's default classes, especially tables. Beautiful Soup is requiered for Bootstrapify.&lt;/p&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;#&lt;/span&gt; emerge dev-python/beautifulsoup
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="create-github-files"&gt;
&lt;h2&gt;Create GitHub Files&lt;/h2&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;$&lt;/span&gt; &lt;span class="nb"&gt;cd&lt;/span&gt; MyWebSite
&lt;span class="gp"&gt;$&lt;/span&gt; mkdir content/GitHubFiles
&lt;/pre&gt;
&lt;p&gt;Write your domain name in CNAME Files :&lt;/p&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;$&lt;/span&gt; nano content/GitHubFiles/CNAME
&lt;/pre&gt;
&lt;pre class="code ini literal-block"&gt;
&lt;span class="na"&gt;didier.bernaudeau.net&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;Disable indexation by web search engine :&lt;/p&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;$&lt;/span&gt; nano content/GitHubFiles/robots.txt
&lt;/pre&gt;
&lt;pre class="code ini literal-block"&gt;
&lt;span class="na"&gt;User-agent: *&lt;/span&gt;
&lt;span class="na"&gt;Disallow:/&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="pelican-configuration"&gt;
&lt;h2&gt;Pelican Configuration&lt;/h2&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;$&lt;/span&gt; nano pelicanconf.py
&lt;/pre&gt;
&lt;pre class="code ini literal-block"&gt;
&lt;span class="c1"&gt;# Hide Blogroll&lt;/span&gt;
&lt;span class="c1"&gt;#LINKS =&lt;/span&gt;

&lt;span class="c1"&gt;# Hide Social widget&lt;/span&gt;
&lt;span class="c1"&gt;#SOCIAL =&lt;/span&gt;

&lt;span class="c1"&gt;# Define the theme&lt;/span&gt;
&lt;span class="na"&gt;THEME&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;'theme/'&lt;/span&gt;
&lt;span class="na"&gt;BOOTSTRAP_THEME&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;'flatly'&lt;/span&gt;

&lt;span class="c1"&gt;# Define menu options&lt;/span&gt;
&lt;span class="na"&gt;DISPLAY_CATEGORIES_ON_MENU&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;True&lt;/span&gt;
&lt;span class="na"&gt;DISPLAY_PAGES_ON_MENU&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;True&lt;/span&gt;

&lt;span class="c1"&gt;# Define index options&lt;/span&gt;
&lt;span class="na"&gt;DISPLAY_ARTICLE_INFO_ON_INDEX&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;True&lt;/span&gt;
&lt;span class="na"&gt;SUMMARY_MAX_LENGTH&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;50&lt;/span&gt;

&lt;span class="c1"&gt;# Add description about author&lt;/span&gt;
&lt;span class="na"&gt;ABOUT_ME&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;'...'&lt;/span&gt;

&lt;span class="c1"&gt;# Define sidebar options (With cloud tag)&lt;/span&gt;
&lt;span class="na"&gt;DISPLAY_TAGS_ON_SIDEBAR&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;True&lt;/span&gt;
&lt;span class="na"&gt;DISPLAY_TAGS_INLINE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;True&lt;/span&gt;

&lt;span class="c1"&gt;# Add Creative Common licence in the footer&lt;/span&gt;
&lt;span class="na"&gt;CC_LICENSE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;'CC-BY-NC-ND'&lt;/span&gt;

&lt;span class="c1"&gt;# Add plugins (Summary)&lt;/span&gt;
&lt;span class="na"&gt;PLUGIN_PATHS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;['plugins']&lt;/span&gt;
&lt;span class="na"&gt;PLUGINS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;['summary','bootstrapify']&lt;/span&gt;

&lt;span class="c1"&gt;# Add static paths will be copied without parsing their contents&lt;/span&gt;
&lt;span class="na"&gt;STATIC_PATHS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;['images','presentation', 'GitHubFiles']&lt;/span&gt;

&lt;span class="c1"&gt;# Shift the installed location of a file&lt;/span&gt;
&lt;span class="na"&gt;EXTRA_PATH_METADATA&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;{
   'GitHubFiles/CNAME': {'path': 'CNAME'},
   'GitHubFiles/robots.txt': {'path': 'robots.txt'},&lt;/span&gt;
&lt;span class="na"&gt;}&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="create-an-article-in-restructuredtext"&gt;
&lt;h2&gt;Create an article in reStructuredText&lt;/h2&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;$&lt;/span&gt; nano content/test.rst
&lt;/pre&gt;
&lt;pre class="code ini literal-block"&gt;
&lt;span class="na"&gt;Article title&lt;/span&gt;
&lt;span class="c1"&gt;#############&lt;/span&gt;

&lt;span class="na"&gt;:date: AAAA-MM-JJ HH:MM&lt;/span&gt;
&lt;span class="na"&gt;:modified: AAAA-MM-JJ HH:MM&lt;/span&gt;
&lt;span class="na"&gt;:tags: word1, word2&lt;/span&gt;
&lt;span class="na"&gt;:category: MyCategory&lt;/span&gt;
&lt;span class="na"&gt;:slug: Article-title&lt;/span&gt;
&lt;span class="na"&gt;:authors: MyName&lt;/span&gt;

&lt;span class="na"&gt;Introduction ...&lt;/span&gt;

&lt;span class="na"&gt;.. PELICAN_END_SUMMARY&lt;/span&gt;

&lt;span class="na"&gt;Content ...&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="generate-the-web-site"&gt;
&lt;h2&gt;Generate the web site&lt;/h2&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;$&lt;/span&gt; make html
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="preview-the-web-site"&gt;
&lt;h2&gt;Preview the web site&lt;/h2&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;$&lt;/span&gt; make serve
&lt;span class="gp"&gt;$&lt;/span&gt; firefox localhost:8000
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="publish-the-web-site-on-github"&gt;
&lt;h2&gt;Publish the web site on GitHub&lt;/h2&gt;
&lt;pre class="code console literal-block"&gt;
&lt;span class="gp"&gt;$&lt;/span&gt; make github
&lt;span class="go"&gt;
Username for 'https://github.com': didier-bernaudeau
Password for 'https://didier-bernaudeau@github.com': *************************&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="references"&gt;
&lt;h2&gt;References&lt;/h2&gt;
&lt;blockquote&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="http://docs.getpelican.com/en/3.5.0/"&gt;Pelican&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="https://github.com/getpelican/pelican-plugins/"&gt;Pelican plugins&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="https://github.com/DandyDev/pelican-bootstrap3/"&gt;Pelican theme - Bootstrap 3&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://kdheepak.com/blog/how-to-set-up-a-pelican-blog-with-github-pages/"&gt;How to set up a Pelican blog with Github pages (by Dheepak Krishnamurthy)&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;/div&gt;
</content><category term="Pelican"></category><category term="Gentoo"></category></entry><entry><title>How to install Debian on my Home Server</title><link href="http://didier.bernaudeau.net/2012-01-30_HowTo_install_Debian_on_Home_Server.html" rel="alternate"></link><published>2012-01-31T12:24:00+01:00</published><updated>2018-04-03T22:57:00+02:00</updated><author><name>Didier BERNAUDEAU</name></author><id>tag:didier.bernaudeau.net,2012-01-31:/2012-01-30_HowTo_install_Debian_on_Home_Server.html</id><summary type="html">&lt;p&gt;This post describes how to install Debian Stretch 9.3 on my &lt;a href="http://didier.bernaudeau.net/Home_Server.html"&gt;home server&lt;/a&gt;.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;This post describes how to install Debian Stretch 9.3 on my &lt;a href="http://didier.bernaudeau.net/Home_Server.html"&gt;home server&lt;/a&gt;.&lt;/p&gt;

&lt;h1&gt;Create boot media&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Getting debian&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; curl -0 https://cdimage.debian.org/debian-cd/current/amd64/iso-cd/debian-9.3.0-amd64-netinst.iso
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Create USB boot media&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; dd &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;debian-9.3.0-amd64-netinst.iso &lt;span class="nv"&gt;of&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;/dev/sdb &lt;span class="nv"&gt;bs&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;4k
&lt;span class="gp"&gt;#&lt;/span&gt; sync
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;/!\ This USB key will be a read only filesystem&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Getting network driver&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; curl -O http://ftp.nl.debian.org/debian/pool/non-free/f/firmware-nonfree/firmware-realtek_20161130-3_all.deb
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Copy network driver on an another USB key&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;Debian installation&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Plug the both USB keys then power on the server&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Press "del" to enter in the UEFI bios and select "UEFI:" as first boot media&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Select "install" in the "Debian UEFI Installer" menu&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Select a language: english&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Select your location: Other / Europe / France&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Configure Locales: United States&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Configure the keyboard: French&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Configure the network: cube.domain.net&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Partition disk&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;table class="table table-hover table-striped"&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Mount Point&lt;/th&gt;
&lt;th align="left"&gt;Type&lt;/th&gt;
&lt;th align="right"&gt;Size&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;None&lt;/td&gt;
&lt;td align="left"&gt;ESP&lt;/td&gt;
&lt;td align="right"&gt;300 MB&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;/&lt;/td&gt;
&lt;td align="left"&gt;EXT4&lt;/td&gt;
&lt;td align="right"&gt;10O GB&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;None&lt;/td&gt;
&lt;td align="left"&gt;Swap&lt;/td&gt;
&lt;td align="right"&gt;8 GB&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;None&lt;/td&gt;
&lt;td align="left"&gt;EXT4&lt;/td&gt;
&lt;td align="right"&gt;775 GB&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Software selection: SSH server and Standard system utilities&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;The server reboot automatically when the installation is finished&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Press "del" to enter in the UEFI bios and select "debian (P0: WDC WD10EFRW-68FYTN0" as first boot media and disabled any others.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Install Sudo&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;#&lt;/span&gt; apt-get install -y sudo
&lt;span class="gp"&gt;#&lt;/span&gt; adduser UserName sudo
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Update system&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo apt-get update &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; sudo apt-get full-upgrade &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; sudo apt-get autoremove
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Mount the second hard drive disk&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Install gdisk&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo apt-get install -y gdisk
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Create a partition&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo gdisk /dev/sdb
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Format partition in EXT4&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo mkfs.ext4 -L data /dev/sdb1
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Get UUID (Universally Unique Identifier)&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo blkid /dev/sdb1
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Create mount point&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo mkdir /data/
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Define mount option&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /etc/fstab
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;UUID=d391610f-dca0-4677-ad3a-c0f6d20b5baf       /data     ext4    defaults        0       2
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Mount disk&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo mount /data
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Time sync&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Disable RTC&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo timedatectl set-local-rtc &lt;span class="m"&gt;0&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Enable NTP&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo timedatectl set-ntp &lt;span class="m"&gt;1&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Define NTP server&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /etc/systemd/timesyncd.conf
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Servers=g8way.domain.net
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Restart NTP client&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; systemctl restart systemd-timesyncd.service
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Check&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo timedatectl status
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Install additional tools&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Curl&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo apt-get install -y curl
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Rsync&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo apt-get install -y rsync
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Adding HTTPS support for APT tool&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo apt-get install -y apt-transport-https
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Adding additional tools for APT (such as add-apt-repository)&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo apt-get install -y software-properties-common
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Htop&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo apt-get install -y htop
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Disable IPv6&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Edit kernel configuration file&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /etc/sysctl.conf
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;net.ipv6.conf.all.disable_ipv6 = 1
net.ipv6.conf.default.disable_ipv6=1
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Apply the new configuration&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo sysctl -p
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;ACPI&lt;/h1&gt;
&lt;p&gt;The UEFI bios on my Assus motherboard is quite buggy and Assus doesn't update the bios anymore.&lt;/p&gt;
&lt;h2&gt;Errors&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;DSSP Error&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;ACPI Error: [DSSP] Namespace lookup failure, AE_NOT_FOUND (20160831/psargs-359)
ACPI Error: Method parse/execution failed [\_SB.PCI0.SAT0.SPT0._GTF] (Node ffff97e5dadca5f0), AE_NOT_FOUND (20160831/psparse-543)
ACPI Error: [DSSP] Namespace lookup failure, AE_NOT_FOUND (20160831/psargs-359)
ACPI Error: Method parse/execution failed [\_SB.PCI0.SAT0.SPT1._GTF] (Node ffff97e5dadca780), AE_NOT_FOUND (20160831/psparse-543)
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Ressource conflict&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[    5.181191] ACPI Warning: SystemIO range 0x0000000000000428-0x000000000000042F conflicts with OpRegion 0x0000000000000400-0x000000000000047F (\PMIO) (20160831/utaddress-247)
[    5.181196] ACPI: If an ACPI driver is available for this device, you should use it instead of the native driver
[    5.181199] ACPI Warning: SystemIO range 0x0000000000000540-0x000000000000054F conflicts with OpRegion 0x0000000000000500-0x0000000000000563 (\GPIO) (20160831/utaddress-247)
[    5.181202] ACPI: If an ACPI driver is available for this device, you should use it instead of the native driver
[    5.181202] ACPI Warning: SystemIO range 0x0000000000000530-0x000000000000053F conflicts with OpRegion 0x0000000000000500-0x0000000000000563 (\GPIO) (20160831/utaddress-247)
[    5.181205] ACPI: If an ACPI driver is available for this device, you should use it instead of the native driver
[    5.181206] ACPI Warning: SystemIO range 0x0000000000000500-0x000000000000052F conflicts with OpRegion 0x0000000000000500-0x0000000000000563 (\GPIO) (20160831/utaddress-247)
[    5.181208] ACPI Warning: SystemIO range 0x0000000000000500-0x000000000000052F conflicts with OpRegion 0x0000000000000500-0x000000000000050F (\_GPE.GPIO) (20160831/utaddress-247)
[    5.181211] ACPI: If an ACPI driver is available for this device, you should use it instead of the native driver
[    5.313241] lpc_ich: Resource conflict(s) found affecting gpio_ich
&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;Workaround&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Add kernel parameters for ACPI&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /etc/default/grub
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;GRUB_CMDLINE_LINUX_DEFAULT="quiet libata.noacpi=1 acpi_enforce_resources=lax"
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo update-grub
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Reboot the server&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo reboot
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;LM Sensors&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Install&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo apt-get install -y lm-sensors
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Auto detection&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo sensors-detect
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Do you want to scan for Super I/O sensors? (YES/no): yes
Do you want to probe the I2C/SMBus adapters now? (YES/no): yes
Do you want to add these lines automatically to /etc/modules? (yes/NO): yes
&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Add modules which will be load&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sudo nano /etc/modules
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;coretemp
nct6775
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;$&lt;/span&gt; sensors
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;asus-isa-0000
Adapter: ISA adapter
cpu_fan:        0 RPM

acpitz-virtual-0
Adapter: Virtual device
temp1:        +27.8°C  (crit = +103.0°C)
temp2:        +29.8°C  (crit = +103.0°C)

nct6776-isa-0290
Adapter: ISA adapter
Vcore:          +0.83 V  (min =  +0.00 V, max =  +1.74 V)
in1:            +1.04 V  (min =  +0.00 V, max =  +0.00 V)  ALARM
AVCC:           +3.39 V  (min =  +0.00 V, max =  +0.00 V)  ALARM
+3.3V:          +3.39 V  (min =  +0.00 V, max =  +0.00 V)  ALARM
in4:            +1.02 V  (min =  +0.00 V, max =  +0.00 V)  ALARM
in5:            +2.04 V  (min =  +0.00 V, max =  +0.00 V)  ALARM
in6:            +1.02 V  (min =  +0.00 V, max =  +0.00 V)  ALARM
3VSB:           +3.42 V  (min =  +0.00 V, max =  +0.00 V)  ALARM
Vbat:           +3.30 V  (min =  +0.00 V, max =  +0.00 V)  ALARM
fan1:           971 RPM  (min =    0 RPM)
fan2:           987 RPM  (min =    0 RPM)
fan3:             0 RPM  (min =    0 RPM)
fan4:             0 RPM  (min =    0 RPM)
fan5:             0 RPM  (min =    0 RPM)
SYSTIN:         +21.0°C  (high =  +0.0°C, hyst =  +0.0°C)  ALARM  sensor = thermistor
CPUTIN:         +92.0°C  (high = +81.0°C, hyst = +76.0°C)  ALARM  sensor = thermistor
AUXTIN:         +65.0°C  (high = +80.0°C, hyst = +75.0°C)  sensor = thermistor
PECI Agent 0:   +29.0°C  (high = +80.0°C, hyst = +75.0°C)
                         (crit = +102.0°C)
PCH_CHIP_TEMP:   +0.0°C  
PCH_CPU_TEMP:    +0.0°C  
PCH_MCH_TEMP:    +0.0°C  
intrusion0:    ALARM
intrusion1:    ALARM
beep_enable:   disabled

coretemp-isa-0000
Adapter: ISA adapter
Physical id 0:  +30.0°C  (high = +82.0°C, crit = +102.0°C)
Core 0:         +29.0°C  (high = +82.0°C, crit = +102.0°C)
Core 1:         +29.0°C  (high = +82.0°C, crit = +102.0°C)
&lt;/pre&gt;&lt;/div&gt;</content><category term="Home Server"></category><category term="Debian Stretch"></category></entry></feed>