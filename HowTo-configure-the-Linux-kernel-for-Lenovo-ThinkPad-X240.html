<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>HowTo configure the Linux kernel for Lenovo ThinkPad X240 - My personal blog note</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



<link rel="canonical" href="http://didier.bernaudeau.net/HowTo-configure-the-Linux-kernel-for-Lenovo-ThinkPad-X240.html">

        <meta name="author" content="Didier Bernaudeau" />
        <meta name="keywords" content="Gentoo" />
        <meta name="description" content="This article describes step by step how to configure the Linux Kernel for my Lenovo ThinkPad X240. This kernel must support Intel Haswell processor, all devices and UEFI bootloader without Grub. To get more information about the configuration of my laptop, you can read this article : Lenovo ThinkPad X240" />

        <meta property="og:site_name" content="My personal blog note" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="HowTo configure the Linux kernel for Lenovo ThinkPad X240"/>
        <meta property="og:url" content="http://didier.bernaudeau.net/HowTo-configure-the-Linux-kernel-for-Lenovo-ThinkPad-X240.html"/>
        <meta property="og:description" content="This article describes step by step how to configure the Linux Kernel for my Lenovo ThinkPad X240. This kernel must support Intel Haswell processor, all devices and UEFI bootloader without Grub. To get more information about the configuration of my laptop, you can read this article : Lenovo ThinkPad X240"/>
        <meta property="article:published_time" content="2015-06-16" />
            <meta property="article:section" content="Tutorials" />
            <meta property="article:tag" content="Gentoo" />
            <meta property="article:author" content="Didier Bernaudeau" />


    <!-- Bootstrap -->
        <link rel="stylesheet" href="http://didier.bernaudeau.net/theme/css/bootstrap.flatly.min.css" type="text/css"/>
    <link href="http://didier.bernaudeau.net/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="http://didier.bernaudeau.net/theme/css/pygments/native.css" rel="stylesheet">
    <link rel="stylesheet" href="http://didier.bernaudeau.net/theme/css/style.css" type="text/css"/>

        <link href="http://didier.bernaudeau.net/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="My personal blog note ATOM Feed"/>



        <link href="http://didier.bernaudeau.net/feeds/tutorials.atom.xml" type="application/atom+xml" rel="alternate"
              title="My personal blog note Tutorials ATOM Feed"/>

    <link href="http://didier.bernaudeau.net/theme/css/colorbox.css" rel="stylesheet">

</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
	<div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="http://didier.bernaudeau.net/" class="navbar-brand">
My personal blog note            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                    <li><a href="/category/articles.html">Articles</a></li>
                    <li><a href="/category/tutorials.html">Tutorials</a></li>
                    <li><a href="/category/talk.html">Talk</a></li>
                    <li><a href="/category/cheat-sheet.html">Cheat sheet</a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li><a href="http://didier.bernaudeau.net/archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->
<!-- Banner -->
<!-- End Banner -->
<div class="container">
    <div class="row">
        <div class="col-sm-9">
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="http://didier.bernaudeau.net/HowTo-configure-the-Linux-kernel-for-Lenovo-ThinkPad-X240.html"
                       rel="bookmark"
                       title="Permalink to HowTo configure the Linux kernel for Lenovo ThinkPad X240">
                        HowTo configure the Linux kernel for Lenovo ThinkPad X240
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2015-06-16T22:10:00+02:00"> mar. 16 juin 2015</time>
    </span>
            <span class="label label-default">Modified</span>
            <span class="modified">
                <i class="fa fa-calendar"></i><time datetime="2018-09-16T13:33:00+02:00"> dim. 16 septembre 2018</time>
            </span>





<span class="label label-default">Tags</span>
	<a href="http://didier.bernaudeau.net/tag/gentoo.html">Gentoo</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <p>This article describes step by step how to configure the Linux Kernel for my Lenovo ThinkPad X240. This kernel must support Intel Haswell processor, all devices and UEFI bootloader without Grub.</p>
<p>To get more information about the configuration of my laptop, you can read this article : <a class="reference external" href="http://didier.bernaudeau.net/Laptop_Lenovo_ThinkPad_X240.html">Lenovo ThinkPad X240</a></p>

<div class="section" id="kernel-installation">
<h2>Kernel installation</h2>
<p>Download kernel Gentoo sources (4.12.12) :</p>
<pre class="code console literal-block">
<span class="gp">#</span> emerge sys-kernel/gentoo-sources
</pre>
<p>Download firmware for Intel WiFi 7260 (version 16) :</p>
<pre class="code console literal-block">
<span class="gp">#</span> emerge sys-firmware/iwl7260-ucode
</pre>
<p>or</p>
<pre class="code console literal-block">
<span class="gp">#</span> wget https://git.kernel.org/cgit/linux/kernel/git/iwlwifi/linux-firmware.git/plain/iwlwifi-7260-17.ucode
</pre>
<p>Select kernel sources</p>
<pre class="code console literal-block">
<span class="gp">#</span> eselect kernel list
<span class="gp">#</span> eselect kernel <span class="nb">set</span> X
<span class="gp">#</span> <span class="nb">cd</span> /usr/src/linux
</pre>
<p>Print configuration menu</p>
<pre class="code console literal-block">
<span class="gp">#</span> make menuconfig
</pre>
</div>
<div class="section" id="kernel-minimal-configuration">
<h2>Kernel minimal configuration</h2>
<pre class="code ini literal-block">
<span class="na">| Gentoo Linux ---&gt;</span>
<span class="na">|      |</span>
<span class="na">|      |     Support for init systems, system and service managers ---&gt;</span>
<span class="na">|      |      | [ ] OpenRC, runit and other script based systems and managers</span>
<span class="na">|      |      | [*] systemd</span>
<span class="na">|</span>
<span class="na">| General setup  ---&gt;</span>
<span class="na">|      |</span>
<span class="na">|      |     Timers subsystem  ---&gt;</span>
<span class="na">|      |      | [*] High Resolution Timer Support</span>
<span class="na">|      |</span>
<span class="na">| Processor type and features  ---&gt;</span>
<span class="na">|      |</span>
<span class="na">|      | [*] Symmetric multi-processing support</span>
<span class="na">|      | [ ] Support for extended (non-PC) x86 platforms</span>
<span class="na">|      | [*] Intel Low Power Subsystem Support</span>
<span class="na">|      |     Processor family (Generic-x86-64)  ---&gt;</span>
<span class="na">|      | [ ] Old AMD GART IOMMU support</span>
<span class="na">|      | [ ] IBM Calgary IOMMU support</span>
<span class="na">|      | [ ] Enable Maximum number of SMP Processors and NUMA Nodes</span>
<span class="na">|      | [*] SMT (Hyperthreading) scheduler support</span>
<span class="na">|      | [*] Multi-core scheduler support</span>
<span class="na">|      | [*] Machine Check / overheating reporting</span>
<span class="na">|      | [*]   Intel MCE features (NEW)</span>
<span class="na">|      | [ ]   AMD MCE features</span>
<span class="na">|      | &lt; &gt; CPU microcode loading support</span>
<span class="na">|      | &lt;*&gt; /dev/cpu/*/msr - Model-specific register support</span>
<span class="na">|      | &lt;*&gt; /dev/cpu/*/cpuid - CPU information support</span>
<span class="na">|      | [ ] Numa Memory Allocation and Scheduler Support</span>
<span class="na">|      | [*] EFI runtime service support</span>
<span class="na">|      | [*]   EFI stub support</span>
<span class="na">|      | [*] Built-in kernel command line</span>
<span class="na">|      | (root</span><span class="o">=</span><span class="s">/dev/sda6 init=/usr/lib/systemd/systemd) Built-in kernel command string</span>
<span class="na">|</span>
<span class="na">| Power management and ACPI options  ---&gt;</span>
<span class="na">|      |</span>
<span class="na">|      | [*] Suspend to RAM and standby</span>
<span class="na">|      | [*] Hibernation (aka 'suspend to disk')</span>
<span class="na">|      | (/dev/sda5) Default resume partition</span>
<span class="na">|      |</span>
<span class="na">|      | -*- Device power management core functionality</span>
<span class="na">|      | [ ]   Power Management Debug Support</span>
<span class="na">|      |</span>
<span class="na">|      | [*] ACPI (Advanced Configuration and Power Interface) Support  ---&gt;</span>
<span class="na">|      |      | &lt;*&gt;   Processor</span>
<span class="na">|      |      | &lt;*&gt;   Processor Aggregator</span>
<span class="na">|      |</span>
<span class="na">|      |     CPU Frequency scaling  ---&gt;</span>
<span class="na">|      |      | [*] CPU Frequency scaling</span>
<span class="na">|      |      | &lt;*&gt;   CPU frequency translation statistics</span>
<span class="na">|      |      | [*]     CPU frequency translation statistics details</span>
<span class="na">|      |      |       Default CPUFreq governor (conservative)  ---&gt;</span>
<span class="na">|      |      | -*-   'performance' governor</span>
<span class="na">|      |      | &lt;*&gt;   'powersave' governor</span>
<span class="na">|      |      | &lt;*&gt;   'userspace' governor for userspace frequency scaling</span>
<span class="na">|      |      | &lt;*&gt;   'ondemand' cpufreq policy governor</span>
<span class="na">|      |      | -*-   'conservative' cpufreq governor</span>
<span class="na">|      |      |       *** CPU frequency scaling drivers ***</span>
<span class="na">|      |      | [*]   Intel P state control</span>
<span class="na">|      |      | &lt; &gt;   ACPI Processor P-States driver</span>
<span class="na">|      |</span>
<span class="na">|      |     CPU Idle  ---&gt;</span>
<span class="na">|      |      | [*] CPU idle PM support</span>
<span class="na">|      |      | [ ]   Ladder governor (for periodic timer tick)</span>
<span class="na">|      |      | -*-   Menu governor (for tickless system)</span>
<span class="na">|      |</span>
<span class="na">|      | [*] Cpuidle Driver for Intel Processors</span>
<span class="na">|</span>
<span class="na">| [*] Networking support  ---&gt;</span>
<span class="na">|      | --- Networking support</span>
<span class="na">|      |       Networking options  ---&gt;</span>
<span class="na">|      |        | [*] TCP/IP networking</span>
<span class="na">|      |        | &lt;*&gt;   The IPv6 protocol  ----</span>
<span class="na">|      |        | [ ]   NetLabel subsystem support</span>
<span class="na">|      |</span>
<span class="na">|      | [ ]   Amateur Radio support  ----</span>
<span class="na">|      |</span>
<span class="na">|      | -*-   Wireless  ---&gt;</span>
<span class="na">|      |        | --- Wireless</span>
<span class="na">|      |        | &lt;*&gt;   cfg80211 - wireless configuration API</span>
<span class="na">|      |        | [*]     enable powersave by default</span>
<span class="na">|      |        | &lt;*&gt;   Generic IEEE 802.11 Networking Stack (mac80211)</span>
<span class="na">|      |        | [*]   Enable LED triggers</span>
<span class="na">|      |</span>
<span class="na">|      | &lt;*&gt;   RF switch subsystem support  ----</span>
<span class="na">|</span>
<span class="na">| Device Drivers  ---&gt;</span>
<span class="na">|      |</span>
<span class="na">|      |     Generic Driver Options  ---&gt;</span>
<span class="na">|      |      | [ ] Prevent firmware from being built</span>
<span class="na">|      |      | -*- Userspace firmware loading support</span>
<span class="na">|      |      | [*]   Include in-kernel firmware blobs in kernel binary</span>
<span class="na">|      |      | (iwlwifi-7260-17.ucode) External firmware blobs to build into the kernel binary</span>
<span class="na">|      |      | (/lib/firmware) Firmware blobs root directory</span>
<span class="na">|      |      | [*] Fallback user-helper invocation for firmware loading</span>
<span class="na">|      |      | [ ] Managed device resources verbose debug messages</span>
<span class="na">|      |</span>
<span class="na">|      | &lt;*&gt; Serial ATA and Parallel ATA drivers (libata)  ---&gt;</span>
<span class="na">|      |      | [ ]   Verbose ATA error reporting</span>
<span class="na">|      |      | [*]   ATA ACPI Support</span>
<span class="na">|      |      | [ ]   SATA Port Multiplier support</span>
<span class="na">|      |      | &lt;*&gt;   AHCI SATA support</span>
<span class="na">|      |      | [ ]   ATA SFF support (for legacy IDE and PATA)</span>
<span class="na">|      |</span>
<span class="na">|      | [ ] Multiple devices driver support (RAID and LVM)  ----</span>
<span class="na">|      | [ ] Macintosh device drivers  ----</span>
<span class="na">|      |</span>
<span class="na">|      | [*] Network device support  ---&gt;</span>
<span class="na">|      |      | --- Network device support</span>
<span class="na">|      |      | [*]   Ethernet driver support  ---&gt;</span>
<span class="na">|      |      |        | --- Ethernet driver support</span>
<span class="na">|      |      |        | [*]   Intel devices</span>
<span class="na">|      |      |        | &lt; &gt;     Intel(R) PRO/100+ support</span>
<span class="na">|      |      |        | &lt; &gt;     Intel(R) PRO/1000 Gigabit Ethernet support</span>
<span class="na">|      |      |        | &lt;*&gt;     Intel(R) PRO/1000 PCI-Express Gigabit Ethernet support</span>
<span class="na">|      |      |        | [ ]     Intel (82586/82593/82596) devices</span>
<span class="na">|      |      |</span>
<span class="na">|      |      | &lt; &gt;   FDDI driver support</span>
<span class="na">|      |      | &lt; &gt;   PHY Device support and infrastructure  ----</span>
<span class="na">|      |      | &lt; &gt;   USB Network Adapters  ----</span>
<span class="na">|      |      |</span>
<span class="na">|      |      | [*]   Wireless LAN  ---&gt;</span>
<span class="na">|      |      |        | --- Wireless LAN</span>
<span class="na">|      |      |        | &lt;*&gt;   Intel Wireless WiFi Next Gen AGN - Wireless-N/Advanced-N/Ultimate-N (iwlwifi)</span>
<span class="na">|      |      |        | &lt; &gt;     Intel Wireless WiFi DVM Firmware support</span>
<span class="na">|      |      |        | &lt;*&gt;     Intel Wireless WiFi MVM Firmware support</span>
<span class="na">|      |      |        | &lt; &gt;   Realtek rtlwifi family of devices  ----</span>
<span class="na">|      |</span>
<span class="na">|      |     Character devices  ---&gt;</span>
<span class="na">|      |      | &lt; &gt; Hardware Random Number Generator Core support  ---&gt;</span>
<span class="na">|      |</span>
<span class="na">|      |     I2C support  ---&gt;</span>
<span class="na">|      |      | -*- I2C support</span>
<span class="na">|      |      | &lt;*&gt;   I2C device interface</span>
<span class="na">|      |      |       I2C Hardware Bus support  ---&gt;</span>
<span class="na">|      |      |        | &lt;*&gt; Intel 82801 (ICH/PCH)</span>
<span class="na">|      |      |        | &lt;*&gt; SMBus Control Method Interface</span>
<span class="na">|      |</span>
<span class="na">|      | -*- Hardware Monitoring support  ---&gt;</span>
<span class="na">|      |      | &lt;*&gt;   Intel Core/Core2/Atom temperature sensor</span>
<span class="na">|      |</span>
<span class="na">|      | -*- Generic Thermal sysfs driver  ---&gt;</span>
<span class="na">|      |      |       Default Thermal governor (step_wise)  ---&gt;</span>
<span class="na">|      |      | -*-   Step_wise thermal governor</span>
<span class="na">|      |      | &lt;*&gt;   Intel PowerClamp idle injection driver</span>
<span class="na">|      |      | &lt;*&gt;   X86 package temperature thermal driver</span>
<span class="na">|      |</span>
<span class="na">|      |     Multifunction device drivers  ---&gt;</span>
<span class="na">|      |      | &lt;*&gt; Intel ICH LPC</span>
<span class="na">|      |      | &lt;*&gt; Realtek PCI-E card reader</span>
<span class="na">|      |</span>
<span class="na">|      | &lt;*&gt; Multimedia support  ---&gt;</span>
<span class="na">|      |      | [*]   Cameras/video grabbers support</span>
<span class="na">|      |      | [*]   Media USB Adapters  ----&gt;</span>
<span class="na">|      |      |        | &lt;*&gt;   USB Video Class (UVC)</span>
<span class="na">|      |      |        | [*]     UVC input events device support (NEW)</span>
<span class="na">|      |      |        | &lt; &gt;   GSPCA based webcams  ----</span>
<span class="na">|      |</span>
<span class="na">|      |     Graphics support  ---&gt;</span>
<span class="na">|      |      | &lt;*&gt; Direct Rendering Manager (XFree86 4.1.0 and higher DRI support)  ---</span>
<span class="na">|      |      | &lt;*&gt; Intel 8xx/9xx/G3x/G4x/HD Graphics</span>
<span class="na">|      |</span>
<span class="na">|      |     &lt;*&gt; Sound card support  ---&gt;</span>
<span class="na">|      |      | &lt;*&gt;   Advanced Linux Sound Architecture  ---&gt;</span>
<span class="na">|      |      |      | [*]   PCI sound devices  ---&gt;</span>
<span class="na">|      |      |      |       HD-Audio  ---&gt;</span>
<span class="na">|      |      |      |        | &lt;*&gt; HD Audio PCI</span>
<span class="na">|      |      |      |        | &lt;*&gt; Build Realtek HD-audio codec support</span>
<span class="na">|      |      |      |        | &lt;*&gt; Build HDMI/DisplayPort HD-audio codec support</span>
<span class="na">|      |      |      |</span>
<span class="na">|      |      |      | (2048) Pre-allocated buffer size for HD-audio driver</span>
<span class="na">|      |      |      |</span>
<span class="na">|      |      |      | [ ]   USB sound devices  ----</span>
<span class="na">|      |      |      | [ ]   PCMCIA sound devices  ----</span>
<span class="na">|      |</span>
<span class="na">|      | [*] USB support  ---&gt;</span>
<span class="na">|      |      | &lt;*&gt;   Support for Host-side USB</span>
<span class="na">|      |      | &lt; &gt;     USB Monitor</span>
<span class="na">|      |      | &lt;*&gt;     xHCI HCD (USB 3.0) support</span>
<span class="na">|      |      | &lt;*&gt;     EHCI HCD (USB 2.0) support</span>
<span class="na">|      |      | &lt; &gt;     OHCI HCD (USB 1.1) support</span>
<span class="na">|      |      | &lt; &gt;     UHCI HCD (most Intel and VIA) support</span>
<span class="na">|      |      | &lt; &gt;     USB Printer support</span>
<span class="na">|      |</span>
<span class="na">|      | &lt;*&gt; MMC/SD/SDIO card support  ---&gt;</span>
<span class="na">|      |      | &lt;*&gt;   Realtek PCI-E SD/MMC Card Interface Driver</span>
<span class="na">|      |</span>
<span class="na">|      | [*] X86 Platform Specific Device Drivers  ---&gt;</span>
<span class="na">|      |      | &lt;*&gt;   ThinkPad ACPI Laptop Extras</span>
<span class="na">|      |      | [*]     Console audio control ALSA interface (NEW)</span>
<span class="na">|      |      | [ ]     Maintainer debug facilities (NEW)</span>
<span class="na">|      |      | [ ]     Verbose debug mode (NEW)</span>
<span class="na">|      |      | [ ]     Allow control of important LEDs (unsafe) (NEW)</span>
<span class="na">|      |      | [*]     Video output control support (NEW)</span>
<span class="na">|      |      | [*]     Support NVRAM polling for hot keys (NEW)</span>
<span class="na">|      |      | &lt; &gt;   Eee PC Hotkey Driver</span>
<span class="na">|      |</span>
<span class="na">|      | [*] IOMMU Hardware Support  ---&gt;</span>
<span class="na">|      |      | --- IOMMU Hardware Support</span>
<span class="na">|      |      | [ ]   AMD IOMMU support</span>
<span class="na">|      |      | [*]   Support for Intel IOMMU using DMA Remapping Devices</span>
<span class="na">|      |      | [*]     Enable Intel DMA Remapping Devices by default</span>
<span class="na">|      |      | [*]   Support for Interrupt Remapping</span>
<span class="na">|      |</span>
<span class="na">|      | [*] Pulse-Width Modulation (PWM) Support  ---&gt;</span>
<span class="na">|      |      | &lt;*&gt;   Intel LPSS PWM support</span>
<span class="na">|      |      | &lt;*&gt;     Intel LPSS PWM PCI driver</span>
<span class="na">|      |      | &lt;*&gt;     Intel LPSS PWM platform driver</span>
<span class="na">|      |</span>
<span class="na">|      | [*] Generic powercap sysfs driver  ---&gt;</span>
<span class="na">|      |      | &lt;*&gt;   Intel RAPL Support</span>
<span class="na">|</span>
<span class="na">|    File systems  ---&gt;</span>
<span class="na">|      |</span>
<span class="na">|      | &lt;*&gt; The Extended 4 (ext4) filesystem</span>
<span class="na">|      | &lt;*&gt; XFS filesystem support</span>
<span class="na">|      | &lt;*&gt; FUSE (Filesystem in Userspace) support</span>
<span class="na">|      |</span>
<span class="na">|      |     CD-ROM/DVD Filesystems  ---&gt;</span>
<span class="na">|      |      | &lt;*&gt; UDF file system support</span>
<span class="na">|      |</span>
<span class="na">|      |     Pseudo filesystems  ---&gt;</span>
<span class="na">|      |      | &lt;*&gt;   EFI Variable filesystem</span>
<span class="na">|      |</span>
<span class="na">|      | [ ] Miscellaneous filesystems  ----</span>
<span class="na">|      |</span>
<span class="na">|      | [*] Network File Systems  ---&gt;</span>
<span class="na">|      |      | --- Network File Systems</span>
<span class="na">|      |      | &lt;*&gt;   NFS client support</span>
<span class="na">|      |      | &lt; &gt;     NFS client support for NFS version 2</span>
<span class="na">|      |      | &lt; &gt;     NFS client support for NFS version 3</span>
<span class="na">|      |      | &lt;*&gt;     NFS client support for NFS version 4</span>
<span class="na">|      |      | [ ]   Root file system on NFS</span>
<span class="na">|      |      | &lt;*&gt;   CIFS support (advanced network filesystem, SMBFS successor)</span>
<span class="na">|      |      | [ ]     Enable CIFS debugging routines</span>
<span class="na">|</span>
<span class="na">| -*- Cryptographic API  ---&gt;</span>
<span class="na">|      |</span>
<span class="na">|      |       *** Digest ***</span>
<span class="na">|      | -*-   CRC32c CRC algorithm</span>
<span class="na">|      | &lt;*&gt;   CRC32c INTEL hardware acceleration</span>
<span class="na">|      | -*-   SHA1 digest algorithm</span>
<span class="na">|      | &lt;*&gt;   SHA1 digest algorithm (SSSE3/AVX/AVX2)</span>
<span class="na">|      | &lt;*&gt;   SHA256 digest algorithm (SSSE3/AVX/AVX2)</span>
<span class="na">|      | &lt;*&gt;   SHA512 digest algorithm (SSSE3/AVX/AVX2)</span>
<span class="na">|      |</span>
<span class="na">|      |       *** Ciphers ***</span>
<span class="na">|      | -*-   AES cipher algorithms</span>
<span class="na">|      | -*-   AES cipher algorithms (x86_64)</span>
<span class="na">|      | &lt;*&gt;   AES cipher algorithms (AES-NI)</span>
<span class="na">|      |</span>
<span class="na">|      | [ ]   Hardware crypto devices  ----</span>
</pre>
</div>
<div class="section" id="kernel-optional-configuration">
<h2>Kernel optional configuration</h2>
<div class="section" id="kerberos-cryptography-support">
<h3>Kerberos cryptography support</h3>
<pre class="code ini literal-block">
<span class="na">| -*- Cryptographic API  ---&gt;</span>
<span class="na">|      | -*- Cryptographic API ---&gt;</span>
<span class="na">|      | &lt;*&gt;   CBC support</span>
<span class="na">|      | &lt;*&gt;   CTS support</span>
<span class="na">|      | -*-   ECB support</span>
<span class="na">|      | -*-   HMAC support</span>
<span class="na">|      | -*-   ARC4 cipher algorithm</span>
<span class="na">|      | -*-   DES and Triple DES EDE cipher algorithms</span>
<span class="na">|      | &lt;*&gt;   Triple DES EDE cipher algorithm (x86-64)</span>
</pre>
</div>
<div class="section" id="virtualization-with-kvm">
<h3>Virtualization with KVM</h3>
<pre class="code ini literal-block">
<span class="na">|     General setup  ---&gt;</span>
<span class="na">|      | -*- Control Group support  ---&gt;</span>
<span class="na">|      |        | [*]   Memory Resource Controller for Control Groups</span>
<span class="na">|      |        | [*]     Memory Resource Controller Swap Extension</span>
<span class="na">|      |        | [*]       Memory Resource Controller Swap Extension enabled by default (NEW)</span>
<span class="na">|      |        | [*]     Memory Resource Controller Kernel Memory accounting</span>
<span class="na">|</span>
<span class="na">| [*] Virtualization  ---&gt;</span>
<span class="na">|      | --- Virtualization</span>
<span class="na">|      | &lt;*&gt;   Kernel-based Virtual Machine (KVM) support</span>
<span class="na">|      | &lt;*&gt;     KVM for Intel processors support</span>
<span class="na">|      | &lt; &gt;     KVM for AMD processors support (NEW)</span>
<span class="na">|      | [ ]     Audit KVM MMU (NEW)</span>
<span class="na">|      | [ ]     KVM legacy PCI device assignment support</span>
<span class="na">|      | &lt; &gt;   Host kernel accelerator for virtio net (NEW)</span>
</pre>
<p>Configuration for bridge network</p>
<pre class="code ini literal-block">
<span class="na">| [*] Networking support  ---&gt;</span>
<span class="na">|      | --- Networking support</span>
<span class="na">|      |       Networking options  ---&gt;</span>
<span class="na">|      |        | &lt;*&gt; 802.1d Ethernet Bridging</span>
<span class="na">|      |        | [*] Network packet filtering framework (Netfilter)  ---&gt;</span>
<span class="na">|      |        |        | &lt;*&gt;   Ethernet Bridge tables (ebtables) support  ---&gt;</span>
<span class="na">|      |        |        |        | &lt;*&gt;   ebt: mark target support</span>
<span class="na">|</span>
<span class="na">| Device Drivers  ---&gt;</span>
<span class="na">|      | [*] Network device support  ---&gt;</span>
<span class="na">|      |      | --- Network device support</span>
<span class="na">|      |      | &lt;*&gt;     MAC-VLAN support</span>
<span class="na">|      |      | &lt;*&gt;       MAC-VLAN based tap driver</span>
<span class="na">|      |      | &lt;*&gt;     Universal TUN/TAP device driver support</span>
</pre>
<p>Configuration for virtual network</p>
<pre class="code ini literal-block">
<span class="na">| [*] Networking support  ---&gt;</span>
<span class="na">|      | --- Networking support</span>
<span class="na">|      |       Networking options  ---&gt;</span>
<span class="na">|      |</span>
<span class="na">|      |        | [*] Network packet filtering framework (Netfilter)  ---&gt;</span>
<span class="na">|      |        |       | [*]   Advanced netfilter configuration</span>
<span class="na">|      |        |       |       Core Netfilter Configuration  ---&gt;</span>
<span class="na">|      |        |       |       | &lt;*&gt;   ctmark target and match support</span>
<span class="na">|      |        |       |       | &lt;*&gt;   CHECKSUM target support</span>
<span class="na">|      |        |       | &lt;*&gt;   Ethernet Bridge tables (ebtables) support  ---&gt;</span>
<span class="na">|      |        |       |       | &lt;*&gt;   ebt: nat table support</span>
<span class="na">|      |        |       |       | &lt;*&gt;   ebt: mark target support</span>
<span class="na">|      |        |</span>
<span class="na">|      |        | [*] QoS and/or fair queueing  ---&gt;</span>
<span class="na">|      |        |       | &lt;*&gt;   Hierarchical Token Bucket (HTB)</span>
<span class="na">|      |        |       | &lt;*&gt;   Stochastic Fairness Queueing (SFQ)</span>
<span class="na">|      |        |       | &lt;*&gt;   Ingress Qdisc</span>
<span class="na">|      |        |       | &lt;*&gt;   Netfilter mark (FW)</span>
<span class="na">|      |        |       | &lt;*&gt;   Universal 32bit comparisons w/ hashing (U32)</span>
<span class="na">|      |        |       | [*]   Actions</span>
<span class="na">|      |        |       | &lt;*&gt;     Traffic Policing</span>
</pre>
</div>
<div class="section" id="chromimum">
<h3>Chromimum</h3>
<pre class="code ini literal-block">
<span class="na">| General setup  ---&gt;</span>
<span class="na">|      | -*- Namespaces support  ---&gt;</span>
<span class="na">|      |      | [*]   User namespace</span>
</pre>
</div>
<div class="section" id="usb-serial-converter-support">
<h3>USB Serial Converter support</h3>
<pre class="code ini literal-block">
<span class="na">| Device Drivers  ---&gt;</span>
<span class="na">|      | [*] USB support  ---&gt;</span>
<span class="na">|      |      | &lt;*&gt;   USB Serial Converter support  ---&gt;</span>
<span class="na">|      |      | &lt;*&gt;     &lt;*&gt;   USB Winchiphead CH341 Single Port Serial Driver</span>
</pre>
</div>
</div>
<div class="section" id="kernel-compilation">
<h2>Kernel compilation</h2>
<pre class="code console literal-block">
<span class="gp">#</span> make <span class="o">&amp;&amp;</span> make modules_install
</pre>
</div>
<div class="section" id="id1">
<h2>Kernel installation</h2>
<p>Mount ESP (EFI System Partition)</p>
<pre class="code console literal-block">
<span class="gp">#</span> mkdir /mnt/ESP
<span class="gp">#</span> mount /dev/sda2 /mnt/ESP
</pre>
<p>Create directory</p>
<pre class="code console literal-block">
<span class="gp">#</span> mkdir /mnt/ESP/EFI/GentooLinux
</pre>
<p>Copy kernel</p>
<pre class="code console literal-block">
<span class="gp">#</span> cp /usr/src/linux/arch/x86_64/boot/bzImage /mnt/ESP/EFI/GentooLinux/4.12.12.efi
</pre>
<p>Unmount ESP (EFI System Partition)</p>
<pre class="code console literal-block">
<span class="gp">#</span> umount /mnt/ESP
</pre>
</div>
<div class="section" id="update-uefi-bootloader">
<h2>Update UEFI bootloader</h2>
<p>Install EFI boot manager</p>
<pre class="code console literal-block">
<span class="gp">#</span> emerge efibootmgr
</pre>
<p>Add the new kernel</p>
<pre class="code console literal-block">
<span class="gp">#</span> efibootmgr -c -d /dev/sda -p <span class="m">2</span> -L <span class="s2">"Gentoo Linux 4.12.12"</span> -l <span class="s2">"\EFI\GentooLinux\4.12.12.efi"</span>
</pre>
<p>Print the menu</p>
<pre class="code console literal-block">
<span class="gp">#</span> efibootmgr -v
</pre>
<p>Remove the previous kernel (after testing the new kernel)</p>
<pre class="code console literal-block">
<span class="gp">#</span> efibootmgr -b <span class="m">15</span> -B
</pre>
</div>
<div class="section" id="references">
<h2>References</h2>
<blockquote>
<ul class="simple">
<li><a class="reference external" href="https://wiki.gentoo.org/wiki/EFI_stub_kernel">Wiki Gentoo - EFI stub kernel</a></li>
</ul>
</blockquote>
</div>

            </div>
            <!-- /.entry-content -->
<section class="well" id="related-posts">
    <h4>Related Posts:</h4>
    <ul>
        <li><a href="http://didier.bernaudeau.net/Gentoo_cheat_sheet.html">Gentoo cheat sheet</a></li>
    </ul>
</section>
        </article>
    </section>

        </div>
        <div class="col-sm-3" id="sidebar">
            <aside>
<div id="aboutme">
        <p>
            <img width="60%" class="img-thumbnail" src="/images/photo.jpg"/>
        </p>
    <p>
        <strong>About D. Bernaudeau</strong><br/>
        Didier is an information security consultant graduated with a Master's in Information Security in 2007. He has been focusing on securing SDLC and writing secure coding policies for the past ten years. He is curious, inquisitive, lifelong learner and self-starter. So, this blog is a way to document some of my experimentation.
    </p>
</div>
<section class="well well-sm">
    <ul class="list-group list-group-flush">



            <li class="list-group-item"><a href="http://didier.bernaudeau.net/"><h4><i class="fa fa-tags fa-lg"></i><span class="icon-label">Tags</span></h4></a>
                <ul class="list-group list-inline tagcloud" id="tags">
                    <li class="list-group-item tag-3">
                        <a href="http://didier.bernaudeau.net/tag/agile.html">
                            Agile
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://didier.bernaudeau.net/tag/angular.html">
                            Angular
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://didier.bernaudeau.net/tag/api.html">
                            API
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://didier.bernaudeau.net/tag/application-server.html">
                            Application Server
                        </a>
                    </li>
                    <li class="list-group-item tag-1">
                        <a href="http://didier.bernaudeau.net/tag/apu.html">
                            APU
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://didier.bernaudeau.net/tag/arch-linux.html">
                            Arch Linux
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://didier.bernaudeau.net/tag/archlinux.html">
                            ArchLinux
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://didier.bernaudeau.net/tag/blockchain.html">
                            Blockchain
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://didier.bernaudeau.net/tag/certificate.html">
                            Certificate
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://didier.bernaudeau.net/tag/cisco.html">
                            Cisco
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://didier.bernaudeau.net/tag/cloud.html">
                            Cloud
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://didier.bernaudeau.net/tag/container.html">
                            Container
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://didier.bernaudeau.net/tag/cryptography.html">
                            Cryptography
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://didier.bernaudeau.net/tag/cups.html">
                            cups
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://didier.bernaudeau.net/tag/database.html">
                            Database
                        </a>
                    </li>
                    <li class="list-group-item tag-1">
                        <a href="http://didier.bernaudeau.net/tag/debian.html">
                            Debian
                        </a>
                    </li>
                    <li class="list-group-item tag-1">
                        <a href="http://didier.bernaudeau.net/tag/debian-stretch.html">
                            Debian Stretch
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://didier.bernaudeau.net/tag/dedibox.html">
                            Dedibox
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://didier.bernaudeau.net/tag/development.html">
                            Development
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://didier.bernaudeau.net/tag/development-tool.html">
                            Development tool
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://didier.bernaudeau.net/tag/devops.html">
                            DevOps
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://didier.bernaudeau.net/tag/dictionary.html">
                            Dictionary
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://didier.bernaudeau.net/tag/docker.html">
                            Docker
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://didier.bernaudeau.net/tag/electronic.html">
                            Electronic
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://didier.bernaudeau.net/tag/elitebook.html">
                            EliteBook
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://didier.bernaudeau.net/tag/fancy-bear.html">
                            Fancy Bear
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://didier.bernaudeau.net/tag/framework.html">
                            Framework
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://didier.bernaudeau.net/tag/front-end.html">
                            Front-End
                        </a>
                    </li>
                    <li class="list-group-item tag-1">
                        <a href="http://didier.bernaudeau.net/tag/gentoo.html">
                            Gentoo
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://didier.bernaudeau.net/tag/git.html">
                            Git
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://didier.bernaudeau.net/tag/go.html">
                            Go
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://didier.bernaudeau.net/tag/hack.html">
                            Hack
                        </a>
                    </li>
                    <li class="list-group-item tag-1">
                        <a href="http://didier.bernaudeau.net/tag/hardware.html">
                            Hardware
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://didier.bernaudeau.net/tag/home-automation.html">
                            Home automation
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://didier.bernaudeau.net/tag/home-server.html">
                            Home Server
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://didier.bernaudeau.net/tag/html.html">
                            HTML
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://didier.bernaudeau.net/tag/java.html">
                            Java
                        </a>
                    </li>
                    <li class="list-group-item tag-1">
                        <a href="http://didier.bernaudeau.net/tag/javascript.html">
                            JavaScript
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://didier.bernaudeau.net/tag/linux.html">
                            Linux
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://didier.bernaudeau.net/tag/mongodb.html">
                            MongoDB
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://didier.bernaudeau.net/tag/music.html">
                            music
                        </a>
                    </li>
                    <li class="list-group-item tag-1">
                        <a href="http://didier.bernaudeau.net/tag/network.html">
                            Network
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://didier.bernaudeau.net/tag/nginx.html">
                            Nginx
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://didier.bernaudeau.net/tag/nodejs.html">
                            NodeJs
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://didier.bernaudeau.net/tag/openssl.html">
                            OpenSSL
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://didier.bernaudeau.net/tag/pelican.html">
                            Pelican
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://didier.bernaudeau.net/tag/php.html">
                            PHP
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://didier.bernaudeau.net/tag/pki.html">
                            PKI
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://didier.bernaudeau.net/tag/programming-language.html">
                            Programming Language
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://didier.bernaudeau.net/tag/protocol.html">
                            Protocol
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://didier.bernaudeau.net/tag/python.html">
                            Python
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://didier.bernaudeau.net/tag/raspberry-pi.html">
                            Raspberry Pi
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://didier.bernaudeau.net/tag/raspbian.html">
                            Raspbian
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://didier.bernaudeau.net/tag/redhat.html">
                            RedHat
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://didier.bernaudeau.net/tag/rest.html">
                            REST
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://didier.bernaudeau.net/tag/rpigpio.html">
                            Rpi.GPIO
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://didier.bernaudeau.net/tag/scm.html">
                            SCM
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://didier.bernaudeau.net/tag/scrum.html">
                            Scrum
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://didier.bernaudeau.net/tag/shell.html">
                            Shell
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://didier.bernaudeau.net/tag/snmp.html">
                            SNMP
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://didier.bernaudeau.net/tag/software.html">
                            Software
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://didier.bernaudeau.net/tag/spring.html">
                            Spring
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://didier.bernaudeau.net/tag/spring-boot.html">
                            Spring Boot
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://didier.bernaudeau.net/tag/spring-cloud.html">
                            Spring Cloud
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://didier.bernaudeau.net/tag/tls.html">
                            TLS
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://didier.bernaudeau.net/tag/typescript.html">
                            TypeScript
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://didier.bernaudeau.net/tag/video.html">
                            video
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://didier.bernaudeau.net/tag/virtualization.html">
                            Virtualization
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://didier.bernaudeau.net/tag/vpn.html">
                            VPN
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://didier.bernaudeau.net/tag/website.html">
                            WebSite
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://didier.bernaudeau.net/tag/websocket.html">
                            WebSocket
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://didier.bernaudeau.net/tag/windows.html">
                            Windows
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://didier.bernaudeau.net/tag/wireless.html">
                            Wireless
                        </a>
                    </li>
                </ul>
            </li>


    </ul>
</section>
            </aside>
        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2018 D. Bernaudeau
            &middot; Powered by <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>              <p><small>  <a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/"><img alt="Creative Commons License" style="border-width:0" src="//i.creativecommons.org/l/by-nc-nd/4.0/80x15.png" /></a>
    Content
  licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/">Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License</a>, except where indicated otherwise.
</small></p>
         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="http://didier.bernaudeau.net/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="http://didier.bernaudeau.net/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="http://didier.bernaudeau.net/theme/js/respond.min.js"></script>

<!-- ColorBox -->
<script src="http://didier.bernaudeau.net/theme/js/jquery.colorbox-min.js"></script>
<script src="http://didier.bernaudeau.net/theme/js/load-colorbox.js"></script>



</body>
</html>